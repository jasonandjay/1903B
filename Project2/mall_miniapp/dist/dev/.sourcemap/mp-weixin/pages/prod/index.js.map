{"version":3,"sources":["uni-app:///src/main.js",null,"webpack:///./src/pages/prod/index.vue?ea34","webpack:///./src/pages/prod/index.vue?ad30","webpack:///./src/pages/prod/index.vue?6ab8","uni-app:///src/pages/prod/index.vue","webpack:///./src/pages/prod/index.vue?617c","webpack:///./src/pages/prod/index.vue?cb70"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;;;AAAA;;AACA;;AACA;;;;AAFmBA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC;AAGnBC,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AACmI;AACnI,gBAAgB,gJAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,uCAAuC,wBAAwB;AAC/D;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AClEA;AAAA;AAAA;AAAA;AAAkc,CAAgB,8dAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;AC2Etd;;;;;;;;;;;;;;;;;;;;eACA;AACA,MADA,kBACA;AACA;AACA,cADA;AAEA,aAFA;AAEA;AACA,mBAHA;AAGA;AACA,sBAJA;AAIA;AACA,YALA;AAMA,0BANA;AAOA;AAPA;AASA,GAXA;AAYA;AACA,cADA,wBACA;AAAA;;AACA;AACA;AACA;AACA,SAFA;AAGA;AACA;;AACA;AACA;AATA,GAZA;AAuBA;AACA,gBADA,wBACA,KADA,EACA,KADA,EACA,OADA,EACA;AACA;AAAA,UACA,8CADA;;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AARA,GAvBA;AAiCA;AACA,aADA,uBACA;AAAA;;AACA;AACA;;AAFA,iCAGA,GAHA;AAIA;AAAA;AAAA;;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AAAA;AAAA;;AACA;AACA,SATA;AANA;;AAGA;AAAA;AAaA;;AACA;AACA;AAnBA,GAjCA;AAsDA,SAtDA,qBAsDA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA,qBAGA,qCAHA;;AAAA;AAGA,oBAHA;AAIA,mCAJA,CAKA;;AACA,iBANA,GAMA,EANA,EAMA,SANA,GAMA,EANA;AAOA;AACA;AACA;AACA;;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;AACA,iBAPA;AAQA,eAVA;;AAWA;AACA;AACA;AACA;;AACA;AACA;;AAvBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAwBA;AA9EA,C;;;;;;;;;;;;;AC5EA;AAAA;AAAA;AAAA;AAA+1B,CAAgB,40BAAG,EAAC,C;;;;;;;;;;;ACAn3B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/prod/index.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/prod/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=724fdf5a&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=724fdf5a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"724fdf5a\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/prod/index.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=724fdf5a&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = Object.keys(_vm.info)\n  var g1 = g0.length ? _vm.selectSku.join(\",\") : null\n  var g2 = g0.length ? _vm.selectSku.join(\",\") : null\n  var l1 = g0.length\n    ? _vm.__map(_vm.sku, function (item, index) {\n        var $orig = _vm.__get_orig(item)\n\n        var l0 = _vm.__map(item, function (value, key) {\n          var $orig = _vm.__get_orig(value)\n\n          var g3 = _vm.availableSku[index].includes(value)\n          var g4 = _vm.availableSku[index].includes(value)\n          var g5 = _vm.selectSku.includes(value)\n          return {\n            $orig: $orig,\n            g3: g3,\n            g4: g4,\n            g5: g5,\n          }\n        })\n\n        return {\n          $orig: $orig,\n          l0: l0,\n        }\n      })\n    : null\n  var g6 = g0.length\n    ? _vm.info.content\n        .replace(\n          /(\\<img class=\\\"\\\" style=\\\")/g,\n          \"$1max-width:100% !important;height: auto !important;\"\n        )\n        .replace(/width=\\\"750\\\"/g, \"\")\n    : null\n\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.showSkuSelect = true\n    }\n\n    _vm.e1 = function ($event) {\n      _vm.showSkuSelect = false\n    }\n  }\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        l1: l1,\n        g6: g6,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n    <div v-if=\"Object.keys(info).length\">\n        <!-- 商品详情轮播 -->\n        <section>\n            <swiper indicator-dots \tindicator-active-color=\"red\">\n                <swiper-item>\n                    <image :src=\"info.imgs\" mode=\"widthFix\"/>\n                </swiper-item>\n            </swiper>\n        </section>\n\n        <!-- 商品信息 -->\n        <section>\n            <div>\n                <div>\n                    <p>{{info.prodName}}</p>\n                    <p>{{info.brief}}</p>\n                </div>\n                <div>\n                    <image src=\"../../static/images/icon/prod-col.png\"/>\n                    <span>收藏</span>\n                </div>\n            </div>\n            <p>${{info.price}}</p>\n        </section>\n\n        <!-- 商品sku -->\n        <section>\n            <p @click=\"showSkuSelect=true\">\n                <span>已选</span>\n                <span>{{selectSku.join(',')}},{{num}}件</span>\n                <span>...</span>\n            </p>\n            <van-popup\n                :show=\"showSkuSelect\"\n                position=\"bottom\"\n                @close=\"showSkuSelect=false\"\n            >\n                <div>\n                    <section>\n                        <image :src=\"selectProd.pic\" mode=\"widthFix\">\n                        <div>\n                            <p>¥ {{selectProd.price}}</p>\n                            <p>库存：{{selectProd.stocks}}件</p>\n                            <p>\n                                <span>已选</span>\n                                <span>{{selectSku.join(',')}},{{num}}件</span>\n\n                            </p>\n                        </div>\n                    </section>\n                    <section>\n                        <li class=\"sku-item\" v-for=\"(item, index) in sku\" :key=\"index\">\n                            <p>{{index}}</p>\n                            <div>\n                                <button @click=\"changeSelect(index, value, !availableSku[index].includes(value))\" :class=\"{disable: !availableSku[index].includes(value), active: selectSku.includes(value)}\" v-for=\"(value,key) in item\" :key=\"value\">{{value}}</button>\n                            </div>\n                        </li>\n                    </section>\n                </div>\n            </van-popup>\n        </section>\n\n        <!-- 商品评论 -->  \n        <section></section>\n\n        <!-- 商品详情 -->\n        <section>\n            <rich-text :nodes='info.content.replace(/(\\<img class=\\\"\\\" style=\\\")/g, \"$1max-width:100% !important;height: auto !important;\").replace(/width=\\\"750\\\"/g, \"\")'></rich-text>\n        </section>\n    \n    </div>\n</template>\n\n<script>\nimport {getProdInfo} from '@/services/'\nexport default {\n    data(){\n        return {\n            info: {},\n            sku: {},    // 所有可供选择的sku选项\n            selectSku: [],  // 当前选中的sku选项\n            availableSku: {},    // 有库存的sku选项\n            num: 1,\n            showSkuSelect:false,\n            isDisabled: false\n        }\n    },\n    computed: {\n        selectProd(){\n            if (this.info.skuList){\n                let result = this.info.skuList.filter(item=>{\n                    return item.skuName.trim()===this.selectSku.join(' ')\n                });\n                return result.length? result[0]: {}\n            }\n            return {}\n        }\n    },\n    methods: {\n        changeSelect(index, value, disable){\n            let keys = Object.keys(this.sku),\n                selectSku = [...this.selectSku];\n            index = keys.findIndex(item=>item===index);\n            selectSku[index] = value;\n            this.selectSku = selectSku;\n            this.isDisabled = disable;\n        }\n    },\n    watch: {\n        selectSku(){\n            let availableSku = {};\n            let keys = Object.keys(this.sku);\n            for (let key in this.sku){\n                let index = keys.findIndex(item=>item===key);\n                let properties = [...this.selectSku];\n                availableSku[key] = this.sku[key].filter(item=>{\n                    // 判断这一项结合其他两个选项在一块有没有库存\n                    properties[index] = item;\n                    let properStr = '';\n                    for (let i=0; i<keys.length; i++){\n                        properStr += `${keys[i]}:${properties[i]};`\n                    }\n                    let availableSkuStocks = this.info.skuList.filter(item=>item.properties===properStr.slice(0, -1)).length;\n                    return availableSkuStocks;\n                })\n            }\n            this.availableSku = availableSku;\n        }\n    },\n    async mounted(){\n        console.log('this...', this);\n        this.id = this.$mp.query.prodid;\n        let result = await getProdInfo(this.id);\n        this.info = result;\n        // 计算sku\n        let sku = {}, selectSku = [];\n        result.skuList.forEach(item=>{\n            let properties = item.properties.split(';');\n            properties.forEach(value=>{\n                let temp = value.split(':');\n                if (sku[temp[0]]){\n                    sku[temp[0]].push(temp[1])\n                }else{\n                    sku[temp[0]] = [temp[1]];\n                }\n            })\n        })\n        for (let key in sku){\n            sku[key] = [...new Set(sku[key])];\n            selectSku.push(sku[key][0]);\n        }\n        this.sku = sku;\n        this.selectSku = selectSku;\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\nswiper{\n    height: 750rpx;\n}\nimage{\n    width: 100%;\n}\nrich-text{\n    width: 100%;    \n}\n.sku-item{\n    div{\n        display: flex;\n        align-items: center;\n    }\n    button{\n        width: 160rpx;\n        margin: 10rpx;\n        font-size: 28rpx;\n        color: #333;\n        line-height: 1.5;\n        padding: 10rpx;\n    }\n    button.active{\n        background: red;\n        color: #fff;\n    }\n    button.disable{\n        border: 1px dashed #ccc;\n    }\n}\n</style>","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=724fdf5a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=724fdf5a&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1639039782338\n      var cssReload = require(\"/Users/MJ/web/project/1903B/Project2/mall_miniapp/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}