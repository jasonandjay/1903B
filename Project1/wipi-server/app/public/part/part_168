=e.playbackState||t.BUFFERING.PLAYBACK.PLAYING;if(d&&f===t.BUFFERING.PLAYBACK.PLAYING&&(f=t.BUFFERING.PLAYBACK.SEEKING),r={type:c,isSeeking:d,cTime:a,duration:o,rState:s,nRanges:l,vLength:e.videoBufferLength,aLength:e.audioBufferLength,activity:e.networkActivity,vSpeed:Math.round(e.videoSpeed),aSpeed:Math.round(e.audioSpeed)},f===t.BUFFERING.PLAYBACK.SEEKING)c=0===l?t.BUFFERING.TYPE.SEEKING_OUTSIDE_BUFFERED:t.BUFFERING.TYPE.SEEKING_INSIDE_BUFFERED;else{var h=this.checkGapInfo(),p=h.nativeBufferLength;if(r.nLength=p,r.cRange=h.start+\"-\"+h.end,h.hasGap)c=h.type,r.gap=h.gapStart+\"-\"+h.gapEnd,r.gapLength=h.gapLength;else if(p<i){var g=this.checkLackOfBufferInfo(e);c=g.type,r.vCode=g.videoErrorCode,r.aCode=g.audioErrorCode}else c=s>=2?t.BUFFERING.TYPE.PERFORMANCE:t.BUFFERING.TYPE.PERFORMANCE_UNKNOWN}var m=this.checkNativeErrorInfo();m.type&&(c=m.type,r.nCode=m.code);var E=e.fragmentLoadingInfo;if(E&&E.video){var _=E.video;r.vFragment=_.id+\"-\"+_.index,e.latestPlayurlErrorHTTPCode&&(r.hCode=e.latestPlayurlErrorHTTPCode)}if(E&&E.audio){_=E.audio;r.aFragment=_.id+\"-\"+_.index,e.latestPlayurlErrorHTTPCode&&(r.hCode=e.latestPlayurlErrorHTTPCode)}r.type=\"\"+f+(c||\"00\")}catch(e){throw new Error(e.message)}return r},e.prototype.checkGapInfo=function(){var e=this.video,r=e.currentTime,n=e.buffered,i=n&&n.length,a=0,o=!1,s=0,u=0,l={start:0,end:0},d=0,c=t.BUFFERING.TYPE.UNKNOWN;if(i&&i>1)for(var f=0;f<i;f++){var h=n.start(f),p=n.end(f);h<=r&&p>=r&&(a=Math.floor(1e3*(p-r))/1e3,l={start:h,end:p},c===t.BUFFERING.TYPE.GAP_BEFORE_CURRENT?u=h:s=p),h>r&&h-r<=1&&c!==t.BUFFERING.TYPE.GAP_BEFORE_CURRENT&&(o=!0,c=t.BUFFERING.TYPE.GAP_AFTER_CURRENT,u=u?Math.min(u,h):h,s=l.end),r-p<3&&r-p>=0&&(o=!0,c=t.BUFFERING.TYPE.GAP_BEFORE_CURRENT,s=p,u=l.start)}else if(1===i){p=n.end(0);l={start:n.start(0),end:p},a=Math.floor(1e3*(p-r))/1e3}return o&&(d=Math.round(1e3*(u-s))/1e3),{type:c,start:l.start,end:l.end,nativeBufferLength:a,hasGap:o,gapStart:s,gapEnd:u,gapLength:d}},e.prototype.checkLackOfBufferInfo=function(e){\nvar r=t.BUFFERING.TYPE.UNKNOWN,n=this.video,a=n.currentTime,o=n.buffered,s=n.duration,u=n.readyState,l=0,d=0;if(o&&o.length)if(s&&s-a<i)r=t.BUFFERING.TYPE.INTERNAL_ENDING;else{var c=this.checkNetworkInfo(e);r=c.type,l=c.videoErrorCode,d=c.audioErrorCode}else r=a<=e.startOffsetTime&&u<=1?t.BUFFERING.TYPE.INTERNAL_STARTING:(e.networkActivity.length&&e.networkActivity.reduce((function(e,t){return e+t})))<100?t.BUFFERING.TYPE.NETWORK_POOR:t.BUFFERING.TYPE.INTERNAL_UNNORMAL_RANGES;return{type:r,videoErrorCode:l,audioErrorCode:d}},e.prototype.checkNetworkInfo=function(e){var r=t.BUFFERING.TYPE.UNKNOWN,a=this.video.currentTime,o=e.videoBufferLength||0,s=e.audioBufferLength||0,u=e.networkWarningHistory,l=this.getCurrentNetworkWarningInfo({mediaType:n.STRING.VIDEO,currentQn:e.videoCurrentQn,networkWarningHistory:u,warningTime:a+o,bufferLength:o},i),d=this.getCurrentNetworkWarningInfo({mediaType:n.STRING.AUDIO,currentQn:e.audioCurrentQn,networkWarningHistory:u,warningTime:a+s,bufferLength:s},i),c=l.code,f=d.code,h=this.getBufferingTypeByPoorNetwork(c),p=this.getBufferingTypeByPoorNetwork(f);return h||p?(r=h||\"00\",p&&(r=\"\"+r+p)):r=t.BUFFERING.TYPE.NETWORK,{type:r,videoErrorCode:c,audioErrorCode:f,videoBufferLength:o,audioBufferLength:s}},e.prototype.checkNativeErrorInfo=function(){var e=this.video.error,r=e&&e.code||0,n=t.BUFFERING.TYPE.UNKNOWN;if(e&&r)switch(r){case 1:n=t.BUFFERING.TYPE.MEDIA_ERR_ABORTED;break;case 2:n=t.BUFFERING.TYPE.MEDIA_ERR_NETWORK;break;case 3:n=t.BUFFERING.TYPE.MEDIA_ERR_DECODE;break;case 4:n=t.BUFFERING.TYPE.MEDIA_ERR_SRC_NOT_SUPPORTED;break;default:n=t.BUFFERING.TYPE.MEDIA}return{type:n,code:r}},e.prototype.getCurrentNetworkWarningInfo=function(e,t){if(void 0===t&&(t=1),!e)return{code:0};var r=e.mediaType,n={code:0,type:\"\",mediaType:e.mediaType},i=e.networkWarningHistory,a=e.warningTime,o=e.bufferLength,s=e.currentQn;if(i.length&&o<t){a+=t;try{var u=i.filter((function(e){return e.mediaType===r&&e.startTime<=a+t&&e.startTime+e.duration>=a&&e.id===s.toString()}));u.length&&(n=u[u.length-1])}catch(e){throw new Error(\"getCurrentNetworkWarningInfo error, \"+JSON.stringify(e))}}return n},e.prototype.getBufferingTypeByPoorNetwork=function(e){var r=t.BUFFERING.TYPE.UNKNOWN;if(e)switch(e){case n.ERROR.CONNECT_FRAGMENT_ERROR_TIMEOUT:r=t.BUFFERING.TYPE.NETWORK_CONNECT_TIMEOUT;break;case n.ERROR.DOWNLOAD_FRAGMENT_ERROR_TIMEOUT:r=t.BUFFERING.TYPE.NETWORK_DOWNLOAD_TIMEOUT;break;case n.ERROR.DOWNLOAD_FRAGMENT_ERROR:r=t.BUFFERING.TYPE.NETWORK_DOWNLOAD_ERROR}return r},e}();t.default=a},function(e,t,r){\"use strict\";var n=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,r){if(t===r)return!0;var o,s,u,l=n(t),d=n(r);if(l&&d){if((s=t.length)!=r.length)return!1;for(o=0;o<s;o++)if(!e(t[o],r[o]))return!1;return!0}if(l!=d)return!1;var c=t instanceof Date,f=r instanceof Date;if(c!=f)return!1;if(c&&f)return t.getTime()==r.getTime();var h=t instanceof RegExp,p=r instanceof RegExp;if(h!=p)return!1;if(h&&p)return t.toString()==r.toString();if(t instanceof Object&&r instanceof Object){var g=i(t);if((s=g.length)!==i(r).length)return!1;for(o=0;o<s;o++)if(!a.call(r,g[o]))return!1;for(o=0;o<s;o++)if(!e(t[u=g[o]],r[u]))return!1;return!0}return!1}},function(e,t,r){!function(e){\"use strict\";var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},r=function(e){var r=e;return t.hasOwnProperty(e)&&(r=t[e]),String.fromCharCode(r)},n=15,i=32,a={\n17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=[\"white\",\"green\",\"blue\",\"cyan\",\"red\",\"yellow\",\"magenta\",\"black\",\"transparent\"],d={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&(undefined)}},c=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},f=function(e,t,r,n,i){this.foreground=e||\"white\",this.underline=t||!1,this.italics=r||!1,this.background=n||\"black\",this.flash=i||!1};f.prototype={reset:function(){this.foreground=\"white\",this.underline=!1,this.italics=!1,this.background=\"black\",this.flash=!1},setStyles:function(e){for(var t=[\"foreground\",\"underline\",\"italics\",\"background\",\"flash\"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},isDefault:function(){return\"white\"===this.foreground&&!this.underline&&!this.italics&&\"black\"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return\"color=\"+this.foreground+\", underline=\"+this.underline+\", italics=\"+this.italics+\", background=\"+this.background+\", flash=\"+this.flash}};var h=function(e,t,r,n,i,a){this.uchar=e||\" \",this.penState=new f(t,r,n,i,a)};h.prototype={reset:function(){this.uchar=\" \",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return\" \"===this.uchar&&this.penState.isDefault()}};var p=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new h);this.pos=0,this.currPenState=new f};p.prototype={equals:function(e){for(var t=!0,r=0;r<i;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(d.log(\"ERROR\",\"Negative cursor position \"+this.pos),this.pos=0):this.pos>i&&(d.log(\"ERROR\",\"Too large cursor position \"+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(\" \",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=r(e);this.pos>=i?d.log(\"ERROR\",\"Cannot insert \"+e.toString(16)+\" (\"+t+\") at position \"+this.pos+\". Skipping it!\"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,r=0;r<i;r++){var n=this.chars[r].uchar;\" \"!==n&&(t=!1),e.push(n)}return t?\"\":e.join(\"\")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var g=function(){this.rows=[];for(var e=0;e<n;e++)this.rows.push(new p);this.currRow=14,this.nrRollUpRows=null,this.reset()};g.prototype={reset:function(){for(var e=0;e<n;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,r=0;r<n;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<n;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<n;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){\nthis.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){d.log(\"INFO\",\"setCursor: \"+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){d.log(\"INFO\",\"pacData = \"+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var r=this.rows[this.currRow];if(null!==e.indent){var n=e.indent,i=Math.max(n-1,0);r.setCursor(e.indent),e.color=r.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:\"black\",flash:!1};this.setPen(a)},setBkgData:function(e){d.log(\"INFO\",\"bkgData = \"+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){d.log(\"TEXT\",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),d.log(\"INFO\",\"Rolling up\")}else d.log(\"DEBUG\",\"roll_up but nrRollUpRows not set yet\")},getDisplayText:function(e){e=e||!1;for(var t=[],r=\"\",i=-1,a=0;a<n;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push(\"Row \"+i+': \"'+o+'\"'):t.push(o.trim()))}return t.length>0&&(r=e?\"[\"+t.join(\" | \")+\"]\":t.join(\"\\n\")),r},getTextAndFormat:function(){return this.rows}};var m=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new g,this.nonDisplayedMemory=new g,this.lastOutputScreen=new g,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};m.prototype={modes:[\"MODE_ROLL-UP\",\"MODE_POP-ON\",\"MODE_PAINT-ON\",\"MODE_TEXT\"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,d.log(\"INFO\",\"MODE=\"+e),\"MODE_POP-ON\"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),\"MODE_ROLL-UP\"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?\"DISP\":\"NON_DISP\";d.log(\"INFO\",r+\": \"+this.writeScreen.getDisplayText(!0)),\"MODE_PAINT-ON\"!==this.mode&&\"MODE_ROLL-UP\"!==this.mode||(d.log(\"TEXT\",\"DISPLAYED: \"+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){d.log(\"INFO\",\"RCL - Resume Caption Loading\"),this.setMode(\"MODE_POP-ON\")},cc_BS:function(){d.log(\"INFO\",\"BS - BackSpace\"),\"MODE_TEXT\"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){d.log(\"INFO\",\"DER- Delete to End of Row\"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){d.log(\"INFO\",\"RU(\"+e+\") - Roll Up\"),this.writeScreen=this.displayedMemory,this.setMode(\"MODE_ROLL-UP\"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){d.log(\"INFO\",\"FON - Flash On\"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){d.log(\"INFO\",\"RDC - Resume Direct Captioning\"),this.setMode(\"MODE_PAINT-ON\")},cc_TR:function(){d.log(\"INFO\",\"TR\"),this.setMode(\"MODE_TEXT\")},cc_RTD:function(){d.log(\"INFO\",\"RTD\"),this.setMode(\"MODE_TEXT\")},cc_EDM:function(){d.log(\"INFO\",\"EDM - Erase Displayed Memory\"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){d.log(\"CR - Carriage Return\"),\nthis.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){d.log(\"INFO\",\"ENM - Erase Non-displayed Memory\"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(d.log(\"INFO\",\"EOC - End Of Caption\"),\"MODE_POP-ON\"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,d.log(\"TEXT\",\"DISP: \"+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){d.log(\"INFO\",\"TO(\"+e+\") - Tab Offset\"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground=\"white\";else{var r=Math.floor(e/2)-16;t.foreground=[\"white\",\"green\",\"blue\",\"cyan\",\"red\",\"yellow\",\"magenta\"][r]}d.log(\"INFO\",\"MIDROW: \"+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=d.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var E=function(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new m(1,t),new m(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};E.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var r,n,i,a=!1;this.lastTime=e,d.setTime(e);for(var o=0;o<t.length;o+=2)if(n=127&t[o],i=127&t[o+1],n>=16&&n<=31&&n===this.lastCmdA&&i===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,d.log(\"DEBUG\",\"Repeated command (\"+c([n,i])+\") is dropped\");else if(0!==n||0!==i){if(d.log(\"DATA\",\"[\"+c([t[o],t[o+1]])+\"] -> (\"+c([n,i])+\")\"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r)if(a=this.parseChars(n,i))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(a);else d.log(\"WARNING\",\"No channel found yet. TEXT-MODE?\");r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,d.log(\"WARNING\",\"Couldn't parse cleaned data \"+c([n,i])+\" orig: \"+c([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var r=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;r=20===e||21===e||23===e?1:2;var n=this.channels[r-1];return 20===e||21===e||28===e||29===e?32===t?n.cc_RCL():33===t?n.cc_BS():34===t?n.cc_AOF():35===t?n.cc_AON():36===t?n.cc_DER():37===t?n.cc_RU(2):38===t?n.cc_RU(3):39===t?n.cc_RU(4):40===t?n.cc_FON():41===t?n.cc_RDC():42===t?n.cc_TR():43===t?n.cc_RTD():44===t?n.cc_EDM():45===t?n.cc_CR():46===t?n.cc_ENM():47===t&&n.cc_EOC():n.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},parseMidrow:function(e,t){var r=null;if((17===e||25===e)&&32<=t&&t<=47){if((r=17===e?1:2)!==this.currChNr)return d.log(\"ERROR\",\"Mismatch channel in midrow parsing\"),!1;var n=this.channels[r-1];return n.insertChars([32]),n.cc_MIDROW(t),d.log(\"DEBUG\",\"MIDROW (\"+c([e,t])+\")\"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var r,n=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;r=e<=23?1:2,n=64<=t&&t<=95?1===r?a[e]:s[e]:1===r?o[e]:u[e];var i=this.interpretPAC(n,t);return this.channels[r-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},interpretPAC:function(e,t){var r=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),\nr<=13?n.color=[\"white\",\"green\",\"blue\",\"cyan\",\"red\",\"yellow\",\"magenta\",\"white\"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color=\"white\"):n.indent=4*Math.floor((r-16)/2),n},parseChars:function(e,t){var n=null,i=null,a=null;if(e>=25?(n=2,a=e-8):(n=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,d.log(\"INFO\",\"Special char '\"+r(o)+\"' in channel \"+n),i=[o],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(i){var s=c(i);d.log(\"DEBUG\",\"Char codes =  \"+s.join(\",\"))}return i},parseBackgroundAttributes:function(e,t){var r,n,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=l[n],t%2==1&&(r.background=r.background+\"_semi\")):45===t?r.background=\"transparent\":(r.foreground=\"black\",47===t&&(r.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(r),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};e.logger=d,e.PenState=f,e.CaptionScreen=g,e.Cea608Parser=E,e.findCea608Nalus=function(e,t,r){for(var n=0,i=t,a=[],o=function(e,t,r,n){if(4!==e||t<8)return null;var i=r.getUint8(n),a=r.getUint16(n+1),o=r.getUint32(n+3),s=r.getUint8(n+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+r;){if(n=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var s=i+5,u=-1;s<i+4+n-1;){u=0;for(var l=255;255===l;)u+=l=e.getUint8(s),s++;var d=0;for(l=255;255===l;)d+=l=e.getUint8(s),s++;o(u,d,e,s)&&a.push([s,d]),s+=d}i+=n+4}return a},e.extractCea608DataFromRange=function(e,t){var r=t[0],n=[[],[]];r+=8;var i=31&e.getUint8(r);r+=2;for(var a=0;a<i;a++){var o=e.getUint8(r),s=4&o,u=3&o;r++;var l=e.getUint8(r);r++;var d=e.getUint8(r);r++,s&&(127&l)+(127&d)!=0&&(0===u?(n[0].push(l),n[0].push(d)):1===u&&(n[1].push(l),n[1].push(d)))}return n}}(t)},function(e,t,r){var n=r(11).default,i=r(13).default;window.dashjs=n,e.exports=i},function(e,t,r){\"use strict\";r.r(t),function(e){var n=r(5);r.d(t,\"MediaPlayer\",(function(){return n.a}));var i=r(0);r.d(t,\"FactoryMaker\",(function(){return i.a}));var a=r(2),o=\"undefined\"!=typeof window&&window||e,s=o.dashjs;s||(s=o.dashjs={}),s.MediaPlayer=n.a,s.FactoryMaker=i.a,s.Version=Object(a.a)(),t.default=s}.call(this,r(12))},function(e,t){var r;r=function(){return this}();try{r=r||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(r=window)}e.exports=r},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(14),i=r(15),a=r(3),o=r(4),s=r(16),u=r(7),l=r(17),d=function(){function e(e,t){if(this.config={scriptSrc:\"https://static.hdslb.com/player/js/dash.mediaplayer.min.js\",scriptMaxLoadTime:1e4,minQualityNumberMappingNumber:6,videoInfoScheduleTime:1e3},this.state={defaultVideoQuality:0,defaultAudioQuality:0,setTheDefaultVideoQualityState:!1,stableBufferTime:60,isAutoPlay:!1,abrStrategy:o.STRING.ABR_THROUGHPUT,isAutoSwitch:{video:!1,audio:!1},autoSwitchTopQualityMap:{video:-1,audio:-1},onScriptLoading:!1,initialized:!1,mpd:null,manifest:null,manifestInfo:{},currentQualityIndex:{video:0,audio:0},maxQualityIndex:{video:-1,audio:-1},qualityNumberMap:{video:{},audio:{}},segmentsInfoMap:{video:{},audio:{}},mediaInfo:{},statisticsInfo:{},autoSwitchStartTime:0,preloadData:null,startOffsetTime:0,enforceSSLStream:!1,latestPlayurlExpireTimeStamp:0,latestPlayurlErrorHTTPCode:0,fragmentLoadingInfo:{},appendingSourceState:!1,logHistory:[],networkWarningHistory:[],playbackState:u.BUFFERING.PLAYBACK.PLAYING,enableHEVC:!1},this.timer={loadScript:0,videoInfoSchedule:0,removeSwitchSourceTransition:0},this.events={},this.components={networkActivity:new s.default,bufferingInfo:new u.default(e),bufferingStrategy:new l.default},this.video=e,this.mixin(t),!(e&&e instanceof HTMLVideoElement))throw new Error(\"Video parameter is not a HTMLVideoElement\")}return e.prototype.preload=function(){var e=this\n;this.detectDashJSExists()||this.loadDashPlayerScript().then((function(){e.fire(o.EVENTS.SCRIPT_LOADED)})).catch((function(t){e.error({msg:\"Load dash player script error\",detail:t})}))},e.prototype.initialize=function(e,t){var r=this;this.mixin(t);var n=this.filterManifestByEnableHEVC(e,this.state.enableHEVC);return this.state.mpd=n.manifest,this.state.enableHEVC=n.isHEVCTypeSupported,this.components.bufferingStrategy.setHEVCEnableFlag(n.isHEVCTypeSupported).setOnOptimizingCallback(this.fire.bind(this)),new Promise((function(t,n){e||n({msg:\"Manifest parameter error, manifest: \"+JSON.stringify(e)}),r.detectDashJSExists()?r.createPlayer(t,n):r.state.onScriptLoading?r.on(o.EVENTS.SCRIPT_LOADED,(function(){r.off(o.EVENTS.SCRIPT_LOADED),r.createPlayer(t,n)})):r.loadDashPlayerScript().then((function(){r.createPlayer(t,n)})).catch((function(e){r.error(e)}))}))},e.prototype.on=function(e,t){e&&\"function\"==typeof t&&(this.events[e]||(this.events[e]=[]),this.events[e].push(t))},e.prototype.off=function(e,t){if(e)if(\"function\"==typeof t){if(this.events[e]&&this.events[e].length){var r=this.events[e].indexOf(t);r>=0&&this.events[e].splice(r,1)}}else this.events[e]=[]},e.prototype.fire=function(e,t){if(e){var r=this.events[e];r&&r.length&&r.forEach((function(e){\"function\"==typeof e&&e.call(null,t)}))}},e.prototype.play=function(){try{this.player.play()}catch(e){this.error({msg:\"Call play function error\",detail:e})}},e.prototype.pause=function(){try{this.player.pause()}catch(e){this.error({msg:\"Call pause function error\",detail:e})}},e.prototype.getCurrentTime=function(e){void 0===e&&(e=!0);try{return this.player.time(void 0,e)}catch(e){this.error({type:o.STRING.WARNING,msg:\"Call getCurrentTime function error\",detail:e})}return 0},e.prototype.getBufferedTime=function(){this.getCurrentTime();var e=this.video;try{e.buffered}catch(e){this.error({msg:\"Call getBufferedTime function error\",detail:e})}return 0},e.prototype.getDuration=function(e){void 0===e&&(e=!0);try{return this.player.duration(e)}catch(e){this.error({msg:\"Call getDuration function error\",detail:e})}},e.prototype.seek=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise((function(n,i){if(isNaN(parseInt(\"\"+e,10))||e<0)i({msg:\"Seek time value error, time: \"+e});else if(r.state.appendingSourceState)i({msg:\"Call seek function error while appending source, time: \"+e});else try{var a=r.getCurrentTime(),s=Date.now();r.changePlaybackState(u.BUFFERING.PLAYBACK.SEEKING);var l=r.getStartOffsetTime();e<l&&(e=l+.1);var d=999999,c=r.state.segmentsInfoMap,f=parseInt(r.video.getAttribute(\"data-offset\"),10)||0;if(c)for(var h in c)d=Math.min(c[h].realDuration+f,d);d=Math.min(r.state.manifest.mediaPresentationDuration,d),e>d-.6&&(e=d-.6),r.player.seek(e,t);var p=function(){r.changePlaybackState(u.BUFFERING.PLAYBACK.PLAYING).player.off(o.EVENTS.PLAYBACK_SEEKED,p),n({cost:Math.floor(Date.now()-s),currentTime:a,seekedTime:e,isRelative:t})};r.player.on(o.EVENTS.PLAYBACK_SEEKED,p)}catch(e){r.error({msg:\"Call seek function error\",detail:e})}}))},e.prototype.getCorePlayer=function(){return this.player},e.prototype.setVolume=function(e){if(isNaN(parseInt(\"\"+e,10))||e<0||e>1)this.error({msg:\"SetVolume value error, value: \"+e});else try{this.player.setVolume(e)}catch(e){this.error({msg:\"Call setVolume function error\",detail:e})}},e.prototype.getVolume=function(){try{return this.player.getVolume()}catch(e){this.error({msg:\"Call getVolume function error\",detail:e})}},e.prototype.setPlaybackRate=function(e){try{this.player.setPlaybackRate(e)}catch(e){this.error({msg:\"Call setPlaybackRate function error\",detail:e})}},e.prototype.getPlaybackRate=function(){try{return this.player.getPlaybackRate()}catch(e){this.error({msg:\"Call getPlaybackRate function error\",detail:e})}},e.prototype.getAutoSwitchQualityFor=function(e){try{return this.player.getAutoSwitchQualityFor(e)}catch(e){this.error({msg:\"Call getAutoSwitchQualityFor function error\",detail:e})}},e.prototype.setAutoSwitchQualityFor=function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!0);try{\nthis.state.isAutoSwitch&&r&&(this.state.isAutoSwitch[e]=t),t||this.setMaxAllowedBitrateFor(e,0),this.player.setAutoSwitchQualityFor(e,t)}catch(e){this.error({msg:\"Call setAutoSwitchQualityFor function error\",detail:e})}return this},e.prototype.getQualityList=function(e){try{return this.player.getBitrateInfoListFor(e)}catch(e){this.error({msg:\"Call getQualityList function error\",detail:e})}},e.prototype.setDefaultQualityFor=function(e,t){void 0===t&&(t=0);var r=this.getQualityIndexFromQualityNumber(t,e);try{var n=(this.state.mpd&&this.state.mpd[e]).length;n&&(r=Math.min(r,n-1)),r>=0?(this.state.currentQualityIndex[e]=r,this.player.setDefaultQualityFor(e,r)):this.error({msg:\"Call setDefaultQualityFor function error, quality: \"+t})}catch(e){this.error({msg:\"Call setDefaultQualityFor function error, quality: \"+t+\", qualityIndex = \"+r,detail:e})}},e.prototype.setAutoSwitchTopQualityFor=function(e,t){var r=this;try{if(!this.state.initialized){var n=function(){r.off(o.EVENTS.STREAM_INITIALIZED,n),r.setAutoSwitchTopQualityFor(e,t)};return void this.on(o.EVENTS.STREAM_INITIALIZED,n)}if(!t&&0!==t)return void this.setMaxAllowedBitrateFor(e,0);if(!(this.state.isAutoSwitch&&this.state.isAutoSwitch[e]))return;var i=this.getQualityIndexFromQualityNumber(t,e),a=this.getQualityList(e),s=a&&a[i],u=Math.floor(s.bitrate/1e3)+1;this.state.autoSwitchTopQualityMap[e]=i,this.setMaxAllowedBitrateFor(e,u)}catch(e){this.error({msg:\"Call setAutoSwitchTopQualityFor function error\",detail:e})}},e.prototype.setQualityFor=function(e,t){var r=this;return new Promise((function(n,i){if(isNaN(parseInt(\"\"+t,10))||t<0)i({msg:\"Set quality value error, quality: \"+t});else if(r.detectQualityTypeIsLegal(e))i({msg:\"Set quality type error, type: \"+e});else if(r.state.appendingSourceState)i({msg:\"Reject setQualityFor by appending next source.\"});else try{(t=r.getQualityIndexFromQualityNumber(t,e))===r.state.currentQualityIndex[e]&&i({msg:\"Set quality equal current quality, quality: \"+t}),r.player.setQualityFor(e,t);var a=Date.now(),s=function(e){e.newQuality===t&&(r.player.off(o.EVENTS.QUALITY_CHANGE_RENDERED,s),n(r.getQualityChangedData(e,a)))};r.player.on(o.EVENTS.QUALITY_CHANGE_RENDERED,s)}catch(e){i({msg:\"Call setQualityFor function error\",detail:e})}}))},e.prototype.getQualityFor=function(e){try{return this.player.getQualityFor(e)}catch(e){this.error({msg:\"Call getQualityFor function error\",detail:e})}},e.prototype.setStableBufferTime=function(e){void 0===e&&(e=60);try{this.player.setStableBufferTime(e),this.player.setBufferTimeAtTopQuality(e),this.player.setBufferTimeAtTopQualityLongForm(e),this.player.setBufferAheadToKeep(e+10)}catch(e){this.error({msg:\"Call setStableBufferTime function error\",detail:e})}},e.prototype.getStableBufferTime=function(){try{return this.player.getStableBufferTime()}catch(e){this.error({msg:\"Call getStableBufferTime function error\",detail:e})}},e.prototype.getBufferLength=function(e){try{return this.player.getBufferLength(e)}catch(e){this.error({msg:\"Call getBufferLength function error\",detail:e})}},e.prototype.getCurrentPlayURLFor=function(e){try{return this.player.getCurrentSegmentInfoFor(e).url||\"\"}catch(t){this.error({msg:\"Call getCurrentPlayURLFor function error, type: \"+e+\", qualityIndex: \"+this.state.currentQualityIndex[e],detail:t})}},e.prototype.getVideoInfo=function(){return{mediaInfo:this.state.mediaInfo,statisticsInfo:this.state.statisticsInfo}},e.prototype.getCurrentCodecID=function(e){void 0===e&&(e=o.STRING.VIDEO);var t=0;if(e===o.STRING.VIDEO){t=7,this.state.enableHEVC&&(t=12)}return t},e.prototype.getAverageConnectionSpeed=function(e){void 0===e&&(e=o.STRING.VIDEO);try{return Number(this.player.getAverageThroughput(e))||0}catch(e){this.error({msg:\"Call getAverageConnectionSpeed function error\",detail:e})}},e.prototype.switchSource=function(e,t,r){var n=this;void 0===r&&(r=!1),window.clearTimeout(this.timer.removeSwitchSourceTransition),this.onVideoSwitchSourceEnded();if(t&&(\"string\"!=typeof t.videoid||\"string\"!=typeof t.audioid?this.error({type:o.STRING.WARNING,\nmsg:\"Preload data videoid/audioid value must be string type.\",detail:t}):this.player&&this.player.setPreloadData(t)),r){var i=document.createElement(\"canvas\"),a=this.video.offsetWidth,s=this.video.offsetHeight,u=this.video.videoWidth/this.video.videoHeight,l=a/s;i.width=a,i.height=s,i.style.zIndex=\"10\",i.style.position=\"absolute\",i.className=o.STRING.SWITCH_SOURCE_TRANSITION_ELEMENT_CLASS_NAME;var d=i.getContext(\"2d\"),c=void 0,f=void 0;l>=u?(c=s*u,f=s):(c=a,f=a/u),d.fillRect(0,0,i.width,i.height),d.drawImage(this.video,Math.abs(a-c)/2,Math.abs(s-f)/2,c,f),this.video.parentNode.appendChild(i),this.timer.removeSwitchSourceTransition=window.setTimeout((function(){n.onVideoSwitchSourceEnded()}),1e4),i=null,d=null,this.video.removeEventListener(\"canplay\",this.onVideoSwitchSourceEnded),this.video.removeEventListener(\"playing\",this.onVideoSwitchSourceEnded),this.video.addEventListener(\"canplay\",this.onVideoSwitchSourceEnded),this.video.addEventListener(\"playing\",this.onVideoSwitchSourceEnded)}return new Promise((function(t,r){try{if(e=n.filterManifestByEnableHEVC(e,n.state.enableHEVC).manifest,n.state.mpd=e,n.player){for(var i in n.state.currentQualityIndex)n.state.currentQualityIndex[i]>=0&&n.setDefaultQualityFor(i,n.state.currentQualityIndex[i]);n.state.defaultVideoQuality=n.state.currentQualityIndex.video,n.state.defaultAudioQuality=n.state.currentQualityIndex.audio,n.bindSwitchSourceEvents(t,r,1e4),n.player.switchSource(e)}else r(\"Dash Player Error\")}catch(e){r(e)}}))},e.prototype.updateSource=function(e){var t=this;return new Promise((function(r,n){try{e=t.filterManifestByEnableHEVC(e,t.state.enableHEVC).manifest,t.player.updateSource(e);var i=window.setTimeout((function(){n({msg:\"Update Source Timeout\"})}),5e3),a=function(){t.player.off(o.EVENTS.STREAM_INITIALIZED,a),clearTimeout(i),r()};t.player.on(o.EVENTS.STREAM_INITIALIZED,a)}catch(e){n({msg:\"Call updateSource function error, \"+JSON.stringify(e),detail:e})}}))},e.prototype.appendSource=function(e,t){var r=this,n=this.state.appendingSourceState,i=this.state;return new Promise((function(a,s){n&&s(\"Dash Player is Appending Next Source!\"),r.setAutoSwitchQualityFor(\"video\",!1,!1),r.setAutoSwitchQualityFor(\"audio\",!1,!1);var u=Date.now();t&&(\"string\"!=typeof t.videoid||\"string\"!=typeof t.audioid?r.error({type:o.STRING.WARNING,msg:\"Preload data videoid/audioid value must be string type.\",detail:t}):r.player&&r.player.setPreloadData(t));var l=setTimeout((function(){r.state.appendingSourceState=!1,s({msg:\"Append source time out.\"})}),5e3);r.state.appendingSourceState=!0;try{if(r.player){for(var d in r.state.currentQualityIndex)r.state.currentQualityIndex[d]>=0&&r.setDefaultQualityFor(d,r.state.currentQualityIndex[d]);e=r.filterManifestByEnableHEVC(e,i.enableHEVC).manifest,r.player.setEndOfStreamState(!1),r.player.appendSource(e);var c=function(e){clearTimeout(l),r.player.off(o.EVENTS.APPENDED_NEXT_SOURCE,c),a({cost:Date.now()-u})};r.player.on(o.EVENTS.APPENDED_NEXT_SOURCE,c);var f=function(e){r.player.off(o.EVENTS.APPENDED_NEXT_SOURCE_DURATION_CHANGED,f),r.state.appendingSourceState=!1,i.autoSwitchTopQualityMap.video>=0&&r.setAutoSwitchTopQualityFor(\"video\",i.autoSwitchTopQualityMap.video),r.setAutoSwitchQualityFor(\"video\",i.isAutoSwitch[o.STRING.VIDEO],!1),r.setAutoSwitchQualityFor(\"audio\",i.isAutoSwitch[o.STRING.AUDIO],!1)};r.player.on(o.EVENTS.APPENDED_NEXT_SOURCE_DURATION_CHANGED,f)}else clearTimeout(l),r.state.appendingSourceState=!1,s({msg:\"Missing dash player instance!\"})}catch(e){clearTimeout(l),r.state.appendingSourceState=!1,s({msg:\"Append Source Error\",detail:e})}}))},e.prototype.getNextFragmentHistoryInfo=function(){var e=\"\";try{var t=function(e){return e?1:0};if(this.state.getNextFragmentHistory){var r=function(r){var i=n.state.getNextFragmentHistory[r],a=\"\";i.forEach((function(e){var r,n,i=[t(e.final),e.currentTime,e.bufferLevel.toFixed(3),(r=[e.bufferResetInProgress,e.isReplacement,e.switchTrack,e.hasTopQualityChanged,e.lastInitQuality,e.bufferLevelRule],n=\"\",r.length&&r.forEach((function(e){n+=\"\"+t(e)})),parseInt(n,2))];a+=i.join(\",\")+\";\"})),e+=r+\":\"+a+\"!\"\n},n=this;for(var i in this.state.getNextFragmentHistory)r(i)}}catch(e){}return e},e.prototype.isLoadingFragment=function(e){if(e)return!!this.state.fragmentLoadingInfo[e]},e.prototype.getNetworkActivity=function(){return this.components.networkActivity&&this.components.networkActivity.getNetworkActivity()},e.prototype.getNetworkActivityHistory=function(e){return void 0===e&&(e=0),this.components.networkActivity&&this.components.networkActivity.getNetworkActivityHistory(e)},e.prototype.setEndOfStreamState=function(e){void 0===e&&(e=!1);try{return this.player.setEndOfStreamState(e)}catch(e){this.error({msg:\"Call setEndOfStreamState function error\",detail:e})}},e.prototype.getLogHistory=function(){var e=this.state&&this.state.logHistory||[],t=e.join(\"\\n\");return{length:e.length,log:t,size:function(e){for(var t=[],r=[e],n=0;r.length;){var i=r.pop();if(\"boolean\"==typeof i)n+=4;else if(\"string\"==typeof i)n+=2*i.length;else if(\"number\"==typeof i)n+=8;else if(\"object\"==typeof i&&-1===t.indexOf(i))for(var a in t.push(i),i)r.push(i[a])}return n}(t)}},e.prototype.getBufferingInfo=function(){var e,t={type:-1};try{var r=this.state.currentQualityIndex.video,n=this.state.currentQualityIndex.audio;t=this.components.bufferingInfo&&this.components.bufferingInfo.getInfo({videoBufferLength:this.getBufferLength(\"video\"),audioBufferLength:this.getBufferLength(\"audio\"),videoCurrentIndex:r,audioCurrentIndex:n,videoCurrentQn:this.getQualityNumberFromQualityIndex(r,o.STRING.VIDEO),audioCurrentQn:this.getQualityNumberFromQualityIndex(n,o.STRING.AUDIO),videoSpeed:this.getAverageConnectionSpeed(o.STRING.VIDEO),audioSpeed:this.getAverageConnectionSpeed(o.STRING.AUDIO),networkActivity:this.getNetworkActivityHistory(5),playbackState:this.state.playbackState,latestPlayurlErrorHTTPCode:this.state.latestPlayurlErrorHTTPCode,fragmentLoadingInfo:this.state.fragmentLoadingInfo,networkWarningHistory:this.state.networkWarningHistory,startOffsetTime:this.state.startOffsetTime}),null===(e=this.components)||void 0===e||e.bufferingStrategy.push(t)}catch(e){throw new Error(e.message)}return t},e.prototype.destroy=function(){try{this.player.off(o.EVENTS.FRAGMENT_LOADING_STARTED,this.onFragmentLoading,this),this.player.off(o.EVENTS.FRAGMENT_LOADING_PROGRESS,this.onFragmentLoading,this),this.player.off(o.EVENTS.FRAGMENT_LOADING_COMPLETED,this.onFragmentLoading,this),this.player.off(o.EVENTS.LOG,this.onDashJSLog,this),this.player&&this.player.reset(),this.onVideoSwitchSourceEnded(),this.events={},this.config=null,this.state=null,this.video=null,this.player=null,clearTimeout(this.timer&&this.timer.networkActivity),clearTimeout(this.timer&&this.timer.loadScript),clearTimeout(this.timer&&this.timer.videoInfoSchedule),clearTimeout(this.timer&&this.timer.removeSwitchSourceTransition),this.timer=null}catch(e){this.error({msg:\"Call destroy function error, \"+(e&&e.message),detail:e})}},e.prototype.mixin=function(e){if(e&&e instanceof Object)for(var t in e)e.hasOwnProperty(t)&&this.state.hasOwnProperty(t)&&(this.state[t]=e[t]);this.state&&this.state.isAutoSwitch||(this.state.isAutoSwitch={video:!1,audio:!1})},e.prototype.loadDashPlayerScript=function(){var e=this,t=this.config.scriptSrc;return new Promise((function(r,n){try{var i=document.createElement(\"script\");i.src=t,i.onload=function(){e.state.onScriptLoading=!1,clearTimeout(e.timer.loadScript),r()},i.onerror=function(r){e.state.onScriptLoading=!1,clearTimeout(e.timer.loadScript),n({msg:\"Load dash player script error, src: \"+t,detail:r})},document.body.appendChild(i),e.state.onScriptLoading=!0,e.timer.loadScript=window.setTimeout((function(){n({msg:\"Call loadDashPlayerScript function timeout\"})}),e.config.scriptMaxLoadTime)}catch(e){n({msg:\"Call loadDashPlayerScript function error\",detail:e})}}))},e.prototype.createPlayer=function(t,r){var n=window.dashjs,i=this.state;this.state.defaultVideoQuality=this.getQualityIndexFromQualityNumber(i.defaultVideoQuality,o.STRING.VIDEO),this.state.defaultAudioQuality=this.getQualityIndexFromQualityNumber(i.defaultAudioQuality,o.STRING.AUDIO);try{var a=n.MediaPlayer().create()\n;this.player=a,this.setDebugLog(),this.bindEvents(t),this.state.logHistory.push(\"Dash player log history, \"+JSON.stringify(e.CONFIG)),i.preloadData&&a.setPreloadData(i.preloadData),a.initialize(this.video,i.mpd,i.isAutoPlay,i.enforceSSLStream),a.setABRStrategy(i.abrStrategy||o.STRING.ABR_THROUGHPUT),a.setAutoSwitchQualityFor(o.STRING.VIDEO,i.isAutoSwitch[o.STRING.VIDEO]),a.setAutoSwitchQualityFor(o.STRING.AUDIO,i.isAutoSwitch[o.STRING.AUDIO]),a.setFastSwitchEnabled(!0),a.enableLastBitrateCaching(!1),a.setBufferPruningInterval(20),i.mpd&&i.mpd.interactive&&a.setEndOfStreamState(!1),a.setJumpGaps(!0),this.setStableBufferTime(this.state.stableBufferTime)}catch(e){r({msg:\"Call createPlayer function error\",detail:e})}},e.prototype.bindEvents=function(e){var t=this,r=this.player,n=function(){r.off(o.EVENTS.STREAM_INITIALIZED,n,t),t.state.initialized=!0;var i=t.player.getBitrateInfoListFor(\"video\");e&&e(i),t.fire(o.EVENTS.STREAM_INITIALIZED),t.videoInfoSchedule()};r.on(o.EVENTS.STREAM_INITIALIZED,n,this),r.on(o.EVENTS.MANIFEST_LOADED,this.parseManifestInfo,this),r.on(o.EVENTS.GET_NEXT_FRAGMENT,this.getNextFragmentInfo,this),r.on(o.EVENTS.FRAGMENT_LOADING_STARTED,this.onFragmentLoading,this),r.on(o.EVENTS.FRAGMENT_LOADING_PROGRESS,this.onFragmentLoading,this),r.on(o.EVENTS.FRAGMENT_LOADING_COMPLETED,this.onFragmentLoading,this),r.on(o.EVENTS.LOG,this.onDashJSLog,this),r.onInitSegmentsLoaded(this.onInitSegmentsLoaded.bind(this)),r.on(o.EVENTS.DELAY_TO_APPEND_TO_BUFFER,(function(e){})),r.on(o.EVENTS.START_OFFSET_TIME_WARNING,(function(e){var r=e&&e.time;r&&r>t.state.startOffsetTime&&(t.error({type:o.STRING.WARNING,code:o.ERROR.START_OFFSET_TIME_WARNING,msg:\"Start offset time is less than buffer.start(0), \"+t.state.startOffsetTime+\" < \"+r}),t.state.startOffsetTime=r+.2)}));var i=function(){var e;null===(e=t.video)||void 0===e||e.removeEventListener(\"loadedmetadata\",i);setTimeout((function(){if(t.video){var e=t.video.buffered,n=e.length&&e.start(0),i=t.video.currentTime;i<n&&(t.error({type:o.STRING.WARNING,code:o.ERROR.START_OFFSET_TIME_WARNING,msg:\"Current offset time is less than buffer.start(0), \"+i+\" < \"+n}),t.state.startOffsetTime=n+.2,r.seek(n+.2))}}),3e3)};this.video.addEventListener(\"loadedmetadata\",i),this.bindDashCorePlayerEvents()},e.prototype.bindSwitchSourceEvents=function(e,t,r){var n=this,i=Date.now(),a=window.setTimeout((function(){n.onVideoSwitchSourceEnded(),t({err:\"Dash Player Switch Source timeout\",cost:Date.now()-i})}),r),s=function(){window.clearTimeout(a),n.player.off(o.EVENTS.STREAM_INITIALIZED,s,n),e({cost:Date.now()-i})};this.player.on(o.EVENTS.STREAM_INITIALIZED,s,this)},e.prototype.error=function(e){e.code=e.code||o.ERROR.INTERNAL_ERROR,e.msg=\"[Dash] \"+e.msg,e.type=e.type||o.STRING.ERROR,this.state&&this.state.logHistory.push(\"Dash player \"+e.type+\" - \"+e.code+\": \"+e.msg),o.STRING.ERROR===e.type?this.fire(o.EVENTS.ERROR,e):this.fire(o.EVENTS.WARNING,e)},e.prototype.bindDashCorePlayerEvents=function(){var e=this,t=this.events;this.player.on(o.EVENTS.ERROR,(function(t){e.errorHandler(t)})),this.on(o.EVENTS.QUALITY_CHANGE_REQUESTED,(function(t){e.changePlaybackState(u.BUFFERING.PLAYBACK.SWITCHING_QUALITY)})),this.on(o.EVENTS.QUALITY_CHANGE_RENDERED,(function(t){e.changePlaybackState(u.BUFFERING.PLAYBACK.PLAYING),e.state.currentQualityIndex[t.mediaType]=t.newQuality})),[{key:o.EVENTS.QUALITY_CHANGE_REQUESTED,callbackQueue:function(){return t[o.EVENTS.QUALITY_CHANGE_REQUESTED]}},{key:o.EVENTS.QUALITY_CHANGE_RENDERED,callbackQueue:function(){return t[o.EVENTS.QUALITY_CHANGE_RENDERED]}},{key:o.EVENTS.QUALITY_CHANGE_DOWNLOADED,callbackQueue:function(){return t[o.EVENTS.QUALITY_CHANGE_DOWNLOADED]}}].forEach((function(t){e.player.on(t.key,(function(r){try{var n=t.callbackQueue();n&&n.forEach((function(t){\"function\"==typeof t&&t(e.getQualityChangedData(r))}))}catch(r){e.error({msg:\"Call \"+t.key+\" callback queue error\",detail:r,type:o.STRING.WARNING})}}))})),this.player.on(o.EVENTS.FRAGMENT_LOADED_ERROR,(function(t){if(t){if(!t.code)return;var r=o.STRING.WARNING\n;t.code===o.ERROR.DOWNLOAD_FRAGMENT_ERROR_RETRY_FAILURE&&(r=o.STRING.ERROR),e.saveNetworkWarningInfo(t),e.error({code:t.code,detail:t,msg:\"Fragment Loaded Error, \"+JSON.stringify(t),type:r})}})),this.player.on(o.EVENTS.PCDN_LOADED_ERROR,(function(t){if(t){if(!t.code)return;e.error({code:t.code,detail:t,msg:\"Pcdn Loaded Error, \"+JSON.stringify(t),type:o.STRING.WARNING})}})),this.player.on(o.EVENTS.QUOTA_EXCEEDED,(function(e){}))},e.prototype.errorHandler=function(e){if(e)try{var t=e.code,r=e.error,n=e.event.message;switch(t){case o.ERROR.DOWNLOAD_ERROR:case o.ERROR.DOWNLOAD_MPD_ERROR:case o.ERROR.DOWNLOAD_XINK_ERROR:case o.ERROR.DOWNLOAD_INIT_SEGMENT_ERROR:case o.ERROR.DOWNLOAD_MEDIA_SEGMENT_ERROR:case o.ERROR.DOWNLOAD_INDEX_SEGMENT_ERROR:case o.ERROR.DOWNLOAD_SWITCHING_SEGMENT_ERROR:case o.ERROR.DOWNLOAD_OTHER_ERROR:var i=e.event.url,s=e.httpCode,u=!0;if(s&&s>=400){var l=0;if(i){var d=i.match(/expires=\\d+/g),c=i.match(/deadline=\\d+/g);l=d&&parseInt(d[0].substr(8),10)||c&&parseInt(c[0].substr(9),10)}l&&this.state.latestPlayurlExpireTimeStamp===l&&this.state.latestPlayurlErrorHTTPCode===s&&(u=!1),this.state.latestPlayurlExpireTimeStamp=l,this.state.latestPlayurlErrorHTTPCode=s}u&&this.error({code:t,msg:s+\" downloadError - \"+i,detail:e});break;case o.ERROR.MANIFEST_ERROR:case o.ERROR.MANIFEST_TYPE_ERROR:case o.ERROR.MANIFEST_RESOLVE_ERROR:this.error({code:t,msg:r+\" - \"+n,detail:e});break;case o.ERROR.MEDIA_ERROR:case o.ERROR.MEDIA_ABORTED_ERROR:case o.ERROR.MEDIA_NETWORK_ERROR:case o.ERROR.MEDIA_DECODE_ERROR:case o.ERROR.MEDIA_SUPPORTED_ERROR:case o.ERROR.MEDIA_ENCRYPTED_ERROR:case o.ERROR.MEDIA_UNKNOWN_ERROR:a.default.setSessionStorage(\"enableHEVCError\",\"1\");var f=e.event;this.error({code:t,msg:r+\" - \"+f,detail:e});break;default:this.error({msg:\"Unknown error.\",detail:e}),(undefined)}}catch(e){this.error({msg:\"Unknown error.\",detail:e})}},e.prototype.detectDashJSExists=function(){return!(!window.dashjs||!window.dashjs.MediaPlayer)},e.prototype.detectQualityTypeIsLegal=function(e){return!(e===o.STRING.VIDEO||e===o.STRING.AUDIO)},e.prototype.parseManifestInfo=function(e){var t=this;try{var r=e.data;if(this.state.manifest=r,r&&r.Period){var n={baseUri:r.baseUri,representation:{video:[],audio:[]}},i={video:{},audio:{}},a=r.Period.AdaptationSet_asArray;a.length&&a.forEach((function(e){var r=e.Representation_asArray;if(r){var a=\"\";r instanceof Array||(r=[r]),r.length&&(r.sort((function(e,t){return e.bandwidth-t.bandwidth})),r.forEach((function(r,s){var u=r.frameRate,l=r.mimeType||e.mimeType;try{if(u&&(\"\"+u).indexOf(\"/\")>-1){var d=u.split(\"/\");u=(u=parseInt(d[0],10)/parseInt(d[1],10)).toFixed(3)}}catch(e){t.error({msg:\"Parse fps error, fps: \"+u,detail:e})}var c={id:r.id,baseURL:r.BaseURL,width:r.width,height:r.height,bandwidth:r.bandwidth,codecs:r.codecs,fps:u,mimeType:l,sar:r.sar,startWithSAP:r.startWithSAP,audioSamplingRate:r.audioSamplingRate};l.indexOf(o.STRING.VIDEO)>-1?a=o.STRING.VIDEO:l.indexOf(o.STRING.AUDIO)>-1?a=o.STRING.AUDIO:t.error({msg:\"Manifest missing mimeType\",detail:r}),a&&(n.representation[a].push(c),i[a][c.id]=s)}))),t.state.maxQualityIndex[a]=r.length-1}})),this.state.manifestInfo=n,this.state.qualityNumberMap=i,this.state.setTheDefaultVideoQualityState||(this.state.setTheDefaultVideoQualityState=!0,this.setDefaultQualityFor(\"video\",this.state.defaultVideoQuality),this.setDefaultQualityFor(\"audio\",this.state.defaultAudioQuality))}}catch(t){this.error({msg:\"Parse dash player manifest error\",detail:e})}},e.prototype.getQualityIndexFromQualityNumber=function(e,t){void 0===t&&(t=o.STRING.VIDEO);var r=0;try{var n=this.state.qualityNumberMap[t];e=parseInt(\"\"+e,10);var i=this.state.maxQualityIndex[t];if(n&&n[e]>=0&&e>=this.config.minQualityNumberMappingNumber){var a=n[e];a>=0&&(r=a)}else if(-1===i||e>=0&&e<=i)r=e;else if(n){for(var s in n)if(n.hasOwnProperty(s)){var u=parseInt(s,10);u<e&&(r=n[\"\"+Math.max(r,u)])}this.error({msg:\"Quality number or index is error, qn or index: \"+e+\",using lower quality number: \"+this.getQualityNumberFromQualityIndex(r)+\" with quality index: \"+r,type:o.STRING.WARNING})\n}else this.error({msg:\"Quality number or index is error, qn or index: \"+e+\", qn map: \"+JSON.stringify(n)+\", max quality index: \"+i,type:o.STRING.WARNING})}catch(t){this.error({msg:\"Call getQualityIndexFromQualityNumber error, qn: \"+e,detail:t})}return r},e.prototype.getQualityNumberFromQualityIndex=function(e,t){void 0===t&&(t=o.STRING.VIDEO);try{var r=this.state.qualityNumberMap[t];if(e=parseInt(\"\"+e,10),r)for(var n in r)if(r.hasOwnProperty(n)&&r[n]===e)return parseInt(n,10)}catch(t){this.error({msg:\"Call getQualityNumberFromQualityIndex error, qn: \"+e,detail:t})}return 32},e.prototype.getDroppedFramesInfo=function(){try{return this.player.getDroppedFramesInfo()||{}}catch(e){this.error({msg:\"Call getDroppedFramesInfo function error\",detail:e,type:o.STRING.WARNING})}},e.prototype.getCurrentTrackFor=function(e){try{return this.player.getCurrentTrackFor(e)||{}}catch(e){this.error({msg:\"Call getCurrentTrackFor function error, \"+(e&&e.message),detail:e,type:o.STRING.WARNING})}},e.prototype.getCurrentSegmentInfoFor=function(e){void 0===e&&(e=o.STRING.VIDEO);try{return this.player.getCurrentSegmentInfoFor(e)||{}}catch(e){this.error({msg:\"Call getCurrentSegmentInfoFor function error\",detail:e,type:o.STRING.WARNING})}},e.prototype.onInitSegmentsLoaded=function(e,t){try{if(this.state.segmentsInfoMap[e]=t,!t.isDurationAllEqual){var r=t.notEqualQualityIndex;this.error({code:o.ERROR.DURATION_IS_NOT_ALL_EQUAL,msg:\"Segments duration is not all equal, type: \"+e+\", quality index switch: \"+r.old+\" => \"+r.new+\", segment index list: \"+t.notEqualIndexList+\" } \"})}var n=this.state.segmentsInfoMap,i=this.state.appendingSourceState;if(n&&n.video&&n.audio&&!i){var a=n.video.realDuration,s=n.audio.realDuration,u=Math.abs(a-s);if(u>3){var l=this.getQualityNumberFromQualityIndex(n.video.qualityIndex,o.STRING.VIDEO),d=this.getQualityNumberFromQualityIndex(n.audio.qualityIndex,o.STRING.AUDIO),c=n.video.segments.length,f=n.audio.segments.length;this.error({type:o.STRING.WARNING,code:o.ERROR.DURATION_DEVIATION_IS_TOO_LARGE,msg:\"Video / audio duration deviation is too large, deviation: \"+u+\"s. Video qn:\"+l+\", segments:\"+c+\", duration:\"+a+\". Audio qn:\"+d+\", segments:\"+f+\", duration:\"+s})}}if(this.state.startOffsetTime<t.startOffsetTime&&(this.state.startOffsetTime=t.startOffsetTime,t.segments&&t.segments.length)){var h=t.segments[0];h.duration,h.timescale;this.state.startOffsetTime>.1&&(this.player.seek(this.state.startOffsetTime+.2),this.error({type:o.STRING.WARNING,code:o.ERROR.START_OFFSET_TIME_WARNING,msg:e+\" start offset time is greater than 0, \"+this.state.startOffsetTime}))}}catch(e){this.error({msg:\"Call onInitSegmentsLoaded function error\",detail:e})}},e.prototype.setMaxAllowedBitrateFor=function(e,t){try{this.player.setMaxAllowedBitrateFor(e,t)}catch(e){this.error({msg:\"Call setMaxAllowedBitrateFor function error\",detail:e})}},e.prototype.videoInfoSchedule=function(){var e=this,t={},r={};try{var n=this.state,i=n.manifestInfo,a=n.currentQualityIndex,s=i.representation[o.STRING.VIDEO][a[o.STRING.VIDEO]]||{},u=i.representation[o.STRING.AUDIO][a[o.STRING.AUDIO]]||{},l=s.mimeType+';codecs=\"'+s.codecs+'\"',d=this.getCurrentSegmentInfoFor(o.STRING.VIDEO),c=u.mimeType+';codecs=\"'+u.codecs+'\"',f=this.getCurrentSegmentInfoFor(o.STRING.AUDIO),h=this.getDroppedFramesInfo(),p=this.getCurrentCodecID(o.STRING.VIDEO);t={width:s.width,height:s.height,sar:s.sar,mimeType:l+\", \"+c,fps:s.fps,videoDataRate:s.bandwidth,videoCodec:s.codecs,videoCodecID:p,audioDataRate:u.bandwidth,audioCodec:u.codecs,audioCodecID:0,audioSampleRate:u.audioSamplingRate||0,audioChannelCount:0},r={playerType:\"DashPlayer\",speed:Math.round(this.getAverageConnectionSpeed(o.STRING.VIDEO)),videoConnectionSpeed:Math.round(this.getAverageConnectionSpeed(o.STRING.VIDEO)),audioConnectionSpeed:Math.round(this.getAverageConnectionSpeed(o.STRING.AUDIO)),networkActivity:this.components.networkActivity&&this.components.networkActivity.getNetworkActivity(),videoBufferHealth:this.getBufferLength(\"video\")||0,audioBufferHealth:this.getBufferLength(\"audio\")||0,droppedFrames:h.droppedFrames||0,\ndecodedFrames:h.totalFrames||0,audioURL:f.url||\"\",audioCurrentSegmentIndex:f.index||0,audioCurrentSegmentStartTime:f.startTime||0,audioCurrentSegmentDuration:f.duration||0,audioTotalSegmentCount:n.segmentsInfoMap[o.STRING.AUDIO].total||0,videoURL:d.url||\"\",videoCurrentSegmentIndex:d.index||0,videoCurrentSegmentStartTime:d.startTime||0,videoCurrentSegmentDuration:d.duration||0,videoTotalSegmentCount:n.segmentsInfoMap[o.STRING.VIDEO].total||0},this.state.mediaInfo=t,this.state.statisticsInfo=r,this.fire(o.EVENTS.VIDEO_INFO,{mediaInfo:t,statisticsInfo:r})}catch(e){}clearTimeout(this.timer&&this.timer.videoInfoSchedule),this.config&&this.config.videoInfoScheduleTime&&this.timer&&(this.timer.videoInfoSchedule=window.setTimeout((function(){e.videoInfoSchedule()}),this.config.videoInfoScheduleTime))},e.prototype.getQualityChangedData=function(e,t){var r={};try{var n=e.mediaType,i=e.type,a=e.newQuality,s=e.oldQuality,u=this.state.isAutoSwitch[n];r={mediaType:n,type:i,newQuality:a,newQualityNumber:this.getQualityNumberFromQualityIndex(a,n),oldQuality:s,oldQualityNumber:this.getQualityNumberFromQualityIndex(s,n),currentTime:this.getCurrentTime(),isAutoSwitch:u,dict:this.player.getThroughputDict(\"video\")},o.EVENTS.QUALITY_CHANGE_RENDERED===i?((t=t||this.state.autoSwitchStartTime||0)&&(r.cost=Math.floor(Date.now()-t)),this.state.autoSwitchStartTime=0):o.EVENTS.QUALITY_CHANGE_REQUESTED===i&&(this.state.autoSwitchStartTime=Date.now())}catch(e){this.error({msg:\"Call getQualityChangedData error\",detail:e,type:o.STRING.WARNING})}return r},e.prototype.onVideoSwitchSourceEnded=function(e){try{var t=void 0;if(e&&e.target){var r=e.target.parentElement;t=r&&r.querySelectorAll(\".\"+o.STRING.SWITCH_SOURCE_TRANSITION_ELEMENT_CLASS_NAME)}else t=document.querySelectorAll(\".\"+o.STRING.SWITCH_SOURCE_TRANSITION_ELEMENT_CLASS_NAME);t&&t.length&&t.forEach((function(e){e&&e.parentElement.removeChild(e)}))}catch(e){(undefined)}},e.prototype.getStartOffsetTime=function(){var e=0;try{var t=this.state.segmentsInfoMap;t&&(e=Math.max(t.video.startOffsetTime,t.audio.startOffsetTime))}catch(e){}return e},e.prototype.setDebugLog=function(){try{var e=location.href;e&&e.indexOf(\"debug=1\")>0&&this.player.getDebug().setLogToBrowserConsole(!0)}catch(e){}},e.prototype.getNextFragmentInfo=function(e){if(e&&e.mediaType){var t=e.mediaType;this.state.getNextFragmentHistory||(this.state.getNextFragmentHistory={video:[],audio:[]});var r=!1,n=this.state.getNextFragmentHistory[t].length;if(n){var i=this.state.getNextFragmentHistory[t][this.state.getNextFragmentHistory[t].length-1];for(var a in i)if(i[a]!==e[a]){r=!0;break}}!r&&n||(n>=30&&this.state.getNextFragmentHistory[e.mediaType].splice(0,1),this.state.getNextFragmentHistory[e.mediaType].push(e))}},e.prototype.onFragmentLoading=function(e){if(e&&e.type){var t=e.type,r=e.request,n=this.covertFragmentInfoObject(r);if(n.loadingType=t,t===o.EVENTS.FRAGMENT_LOADING_STARTED)this.state.fragmentLoadingInfo[n.mediaType]=n;else if(t===o.EVENTS.FRAGMENT_LOADING_COMPLETED){var i=this.state.fragmentLoadingInfo[n.mediaType];n.isError=!!e.error;var a=e.response&&e.response.byteLength||0,s=Number(r.firstByteDate)-Number(r.requestStartDate);s=s?Math.max(s,1):1;var u=Number(r.requestEndDate)-Number(r.firstByteDate);u=u?Math.max(u,1):1;var l=Number(r.requestEndDate)-Number(r.requestStartDate);l=l?Math.max(l,1):1;var d=Math.round(8*a/l);n.latencyTime=s,n.downloadTime=u,n.totalTime=l,n.downloadBytes=a,n.connectionSpeed=d,n.data=e.response,n.totalSize=this.state.segmentsInfoMap[n.mediaType].rangeEnd+1;var c=!0;for(var f in i)if(i[f]!==n[f]&&\"loadingType\"!==f&&!isNaN(i[f])){c=!1;break}c&&(this.state.fragmentLoadingInfo[n.mediaType]=null,this.fire(o.EVENTS.FRAGMENT_LOADING_COMPLETED,n))}else this.components.networkActivity&&this.components.networkActivity.onFragmentLoadingProgess(e)}},e.prototype.covertFragmentInfoObject=function(e){var t={};try{t={loadingType:\"\",type:e.type,mediaType:e.mediaType,startTime:e.startTime,url:e.url,index:e.index,id:e.representationId,\nqn:this.getQualityNumberFromQualityIndex(e.quality,e.mediaType),range:e.range,duration:e.duration,isError:!1}}catch(e){}return t},e.prototype.onDashJSLog=function(e){this.state.logHistory||(this.state.logHistory=[]),this.state.logHistory.length>=2e4&&this.state.logHistory.shift(),e&&this.state.logHistory.push(e.message)},e.prototype.changePlaybackState=function(e){return this.state.playbackState=e,this},e.prototype.saveNetworkWarningInfo=function(e){this.state.networkWarningHistory||(this.state.networkWarningHistory=[]),this.state.networkWarningHistory.length>=100&&this.state.networkWarningHistory.shift(),this.state.networkWarningHistory.push(e)},e.prototype.filterManifestByEnableHEVC=function(e,t){void 0===t&&(t=!1);var r=!1;if(t=this.applyEnableHEVCStrategy(t),e&&e.video&&e.video instanceof Array){var n=e.video;if(n.length&&n instanceof Array){var i=7;if(t){var a=n.filter((function(e){return 12===e.codecid}));r=!0,a&&a.length?(i=12,a.forEach((function(e){var t,n;(null===(n=null===(t=window.MediaSource)||void 0===t?void 0:t.isTypeSupported)||void 0===n?void 0:n.call(t,'video/mp4; codecs=\"'+e.codecs+'\"'))||(i=7,r=!1)}))):(i=7,r=!1)}e.video=e.video.filter((function(e){return e.codecid===i}))}}return{manifest:e,isHEVCTypeSupported:r}},e.prototype.applyEnableHEVCStrategy=function(e){if(e){var t=navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase(),r=t.indexOf(\"edge/\")>-1,n=this.state.defaultVideoQuality,i=n>112&&!r&&t.indexOf(\"chrome/\")>0,o=n>116,s=t.indexOf(\"edg/\")>-1,u=a.default.getSessionStorage(\"enableHEVCError\");(i||o)&&(e=!1);var l=\"bilibili_player_codec_prefer_type\",d=parseInt(a.default.getLocalStorage(l),10);if(1===d)e=!0;else if(2===d)e=!1,this.resetHEVCDefaultStrategy().then((function(){a.default.setLocalStorage(l,\"0\")})).catch((function(){}));else{this.resetHEVCDefaultStrategy().catch((function(){}));var c=parseInt(a.default.getLocalStorage(\"bilibili_player_codec_prefer_strategy\"),10);2===c&&(this.onDashJSLog({type:\"HEVCStrategyDisabledByPerf\",message:\"HEVC perfer strategy disabled by performance, strategy type: \"+c}),e=!1)}125===n&&(e=!0),(s||u)&&(e=!1),this.state.logHistory&&(this.state.logHistory.push(t),this.state.logHistory.push(\"Apply strategy: \"+e+\" (\"+d+\", \"+i+\", \"+o+\", \"+s+\", \"+u+\") \\n\"))}return e},e.prototype.resetHEVCDefaultStrategy=function(){var e=this;return new Promise((function(t,r){var n=\"bilibili_player_codec_prefer_reset\",i=\"1.5.2\";a.default.getLocalStorage(n)!==i?(e.onDashJSLog({type:\"HEVCStrategyReset\",message:\"Reset HEVC perfer strategy, latest version: 1.5.2\"}),a.default.setLocalStorage(n,i),t()):r()}))},e.EVENTS=o.EVENTS,e.ERROR=o.ERROR,e.STRING=o.STRING,e.BUFFERING=u.BUFFERING,e.CONFIG=n.CONFIG,e.isHEVCTypeSupported=i.isHEVCTypeSupported,e.isHEVCHDR10TypeSupported=i.isHEVCHDR10TypeSupported,e}();t.default=d},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.CONFIG=void 0;var n={version:\"1.5.5\",gitHash:\"c30ebbb0\",build:157,release:\"2020-11-30T07:51:51.155Z\",mode:\"production\"};t.CONFIG=n},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.isHEVCHDR10TypeSupported=t.isHEVCTypeSupported=void 0;var n=r(3);t.isHEVCTypeSupported=function(){var e,t;return null===(t=null===(e=window.MediaSource)||void 0===e?void 0:e.isTypeSupported)||void 0===t?void 0:t.call(e,'video/mp4; codecs=\"hev1.1.6.L120.90\"')};t.isHEVCHDR10TypeSupported=function(){var e,t,r,i,a,o,s=!1,u=null===(t=null===(e=window.navigator)||void 0===e?void 0:e.userAgent)||void 0===t?void 0:t.toLowerCase(),l=u.indexOf(\"safari\")>-1&&u.indexOf(\"chrom\")<0,d=0,c=u.match(/version\\/\\d+/);l&&c&&c.length&&(d=Number(c[0].substr(8)));var f=u.indexOf(\"edge/\")>-1,h=0,p=u.match(/edge\\/\\d+/);f&&p&&p.length&&(h=Number(p[0].substr(5)));var g=null===(i=null===(r=window.MediaSource)||void 0===r?void 0:r.isTypeSupported)||void 0===i?void 0:i.call(r,'video/mp4; codecs=\"hev1.2.4.H156.90\"'),m=null===(a=window.matchMedia(\"(color-gamut:p3)\"))||void 0===a?void 0:a.matches,E=(null===(o=window.screen)||void 0===o||o.colorDepth,parseInt(n.default.getLocalStorage(\"bilibili_player_force_hdr\"),10))\n;return g&&(l&&m&&d>=13||f&&h>=18||E)&&(s=!0),s}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(){this.state={runningInterval:1e3,maxCacheLength:200,fragmentLoadingProgressInfo:{},networkActivityLoadedList:[],networkActivityHistory:[],networkActivityLatestTraceTime:0},this.initalize()}return e.prototype.onFragmentLoadingProgess=function(e){var t=e.request,r=0,n=Math.floor(performance.now()),i=t.quality+\"-\"+t.index+\"-\"+t.ts,a=!1;if(this.state.fragmentLoadingProgressInfo[t.mediaType]&&this.state.fragmentLoadingProgressInfo[t.mediaType][i]){var o=this.state.fragmentLoadingProgressInfo[t.mediaType][i],s=!1;for(var u in o)if(\"bytesLoaded\"!==u&&o[u]!==t[u])s=!0;else if(o.bytesLoaded===t.bytesLoaded)return;r=s?t.bytesLoaded:t.bytesLoaded-o.bytesLoaded}else this.state.fragmentLoadingProgressInfo[t.mediaType]||(this.state.fragmentLoadingProgressInfo[t.mediaType]={}),r=t.bytesLoaded;t.bytesLoaded===t.bytesTotal&&(a=!0),a?delete this.state.fragmentLoadingProgressInfo[t.mediaType][i]:this.state.fragmentLoadingProgressInfo[t.mediaType][i]={bytesLoaded:t.bytesLoaded,bytesTotal:t.bytesTotal,quality:t.quality,index:t.index,mediaType:t.mediaType,range:t.range},this.state.networkActivityLoadedList.length>=this.state.maxCacheLength&&this.state.networkActivityLoadedList.splice(0,1),r&&this.state.networkActivityLoadedList.push({time:n,loaded:Math.max(r,0)})},e.prototype.getNetworkActivity=function(){return this.state.networkActivityHistory.length?this.state.networkActivityHistory[this.state.networkActivityHistory.length-1]:0},e.prototype.getNetworkActivityHistory=function(e){return void 0===e&&(e=0),e?this.state.networkActivityHistory.slice(this.state.networkActivityHistory.length-e):this.state.networkActivityHistory},e.prototype.destroy=function(){clearTimeout(this.state&&this.state.networkActivityTimer),this.state=null},e.prototype.initalize=function(){this.runNewWorkActivityTimer()},e.prototype.runNewWorkActivityTimer=function(){var e=this;this.runNetworkActivity(),clearTimeout(this.state.networkActivityTimer),this.state.networkActivityTimer=window.setTimeout((function(){e.runNewWorkActivityTimer()}),this.state.runningInterval)},e.prototype.runNetworkActivity=function(){var e=this.state.runningInterval,t=Math.floor(performance.now()),r=this.state.networkActivityLatestTraceTime,n=this.state.networkActivityLoadedList.filter((function(n){return t-n.time<e&&t>r}));this.state.networkActivityLatestTraceTime=t;var i=0;n&&n.length&&n.forEach((function(e){return i+=e.loaded})),this.state.networkActivityHistory.length>=this.state.maxCacheLength&&this.state.networkActivityHistory.splice(0,1),this.state.networkActivityHistory.push(Math.max(i,0))},e}();t.default=n},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(4),i=r(7),a=r(3),o=\"hevcPerf\",s=function(){function e(){this.bufferingHistory=[],this.state={enableHEVC:!1}}return e.prototype.setHEVCEnableFlag=function(e){return void 0===e&&(e=!1),this.state.enableHEVC=e,this},e.prototype.push=function(e){this.bufferingHistory.length>=this.MAX_HISTORY_LENGTH&&this.bufferingHistory.shift(),e.timestamp=this.getNow(),this.bufferingHistory.push(e),this.optimize()},e.prototype.setOnOptimizingCallback=function(e){this.state.onOptimizingCallback=e},e.prototype.onOptimzing=function(e,t){\"function\"==typeof this.state.onOptimizingCallback&&this.state.onOptimizingCallback(e,t)},e.prototype.optimize=function(){var e=this.getNow(),t=this.bufferingHistory.filter((function(t){return e-t.timestamp<=2e4}));if(this.state.enableHEVC){var r=\"\"+i.BUFFERING.PLAYBACK.PLAYING+i.BUFFERING.TYPE.PERFORMANCE,n=t.filter((function(e){return r===e.type}));n&&n.length>=10&&(this.state.enableHEVC=!1,this.disableHEVCFlag())}},e.prototype.disableHEVCFlag=function(){1!==parseInt(a.default.getLocalStorage(\"bilibili_player_codec_prefer_type\"),10)&&(a.default.setLocalStorage(\"bilibili_player_codec_prefer_strategy\",\"2\"),this.onOptimzing(n.EVENTS.BUFFERING_OPTIMIZATION,{type:o}))},e.prototype.getNow=function(){var e\n;return(null===(e=window.performance)||void 0===e?void 0:e.now())||Date.now()},e}();t.default=s}])}));\n(function(p){function v(h){if(n[h])return n[h].exports;var g=n[h]={i:h,l:!1,exports:{}};p[h].call(g.exports,g,g.exports,v);g.l=!0;return g.exports}var n={};v.m=p;v.c=n;v.d=function(h,g,d){v.o(h,g)||Object.defineProperty(h,g,{configurable:!1,enumerable:!0,get:d})};v.n=function(h){var g=h&&h.__esModule?function(){return h[\"default\"]}:function(){return h};v.d(g,\"a\",g);return g};v.o=function(h,g){return Object.prototype.hasOwnProperty.call(h,g)};v.p=\"\";return v(v.s=23)})([function(p,v,n){v.a={UI_NORMAL:0,\nUI_WIDE:1,UI_WEB_FULL:2,UI_FULL:3,UI_MINI:4,V_IDEL:0,V_READY:1,V_BUFF:2,V_PLAY:3,V_PAUSE:4,V_COMPLETE:5,DM_OFF:!1,DM_ON:!0,V_REPEAT_OFF:!1,V_REPEAT_ON:!0,USER_UNLOGIN:0,USER_LIMITED:1,USER_REGISTERED:2,USER_NORMAL:3,USER_VIP:4,USER_ADVANCED:5,P_ROLE_FREE:0,P_ROLE_ASSISTANT:1,BLOCK_DISABLED:0,BLOCK_SCROLL:1,BLOCK_REVERSE:2,BLOCK_BOTTOM:3,BLOCK_TOP:4,BLOCK_COLOR:5,BLOCK_GUEST:6,BLOCK_FONTSIZE:7,BLOCK_NORMAL:8,BLOCK_SUBTITLE:9,BLOCK_SPECIAL:10,BLOCK_LIST_USER:11,BLOCK_LIST_KEYWORD:12,BLOCK_LIST_COLOR:13,\nBLOCK_LIST_REGEXP:14,BLOCK_CLOUD_VIDEO:15,BLOCK_CLOUD_PARTITION:16,BLOCK_CLOUD_ALL:17,BLOCK_CLOUD_UP:18,BLOCK_TAB_TEXT:0,BLOCK_TAB_REGEXP:1,BLOCK_TAB_USER:2,SEND_POOL_NORMAL:[],SEND_POOL_ADMIN:[1,1],SEND_FONT_SIZE_UNLOGIN:[0,0,0,0,0,0,0],SEND_FONT_SIZE_LIMITED:[0,0,1,1,0,0,0],SEND_FONT_SIZE_REGISTERED:[0,0,1,1,0,0,0],SEND_FONT_SIZE_NORMAL:[0,0,1,1,0,0,0],SEND_FONT_SIZE_VIP:[0,1,1,1,1,0,0],SEND_FONT_SIZE_ADVANCED:[1,1,1,1,1,1,1],SEND_FONT_SIZE_ADMIN:[0,0,1,1,1,0,0],SEND_MODE_UNLOGIN:[0,0,0,0],SEND_MODE_LIMITED:[1,\n-2,-2,0],SEND_MODE_REGISTERED:[1,-2,-2,0],SEND_MODE_NORMAL:[1,-2,-2,0],SEND_MODE_VIP:[1,1,1,1],SEND_MODE_ADVANCED:[1,1,1,1],SEND_MODE_LEVEL_LOW:[1,-2,-2,0],SEND_MODE_LEVEL_TWO:[1,-2,-2,0],SEND_MODE_LEVEL_NORMAL:[1,1,1,0],SEND_COLOR_UNLOGIN:0,SEND_COLOR_LEVEL_LOW:1,SEND_COLOR_NORMAL:2,SEND_STATUS_UNLOGIN:0,SEND_STATUS_LEVEL_LOW:1,SEND_STATUS_MORAL_LOW:2,SEND_STATUS_DISABLED_WORDS:3,SEND_STATUS_LIMITED:4,SEND_STATUS_NORMAL:5,SEND_STATUS_TYPING:6,SEND_STATUS_BEYOND_WORDS:7,SEND_STATUS_SENDING:8,SEND_STATUS_SENT:9,\nSEND_STATUS_FREQUENTLY:10,SEND_STATUS_BLOCKING:11,SEND_STATUS_BLOCKED:12,SEND_INPUT_UNLOGIN:[],SEND_INPUT_LIMITED:[20,1E4],SEND_INPUT_REGISTERED:[20,1E4],SEND_INPUT_NORMAL:[220,5E3],SEND_INPUT_VIP:[220,1E3],SEND_INPUT_ADVANCED:[220,1E3],PLAYER_ERROR:1,PLAYER_NETWORK_ERROR:1101,PLAYER_FORM_ERROR:1103,PLAYER_ANALYZE_ERROR:1104,PLAYURL_ERROR:2,PLAYURL_NETWORK_ERROR:2101,PLAYURL_FORM_ERROR:2103,PLAYURL_RESOLVE_ERROR:2104,PLAYURL_BANGUMI_NETWORK_ERROR:2108,PLAYURL_BANGUMI_FORM_ERROR:2110,PLAYURL_BANGUMI_RESOLVE_ERROR:2111,\nVIDEO_ERROR:3,VIDEO_URL_ERROR:3001,VIDEO_ANALYZE_ERROR:3002,VIDEO_PLAY_ERROR:3104,NETWORK_EXCEPTION:3111,NETWORK_STATUS_CODE_INVALID:3112,NETWORK_UNRECOVERABLE_EARLY_EOF:3113,NETWORK_RECOVERED_EARLY_EOF:3114,MEDIA_MSE_ERROR:3121,MEDIA_FORMAT_ERROR:3122,MEDIA_FORMAT_UNSUPPORTED:3123,MEDIA_CODEC_UNSUPPORTED:3124,ERROR_MESSAGES:{3104:\"\\u65e0\\u6cd5\\u8fde\\u63a5\\u670d\\u52a1\\u5668\\u6216\\u670d\\u52a1\\u5668\\u8fd4\\u56de\\u5f02\\u5e38\",3111:\"\\u65e0\\u6cd5\\u8fde\\u63a5\\u670d\\u52a1\\u5668\",3112:\"\\u670d\\u52a1\\u5668\\u8fd4\\u56de\\u5f02\\u5e38\",\n3113:\"\\u670d\\u52a1\\u5668\\u8fde\\u63a5\\u4e2d\\u65ad\",3121:\"\\u6d4f\\u89c8\\u5668\\u89e3\\u7801\\u51fa\\u9519\",3122:\"\\u89c6\\u9891\\u683c\\u5f0f\\u9519\\u8bef\",3123:\"\\u89c6\\u9891\\u683c\\u5f0f\\u4e0d\\u652f\\u6301\",3124:\"\\u89c6\\u9891\\u7f16\\u7801\\u4e0d\\u652f\\u6301\"},EVENT:{VIDEO_MEDIA_ENTER:\"video_media_enter\",VIDEO_MEDIA_PLAY:\"video_media_play\",VIDEO_MEDIA_PLAYING:\"video_media_playing\",VIDEO_MEDIA_PAUSE:\"video_media_pause\",VIDEO_MEDIA_SEEK:\"video_media_seek\",VIDEO_MEDIA_SEEKING:\"video_media_seeking\",VIDEO_MEDIA_SEEKED:\"video_media_seeked\",\nVIDEO_MEDIA_TIME:\"video_media_time\",VIDEO_MEDIA_ERROR:\"video_media_error\",VIDEO_MEDIA_BUFFER:\"video_media_buffer\",VIDEO_MEDIA_BUFFER_END:\"video_media_buffer_end\",VIDEO_MEDIA_BUFFER_FULL:\"video_media_buffer_full\",VIDEO_MEDIA_LOADLAG:\"video_media_loadlag\",VIDEO_MEDIA_ENDED:\"video_media_ended\",VIDEO_MEDIA_VOLUME:\"video_media_volume\",VIDEO_MEDIA_MUTE:\"video_media_mute\",VIDEO_MEDIA_ATTACHED:\"video_media_attached\",VIDEO_PLAYER_LOAD:\"video_player_load\",VIDEO_PLAYER_LOADED:\"video_player_loaded\",VIDEO_PLAYURL_LOAD:\"video_playurl_load\",\nVIDEO_PLAYURL_LOADED:\"video_playurl_loaded\",VIDEO_METADATA_LOAD:\"video_media_load\",VIDEO_METADATA_LOADED:\"video_media_loaded\",VIDEO_DANMAKU_LOAD:\"video_danmaku_load\",VIDEO_DANMAKU_LOADED:\"video_danmaku_loaded\",VIDEO_PAGELIST_LOADED:\"video_pagelist_loaded\",VIDEO_WEBSOCKET_LINK:\"video_websocket_link\",VIDEO_WEBSOCKET_LINKED:\"video_websocket_linked\",VIDEO_WEBSOCKET_ERROR:\"video_websocket_error\",VIDEO_WEBSOCKET_END:\"video_websocket_end\",VIDEO_INITIALIZING:\"video_initializing\",VIDEO_INITIALIZED:\"video_initialized\",\nVIDEO_SCROLL:\"video_scroll\",VIDEO_RESIZE:\"video_resize\",VIDEO_PROGRESSBAR_RESIZE:\"video_progressbar_resize\",VIDEO_REFULLSCREEN:\"video_refullscreen\",VIDEO_FULLSCREEN_MODE_CHANGED:\"video_fullscreen_mode_changed\",VIDEO_MOUSEMOVE:\"video_mousemove\",VIDEO_PLAYER_MOUSEMOVE:\"video_player_mousemove\",VIDEO_HEARTBEAT:\"video_heartbeat\",VIDEO_BEFORE_DESTROY:\"video_before_destroy\",VIDEO_DESTROY:\"video_destroy\",VIDEO_LOG:\"video_log\",VIDEO_LOG_UPDATE:\"video_log_update\",VIDEO_LOG_CLOSE:\"video_log_close\",VIDEO_PROMOTE_INIT:\"video_promote_init\"},\nQUALITY:{CODE:{0:0,16:16,32:32,64:64,80:80,112:112,1:16,2:64,3:80,4:112,48:64},NAME:{0:\"\\u81ea\\u52a8\",16:\"\\u6d41\\u7545\",32:\"\\u6e05\\u6670\",64:\"\\u9ad8\\u6e05\",80:\"\\u8d85\\u6e05\",112:\"1080P\"},FORMAT:{hdflv2:112,flv:80,flv640:64,flv720:64,hdmp4:64,flv480:32,mp4:16}},TRACK:{OP:\"001111\",EVENT:\"001114\"}}},function(p,v,n){var h=function(){function g(){this.prefix=g.prefix;this.debugMode=!0}g.prototype.uniqueId=function(d){var c=this.prefix;return d.each(function(){this.id||(this.id=c+\"id-\"+ ++g.uuid)})};g.prototype.removeUniqueId=\nfunction(d){return d.each(function(){(new RegExp(\"^\"+this.prefix+\"id-d+$\")).test(this.id)&&$(this).removeAttr(\"id\")})};Object.defineProperty(g.prototype,\"destroy\",{get:function(){var d=this;return function(){var c=d.prefix;d.destroyCus();d.element.off(d.namespace()).removeData(d.componentName);d.widget().off(d.namespace()).removeAttr(\"data-disabled\").removeClass(d.componentName+\"-disabled \"+c+\"state-disabled\");d.bindings.off(d.namespace());d.hoverable.removeClass(c+\"state-hover\");d.focusable.removeClass(c+\n\"state-focus\")}},enumerable:!0,configurable:!0});g.prototype.destroyCus=function(){};g.prototype.enable=function(){return this.setOptions({disabled:!1})};g.prototype.disable=function(){return this.setOptions({disabled:!0})};g.prototype.widget=function(){return this.element};g.prototype.trigger=function(){for(var d=0;d<arguments.length;d++);var d=Array.prototype.slice.call(arguments,0),c=d.shift();if(this.options[c])return this.options[c].apply(this,d)};g.prototype.on=function(){function d(c){var d=\nfunction(){if(e||!0!==b.options.disabled&&!$(this).hasClass(f+\"state-disabled\"))return(\"string\"===typeof c?b[c]:c).apply(b,arguments)};\"string\"!==typeof c&&(d.guid=c.guid=c.guid||d.guid||$.guid++);return d}for(var c=0;c<arguments.length;c++);var b=this,c=Array.prototype.slice.call(arguments,0),e=!1;\"boolean\"===typeof c[0]&&(e=c.shift());var f=this.prefix;if(c[0]instanceof jQuery){var k=$(c.shift());this.bindings=this.bindings.add(k)}else k=this.element;if(\"object\"===typeof c[0]){var m={},A;for(A in c[0])c[0].hasOwnProperty(A)&&\n(m[this.namespace(A)]=d(c[0][A]),delete c[0][A]);c[0]=m}else c[0]=this.namespace(c[0]),c[c.length-1]=d(c[c.length-1]);return k.on.apply(k,c)};g.prototype.off=function(d,c){d instanceof jQuery||(c=d,d=this.element);c=(c||\"\").split(\" \").join(this.namespace()+\" \")+this.namespace();this.bindings=$(this.bindings.not(d).get());this.focusable=$(this.focusable.not(d).get());this.hoverable=$(this.hoverable.not(d).get());return d.off.call(d,c)};g.prototype.delay=function(d,c){void 0===c&&(c=0);var b=this;return window.setTimeout(function(){return(\"string\"===\ntypeof d?b[d]:d).apply(b,arguments)},c)};Object.defineProperty(g.prototype,\"option\",{get:function(){var d=this;return function(c,b){var e;if(0===arguments.length)return $.extend(!0,{},d.options);if(\"string\"===typeof c){var f={};var k=c.split(\".\");c=k.shift();if(k.length){var m=f[c]=$.extend(!0,{},d.options[c]);for(e=0;e<k.length-1;e++)m[k[e]]=m[k[e]]||{},m=m[k[e]];c=k.pop();if(void 0===b)return void 0===m[c]?null:m[c];m[c]=b}else{if(void 0===b)return void 0===d.options[c]?null:d.options[c];f[c]=b}}else f=\nc;d.setOptions(f);return d}},enumerable:!0,configurable:!0});g.prototype.setOptions=function(d){for(var c in d)d.hasOwnProperty(c)&&this.setOption(c,d[c]);return this};g.prototype.setOption=function(d,c){var b=this.prefix;$.isPlainObject(c)?$.extend(!0,this.options[d],c):this.options[d]=c;\"disabled\"===d&&(this.widget().toggleClass(this.componentFullName+\"-disabled\",!!c),c&&(this.hoverable.removeClass(b+\"state-hover\"),this.focusable.removeClass(b+\"state-focus\")));return this};g.prototype.setAttributes=\nfunction(d,c){if(void 0!==c)for(var b in c)c.hasOwnProperty(b)&&(\"class\"===b?d.addClass(c[b]):d.attr(b,c[b]))};g.prototype.createComponent=function(d,c){this.container=$(d||this.defaultElement||this);d=this.prefix=c.prefix||this.prefix;this.container&&this.container.length||(this.container=$(\"<div>\").attr(\"data-component\",this.constructor.id));this.element=this.container;this.uuid=c.uuid;this.componentName=c.id;this.componentFullName=d+this.componentName;var b=d+c.id;$.expr[\":\"][b.toLowerCase()]=\nfunction(c){return!!$.data(c,b)};this.options=$.extend(!0,{},{disabled:!1,create:null},this.options,c);this.container.addClass(d+\"component\").addClass(d+this.options.id);this.eventNamespace=\".\"+this.componentName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();c=this.element[0];this.document=$(c.style?c.ownerDocument:c.document||c);try{$(window.parent.document).is(this.document)||(this.document=this.document.add(window.parent.document))}catch(e){(undefined)}this.window=$(this.document[0].defaultView||\nthis.document[0].parentWindow);this.create();this.trigger(\"create\");this.init();this.initEvent();return this};g.prototype.create=function(){};g.prototype.init=function(){};g.prototype.initEvent=function(){};g.prototype.cssPrefix=function(d){return this.prefix+this.componentName+\"-\"+d};g.prototype.namespace=function(d){void 0===d&&(d=\"\");return d+this.eventNamespace};g.prototype.getEventsPage=function(d){d=void 0!==d.pageX?d:d.originalEvent;var c=[];c.y=\"undefined\"!==typeof d.pageY&&(d.pageY||d.pageX)?\nd.pageY:d.touches?d.touches[0].pageY:null;c.x=\"undefined\"!==typeof d.pageX&&(d.pageY||d.pageX)?d.pageX:d.touches?d.touches[0].pageX:null;c.cy=\"undefined\"!==typeof d.clientY&&(d.clientY||d.clientX)?d.clientY:d.touches[0].clientY;c.cx=\"undefined\"!==typeof d.clientX&&(d.clientY||d.clientX)?d.clientX:d.touches[0].clientX;return c};g.prototype.initHover=function(d){var c=this.prefix;this.hoverable=this.hoverable.add(d);this.on(d,{mouseenter:function(b){$(b.currentTarget).addClass(c+\"state-hover\")},mouseleave:function(b){$(b.currentTarget).removeClass(c+\n\"state-hover\")}})};g.prototype.initFocus=function(d){var c=this.prefix;this.focusable=this.focusable.add(d);this.on(d,{focusin:function(b){$(b.currentTarget).addClass(c+\"state-focus\")},focusout:function(b){$(b.currentTarget).removeClass(c+\"state-focus\")}})};g.prototype.debug=function(d){this.debugMode&&\"undefined\"!==typeof console&&console.log&&(undefined)};g.uuid=0;g.prefix=\"bpui-\";return g}();$.each({show:\"fadeIn\",hide:\"fadeOut\"},function(g,d){h[g]=function(c,b,e){\"string\"===typeof b&&(b={effect:b});\nvar f=b?!0===b||\"number\"===typeof b?d:b.effect||d:g;b=b||{};\"number\"===typeof b&&(b={duration:b});var k=!$.isEmptyObject(b);b.complete=e;b.delay&&c.delay(b.delay);if(k&&\"function\"===typeof $.prototype.effect)$(c).effect(g,b);else if(f!==g&&c[f])c[f](b.duration,b.easing,e);else c.queue(function(b){$(this)[g]();e&&e.call(c[0]);b()})}});v.a=h},function(p,v,n){p=function(){function h(){}h.noop=function(){};h.assign=function(g){for(var d=[],c=1;c<arguments.length;c++)d[c-1]=arguments[c];if(null==g)throw new TypeError(\"Cannot convert undefined or null to object\");\nfor(var c=Object(g),b=0;b<d.length;b++){var e=d[b];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c};h.getCookie=function(g){if(null==g)return\"\";var d=document.cookie.split(\";\");g=decodeURIComponent(g);for(var c=0;c<d.length;c++){var b=d[c].trim().split(\"=\"),e=b[1];if(decodeURIComponent(b[0])===g)return decodeURIComponent(e)}return\"\"};h.setCookie=function(g,d,c){void 0===c&&(c=365);var b=new Date;g=encodeURIComponent(g);d=encodeURIComponent(d);b.setTime(b.getTime()+\n864E5*c);document.cookie=g+\"=\"+d+\"; expires=\"+b.toUTCString()+\"; path=/; domain=.bilibili.com\"};h.getSearchParam=function(g,d){if(\"string\"===typeof d){var c=d.indexOf(\"?\");var b=d.indexOf(\"#\");d=-1===c?\"\":-1===b?d.slice(c,d.length):d.slice(c,b)}else d=window.location.search;g=new RegExp(\"(^|&)\"+g+\"=([^&]*)(&|$)\",\"i\");g=d.substr(1).match(g);if(null!=g)try{return decodeURIComponent(g[2])}catch(e){}return null};h.getLocalSettings=function(g){return window.localStorage&&localStorage.getItem?localStorage.getItem(g):\nh.getCookie(g)};h.setLocalSettings=function(g,d){if(window.localStorage&&localStorage.setItem)try{return localStorage.setItem(g,d)}catch(c){(undefined)}else return h.setCookie(g,d)};h.getSessionSettings=function(g){return window.sessionStorage&&sessionStorage.getItem?sessionStorage.getItem(g):h.getCookie(g)};h.setSessionSettings=function(g,d){if(window.sessionStorage&&sessionStorage.setItem)try{return sessionStorage.setItem(g,d)}catch(c){(undefined)}else return h.setCookie(g,d)};h.getRandomString=\nfunction(g){for(var d=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\".split(\"\"),c=d.length,b=[],e=0;e<g;e++)b.push(d[Math.floor(Math.random()*c)]);return b.join(\"\")};h.formatFriendlyNumber=function(g,d){var c={\"\\u4e07\":1E4},b=c[d]?d:\"\\u4e07\",e=c[b],c=function(c){return isNaN(c)?\"--\":c>e?(c/e).toFixed(1)+b:c.toString()};if(\"number\"===typeof g)return c(g);if(\"string\"===typeof g){if(-1<g.indexOf(d))return g;if(-1<g.indexOf(\",\"))return c(parseInt(g.split(\",\").join(\"\"),10))}return\"--\"};\nh.fmSeconds=function(g){null==g&&(g=0);g=Math.floor(g)>>0;var d=(\"0\"+g%60).slice(-2);d=Math.floor(g/60)+\":\"+d;5>d.length&&(d=\"0\"+d);return d};h.fmSecondsReverse=function(g){if(null==g)return 0;g=g.toString().split(\":\").reverse();return g.length?(parseInt(g[0],10)||0)+60*(parseInt(g[1],10)||0)+3600*(parseInt(g[2],10)||0):0};h.fmTimestamp=function(g){var d=new Date(1E3*g);g=(\"0\"+d.getSeconds()).slice(-2);g=(\"0\"+d.getMinutes()+\":\"+g).slice(-5);g=(\"0\"+d.getHours()+\":\"+g).slice(-8);g=(\"0\"+d.getDate()+\n\" \"+g).slice(-11);return g=(\"0\"+(d.getMonth()+1)+\"-\"+g).slice(-14)};h.colorFromInt=function(g){return\"#\"+(\"00000\"+g.toString(16)).slice(-6)};h.timeParser=function(g){var d=/^(\\d+h)?(\\d+m|^s)?(\\d+s)?(\\d+ms)?$/.exec(g);return d&&d[0]?3600*(parseInt(d[1],10)||0)+60*(parseInt(d[2],10)||0)+(parseInt(d[3],10)||0)+(parseInt(d[4],10)||0)/1E3:0<=parseFloat(g)?parseFloat(g):!1};h.dateParser=function(g,d){if(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(g)){d=d||0;g=g.split(\"-\");var c=g[1],b=g[2];return.001*+new Date(parseInt(g[0],\n10),parseInt(c,10)-1,parseInt(b,10))-60*((new Date).getTimezoneOffset()+60*d)}return!1};h.thumbnail=function(g,d,c){if(\"string\"!==typeof g||\"undefined\"===typeof d)return g;c=c||d;var b=g.split(\"?\"),e=\"/\"+d+\"_\"+c;d=\"_\"+d+\"x\"+c;c=/^(?:https?:)?\\/\\/i\\d\\.hdslb\\.com\\/group1\\//i;var f=/(^(?:https?:)?\\/\\/i\\d\\.hdslb\\.com)(\\/.+)/i,k=/_\\d+x\\d+\\./,m=/\\/\\d+_\\d+\\//;if(!/^(?:https?:)?\\/\\/i[0-2]\\.hdslb\\.com\\//i.test(b[0])||k.test(b[0])||m.test(b[0]))return g;if(/^(?:https?:)?\\/\\/i\\d\\.hdslb\\.com\\/bfs\\//i.test(b[0])||\nc.test(b[0]))b[0]+=d+b[0].slice(b[0].lastIndexOf(\".\")),g=b.join(\"?\");else if(d=f.exec(b[0]))b[0]=d[1]+e+d[2],g=b.join(\"?\");return g};h.shuffle=function(g,d){var c=g.length;for(g=d?g.slice():g;c;){d=Math.floor(Math.random()*c);var b=g[--c];g[c]=g[d];g[d]=b}return g};h.htmlEncode=function(g){return g.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/'/g,\"&#x27;\").replace(/\\//g,\"&#x2f;\").replace(/\\n/g,\"<br>\")};h.relaceHttp=function(g){return g?g.replace(\"http://\",\n\"//\"):\"\"};h.browser={get version(){var g=navigator.userAgent.toLowerCase(),d=/(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.test(g)||/(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.test(g);return{linux:/Linux/i.test(g),webKit:/AppleWebKit/i.test(g),gecko:/Gecko/i.test(g)&&!/KHTML/i.test(g),trident:/Trident/i.test(g),presto:/Presto/i.test(g),mobile:/AppleWebKit.*Mobile.*/i.test(g),iOS:/Mac OS X[\\s_\\-\\/](\\d+[.\\-_]\\d+[.\\-_]?\\d*)/i.test(g),iPhone:/iPhone/i.test(g),\niPad:/iPad/i.test(g),webApp:!/Safari/i.test(g),android:/Android/i.test(g),windowsPhone:/Windows Phone/i.test(g),microMessenger:/MicroMessenger/i.test(g),msie:/msie [\\w.]+/i.test(g),edge:/edge/i.test(g),safari:d,safariSupportMSE:d&&/Version\\/1\\d/i.test(g)}},get language(){return(navigator.browserLanguage||navigator.language).toLowerCase()},get isMobile(){return h.browser.version.mobile||h.browser.version.iOS||h.browser.version.android||h.browser.version.windowsPhone}};return h}();v.a=p;Date.prototype.format=\nfunction(h){h=h||\"yyyy-MM-dd mm:ss\";var g={\"M+\":this.getMonth()+1,\"d+\":this.getDate(),\"h+\":this.getHours(),\"m+\":this.getMinutes(),\"s+\":this.getSeconds(),\"q+\":Math.floor((this.getMonth()+3)/3),\"S+\":this.getMilliseconds()};/(y+)/i.test(h)&&(h=h.replace(RegExp.$1,(this.getFullYear()+\"\").substr(4-RegExp.$1.length)));for(var d in g)(new RegExp(\"(\"+d+\")\")).test(h)&&(h=h.replace(RegExp.$1,1===RegExp.$1.length?g[d]:(\"00\"+g[d]).substr((\"\"+g[d]).length)));return h}},function(p,v,n){v.a={ADVANCECOMMENT:\"//interface.bilibili.com/advanceComment\",\nDMPOST:\"//interface.bilibili.com/dmpost\",DMREPORT:\"//api.bilibili.com/x/dm/report/add\",BLOCKLIST:\"//api.bilibili.com/x/dm/filter/user\",DMBLOCK:\"//api.bilibili.com/x/dm/filter/user/add\",DMUNBLOCK:\"//api.bilibili.com/x/dm/filter/user/del\",DMBLOCK_BATCH:\"//interface.bilibili.com/dmblock_batch\",DM_PROTECT_APPLY:\"//api.bilibili.com/x/dm/protect/apply\",DM_MY_LIST:\"//api.bilibili.com/x/dm/my/listxml.so\",DM_LIST:\"//api.bilibili.com/x/v1/dm/list.so\",REPORT:\"//interface.bilibili.com/report\",M:\"//interface.bilibili.com/m\",\nX_RELATION_MODIFY:\"//api.bilibili.com/x/relation/modify\",M_FRIENDMANAGE:\"//interface.bilibili.com/m/friend_manage.do\",S_PLAYER_RECOMMAND:\"//data.bilibili.com/s/miniloader_online\",EXTERNAL_PLAYER_JUMP:\"//www.bilibili.com/video/<bvid>?zw\",X_PLAYER_CAROUSEL:\"//api.bilibili.com/x/player/carousel.so\",PLAYER:\"//interface.bilibili.com/player\",CLOUD_FILTER:\"//comment.bilibili.com/cloud/filter\",CLOUD_FILTER_CATALOGY:\"//comment.bilibili.com/cloud/filter/catalogy.json\",CLOUD_FILTER_GLOBAL:\"//comment.bilibili.com/cloud/filter/global.json\",\nPVINFO:\"//comment.bilibili.com/pvinfo\",PLAYTAG:\"//comment.bilibili.com/playtag\",RECOMMEND:\"//api.bilibili.com/x/web-interface/archive/related\",VIDEOSHOTINDEX:\"https://api.bilibili.com/videoshot_index\",X_PLAYER_VIDEOSHOT:\"//api.bilibili.com/x/player/videoshot\",VIEW:\"//api.bilibili.com/view\",RECALL:\"//api.bilibili.com/x/dm/recall\",X_PLAYER_POLICY:\"//api.bilibili.com/x/player/policy?id=1\",X_WEBSHOW_RES_LOC:\"//api.bilibili.com/x/web-show/res/loc?pf=0&id=\",X_REPORT_CLICK_NOW:\"//api.bilibili.com/x/click-interface/click/now\",\nX_REPORT_CLICK_WEB_H5:\"//api.bilibili.com/x/click-interface/click/h5/outer\",X_REPORT_OUTER_CLICK_WEB_H5:\"//api.bilibili.com/x/click-interface/click/outer\",X_AD_VIDEO:\"//api.bilibili.com/x/ad/video\",X:\"//api.bilibili.com/x\",LOG_WEB:\"//data.bilibili.com/log/web\",X_REPORT_HEARTBEAT:\"//api.bilibili.com/x/click-interface/web/heartbeat\",PLUS_COMMENT:\"//www.bilibili.com/plus/comment.php\",X_PLAYER_PAGELIST:\"//api.bilibili.com/x/player/pagelist\",WIDGET_GETPAGELIST:\"//www.bilibili.com/widget/getPageList\",REGISTER:\"https://www.bilibili.com/register\",\nHTML_HELP:\"//www.bilibili.com/html/help.html\",SPONSOR_RANKWEB_RANKLIST:\"//bangumi.bilibili.com/sponsor/rankweb/rank_list\",WEBAPI_GETEPLIST:\"//bangumi.bilibili.com/web_api/get_ep_list\",V_FLASHPLAY:\"//data.bilibili.com/v/flashplay\",LOGIN:\"https://passport.bilibili.com/login\",CHAT_WS:\"ws://chat.bilibili.com:88\",CHAT_WSS:\"wss://chat.bilibili.com:8443\",BROADCAST_WS:\"ws://broadcast.chat.bilibili.com:4090\",BROADCAST_WSS:\"wss://broadcast.chat.bilibili.com:4095\",MIAOZHEN:\"http://miaozhen.com\",WEIBO:\"http://service.weibo.com/share/share.php\",\nQQWEIBO:\"http://connect.qq.com/share/share.php\",QZONE:\"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey\",BAIDU:\"http://tieba.baidu.com/f/commit/share/openShareApi\",QQ:\"http://connect.qq.com/widget/shareqq/index.html\",SPACE:\"//space.bilibili.com/\",MISAKA:\"//misaka-sw.mincdn.com/misaka.gif?\",SA_ADMIN_PANEL:\"//interface.bilibili.com/admin_panel\",SA_DANMAKU_MANAGEMENT:\"//interface.bilibili.com/dmm\",ASSIST_MOVE:\"//api.bilibili.com/x/dm/assist/move\",ASSIST_DELETE:\"//api.bilibili.com/x/dm/assist/del\",\nASSIST_IGNORE:\"//api.bilibili.com/x/dm/assist/ignore\",ASSIST_BANNED:\"//api.bilibili.com/x/dm/assist/banned\",ASSIST_PROTECT:\"//api.bilibili.com/x/dm/assist/protect\",TOVIEW_ADD:\"//api.bilibili.com/x/v2/history/toview/add\",TOVIEW_GET:\"//api.bilibili.com/x/v2/history/toview/web\",TOVIEW_DEL:\"//api.bilibili.com/x/v2/history/toview/del\",PLAYLIST_ADD:\"//api.bilibili.com/x/playlist/add\",PLAYLIST_DEL:\"//api.bilibili.com/x/playlist/del\",PLAYLIST_UPDATE:\"//api.bilibili.com/x/playlist/update\",PLAYLIST_VIDEO_ADD:\"//api.bilibili.com/x/playlist/video/add\",\nPLAYLIST_VIDEO_DEL:\"//api.bilibili.com/x/playlist/video/del\",PLAYLIST_FAVORITES_ADD:\"//api.bilibili.com/x/playlist/fav/add\",PLAYLIST_FAVORITES_DEL:\"//api.bilibili.com/x/playlist/fav/del\",PLAYLIST_REPORT:\"//api.bilibili.com/x/playlist/report\"}},function(p,v,n){p=function(){return function(h){this.data=h}}();v.a=p},function(p,v,n){p={assign:function(){for(var h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];if(1>=h.length)return h[0];var d=null!=h[0]?Object(h[0]):{};h.forEach(function(c,b){if(0!==\nb&&null!=c)for(var e in c)c.hasOwnProperty(e)&&(d[e]=c[e])});return d},getHexColor:function(h){return\"#\"+(\"000000\"+h.toString(16)).slice(-6)},browser:{version:function(){var h=navigator.userAgent;return{trident:/Trident/i.test(h),presto:/Presto/i.test(h),webKit:/AppleWebKit/i.test(h),gecko:/Gecko/i.test(h)&&!/KHTML/i.test(h),mobile:/AppleWebKit.*Mobile.*/i.test(h),ios:/Mac OS X[\\s\\_\\-\\/](\\d+[\\.\\-\\_]\\d+[\\.\\-\\_]?\\d*)/i.test(h),android:/Android/i.test(h),linux:/Linux/i.test(h),windowsphone:/Windows Phone/i.test(h),\niPhone:/iPhone/i.test(h),iPad:/iPad/i.test(h),MicroMessenger:/MicroMessenger/i.test(h),webApp:!/Safari/i.test(h),edge:/edge/i.test(h),safari:/(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.test(h.toLowerCase())||/(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.test(h.toLowerCase())}}(),language:navigator.language.toLowerCase()}};v.a=p},function(p,v,n){p.exports=function(h){h.webpackPolyfill||(h.deprecate=function(){},h.paths=[],h.children||(h.children=[]),Object.defineProperty(h,\n\"loaded\",{enumerable:!0,get:function(){return h.l}}),Object.defineProperty(h,\"id\",{enumerable:!0,get:function(){return h.i}}),h.webpackPolyfill=1);return h}},function(p,v,n){v.a={ADVANCECOMMENT:\"//interface.bilibili.com/advanceComment\",ADVANCECOMMENTBUY:\"//api.bilibili.com/x/dm/adv/buy\",DMPOST:\"//interface.bilibili.com/dmpost\",DMREPORT:\"//api.bilibili.com/x/dm/report/add\",BLOCKLIST:\"//api.bilibili.com/x/dm/filter/user\",DMBLOCK:\"//api.bilibili.com/x/dm/filter/user/add\",DMUNBLOCK:\"//api.bilibili.com/x/dm/filter/user/del\",\nDMBLOCK_BATCH:\"//interface.bilibili.com/dmblock_batch\",REPORT:\"//interface.bilibili.com/report\",M:\"//interface.bilibili.com/m\",X_RELATION_MODIFY:\"//api.bilibili.com/x/relation/modify\",M_FRIENDMANAGE:\"//interface.bilibili.com/m/friend_manage.do\",X_PLAYER_CAROUSEL:\"//api.bilibili.com/x/player/carousel.so\",PLAYER:\"//interface.bilibili.com/player\",CLOUD_FILTER:\"//comment.bilibili.com/cloud/filter\",CLOUD_FILTER_CATALOGY:\"//comment.bilibili.com/cloud/filter/catalogy.json\",CLOUD_FILTER_GLOBAL:\"//comment.bilibili.com/cloud/filter/global.json\",\nPVINFO:\"//comment.bilibili.com/pvinfo\",PLAYTAG:\"//comment.bilibili.com/playtag\",RECOMMEND:\"//api.bilibili.com/x/web-interface/archive/related\",VIDEOSHOTINDEX:\"https://api.bilibili.com/videoshot_index\",X_PLAYER_VIDEOSHOT:\"//api.bilibili.com/x/player/videoshot\",VIEW:\"//api.bilibili.com/x/web-interface/view\",RECALL:\"//api.bilibili.com/x/dm/recall\",X_PLAYER_POLICY:\"//api.bilibili.com/x/player/policy?id=1\",X_WEBSHOW_RES_LOC:\"//api.bilibili.com/x/web-show/res/loc?pf=0&id=\",X_REPORT_CLICK_NOW:\"//api.bilibili.com/x/click-interface/click/now\",\nX_REPORT_CLICK_WEB_H5:\"//api.bilibili.com/x/click-interface/click/h5/outer\",X_AD_VIDEO:\"//api.bilibili.com/x/ad/video\",X:\"//api.bilibili.com/x\",LOG_WEB:\"//data.bilibili.com/log/web\",X_REPORT_HEARTBEAT:\"//api.bilibili.com/x/click-interface/web/heartbeat\",PLUS_COMMENT:\"//www.bilibili.com/plus/comment.php\",X_PLAYER_PAGELIST:\"//api.bilibili.com/x/player/pagelist\",WIDGET_GETPAGELIST:\"//www.bilibili.com/widget/getPageList\",REGISTER:\"https://www.bilibili.com/register\",HTML_HELP:\"//www.bilibili.com/html/help.html\",\nDM_PROTECT_APPLY:\"//api.bilibili.com/x/dm/protect/apply\",DM_MY_LIST:\"//api.bilibili.com/x/dm/my/listxml.so\",DM_LIST:\"//api.bilibili.com/x/v1/dm/list.so\",SPONSOR_RANKWEB_RANKLIST:\"//bangumi.bilibili.com/sponsor/rankweb/rank_list\",WEBAPI_GETEPLIST:\"//bangumi.bilibili.com/web_api/get_ep_list\",V_FLASHPLAY:\"//data.bilibili.com/v/flashplay\",LOGIN:\"https://passport.bilibili.com/login\",CHAT_WS:\"ws://chat.bilibili.com:88\",CHAT_WSS:\"wss://chat.bilibili.com:8443\",BROADCAST_WS:\"ws://broadcast.chat.bilibili.com:4090\",\nBROADCAST_WSS:\"wss://broadcast.chat.bilibili.com:4095\",SPACE:\"//space.bilibili.com/\",MISAKA:\"//misaka-sw.mincdn.com/misaka.gif?\",SA_ADMIN_PANEL:\"//interface.bilibili.com/admin_panel\",SA_DANMAKU_MANAGEMENT:\"//interface.bilibili.com/dmm\",ASSIST_MOVE:\"//api.bilibili.com/x/dm/assist/move\",ASSIST_DELETE:\"//api.bilibili.com/x/dm/assist/del\",ASSIST_IGNORE:\"//api.bilibili.com/x/dm/assist/ignore\",ASSIST_BANNED:\"//api.bilibili.com/x/dm/assist/banned\",ASSIST_PROTECT:\"//api.bilibili.com/x/dm/assist/protect\",\nTOVIEW_ADD:\"//api.bilibili.com/x/v2/history/toview/add\",TOVIEW_GET:\"//api.bilibili.com/x/v2/history/toview/web\",TOVIEW_DEL:\"//api.bilibili.com/x/v2/history/toview/del\",PLAYLIST_ADD:\"//api.bilibili.com/x/playlist/add\",PLAYLIST_DEL:\"//api.bilibili.com/x/playlist/del\",PLAYLIST_UPDATE:\"//api.bilibili.com/x/playlist/update\",PLAYLIST_VIDEO_ADD:\"//api.bilibili.com/x/playlist/video/add\",PLAYLIST_VIDEO_DEL:\"//api.bilibili.com/x/playlist/video/del\",PLAYLIST_FAVORITES_ADD:\"//api.bilibili.com/x/playlist/fav/add\",\nPLAYLIST_FAVORITES_DEL:\"//api.bilibili.com/x/playlist/fav/del\",PLAYLIST_REPORT:\"//api.bilibili.com/x/playlist/report\"}},function(p,v,n){(function(h){var g,d,c,b=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&\"function\"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?\"symbol\":typeof b};!function(e,f){\"object\"==b(v)&&\"object\"==b(h)?h.exports=f():!(d=[],g=f,c=\"function\"===typeof g?g.apply(v,d):g,void 0!==c&&(h.exports=c))}(\"undefined\"!=\ntypeof self?self:void 0,function(){return function(b){function c(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return b[f].call(d.exports,d,d.exports,c),d.l=!0,d.exports}var e={};return c.m=b,c.c=e,c.d=function(b,e,f){c.o(b,e)||Object.defineProperty(b,e,{configurable:!1,enumerable:!0,get:f})},c.n=function(b){var e=b&&b.__esModule?function(){return b[\"default\"]}:function(){return b};return c.d(e,\"a\",e),e},c.o=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)},c.p=\"\",\nc(c.s=0)}([function(b,c,d){Object.defineProperty(c,\"__esModule\",{value:!0});b=d(1);c[\"default\"]=b.a},function(b,c,d){var e=d(2);b=function(){function b(c,d){if(!(this instanceof b))throw new TypeError(\"Cannot call a class as a function\");this.qrcode=e.a;this.el=c;this.options=d;this.init()}return b.prototype.init=function(){this.el&&this.qrcode(this.el,this.options)},b.prototype._setOptions=function(b){this.options=b},b.prototype.setOptions=function(b){this._setOptions(b)},b.prototype._setEl=function(b){this.el=\nb},b.prototype.setEl=function(b){this._setEl(b)},b}();c.a=b},function(c,d,k){var e=\"function\"==typeof Symbol&&\"symbol\"==b(Symbol.iterator)?function(c){return\"undefined\"===typeof c?\"undefined\":b(c)}:function(c){return c&&\"function\"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?\"symbol\":\"undefined\"===typeof c?\"undefined\":b(c)};d.a=function(b){function c(c,e,d,f){var k={},m=Object.assign({},b(d,e));m.addData(c);m.make();f=f||0;var t=m.getModuleCount(),u=m.getModuleCount()+2*f;return k.text=\nc,k.level=e,k.version=d,k.moduleCount=u,k.isDark=function(b,c){return b-=f,c-=f,!(0>b||b>=t||0>c||c>=t)&&m.isDark(b,c)},k.addBlank=function(b,c,e,d){var f=k.isDark,m=1/u;k.isDark=function(k,t){var u=t*m,g=k*m,C=u+m,A=g+m;return f(k,t)&&(b>C||u>e||c>A||g>d)}},k}function d(b,e,d,f,k){d=Math.max(1,d||1);for(f=Math.min(40,f||40);d<=f;d+=1)try{return c(b,e,d,k)}catch(M){}}function f(b,c,e,d,f,k,m,t){b.isDark(m,t)&&c.rect(d,f,k,k)}function k(b,c,e,d,f,k,m,t){var u=b.isDark;b=d+k;var g=f+k;e=e.radius*k;\nvar C=m-1,A=m+1,q=t-1,y=t+1,h=u(m,t),U=u(C,q);k=u(C,t);var D=u(C,y),C=u(m,y),y=u(A,y);t=u(A,t);A=u(A,q);m=u(m,q);h?(U=!k&&!m,k=!k&&!C,C=!t&&!C,m=!t&&!m,U?c.moveTo(d+e,f):c.moveTo(d,f),k?(c.lineTo(b-e,f),c.arcTo(b,f,b,g,e)):c.lineTo(b,f),C?(c.lineTo(b,g-e),c.arcTo(b,g,d,g,e)):c.lineTo(b,g),m?(c.lineTo(d+e,g),c.arcTo(d,g,d,f,e)):c.lineTo(d,g),U?(c.lineTo(d,f+e),c.arcTo(d,f,b,f,e)):c.lineTo(d,f)):(u=k&&C&&D,C=t&&C&&y,t=t&&m&&A,k&&m&&U&&(c.moveTo(d+e,f),c.lineTo(d,f),c.lineTo(d,f+e),c.arcTo(d,f,d+e,f,\ne)),u&&(c.moveTo(b-e,f),c.lineTo(b,f),c.lineTo(b,f+e),c.arcTo(b,f,b-e,f,e)),C&&(c.moveTo(b-e,g),c.lineTo(b,g),c.lineTo(b,g-e),c.arcTo(b,g,b-e,g,e)),t&&(c.moveTo(d+e,g),c.lineTo(d,g),c.lineTo(d,g-e),c.arcTo(d,g,d+e,g,e)))}function m(b,c){var e=d(c.text,c.ecLevel,c.minVersion,c.maxVersion,c.quiet);if(!e)return null;b.dataset.qrcode=e;var m=b.getContext(\"2d\");c.background&&c.background.tagName&&\"IMG\"===c.background.tagName?m.drawImage(c.background,0,0,c.size,c.size):c.background&&(m.fillStyle=c.background,\nm.fillRect(c.left,c.top,c.size,c.size));var t=c.mode;if(1===t||2===t){var t=c.size,u=\"bold \"+c.mSize*t+\"px \"+c.fontname,g=document.createElement(\"canvas\").getContext(\"2d\");g.font=u;var C=g.measureText(c.label).width,g=c.mSize,A=C/t,C=(1-A)*c.mPosX,q=(1-g)*c.mPosY,A=C+A,g=q+g;1===c.mod?e.addBlank(0,q-.01,t,g+.01):e.addBlank(C-.01,q-.01,A+.01,g+.01);m.fillStyle=c.fontcolor;m.font=u;m.fillText(c.label,C*t,q*t+.75*c.mSize*t)}else if(3===t||4===t){var t=c.size,u=c.mSize,g=u*(c.image.naturalWidth||1)/(c.image.naturalHeight||\n1),C=(1-g)*c.mPosX,q=(1-u)*c.mPosY,A=C+g,y=q+u;3===c.mode?e.addBlank(0,q-.01,t,y+.01):e.addBlank(C-.01,q-.01,A+.01,y+.01);m.drawImage(c.image,C*t,q*t,g*t,u*t)}t=e.moduleCount;u=c.size/t;g=f;0<c.radius&&.5>=c.radius&&(g=k);m.beginPath();for(C=0;C<t;C+=1)for(q=0;q<t;q+=1)g(e,m,c,c.left+q*u,c.top+C*u,u,C,q);c.fill.tagName&&\"IMG\"===c.fill.tagName?(m.strokeStyle=\"rgba(0,0,0,0.5)\",m.lineWidth=2,m.stroke(),e=m.globalCompositeOperation,m.globalCompositeOperation=\"destination-out\",m.fill(),m.globalCompositeOperation=\ne,m.clip(),m.drawImage(c.fill,0,0,c.size,c.size),m.restore()):(m.fillStyle=c.fill,m.fill());return b}function g(b){var c=document.createElement(\"canvas\");return c.setAttribute(\"width\",b.size),c.setAttribute(\"height\",b.size),m(c,b)}function A(b){var c=d(b.text,b.ecLevel,b.minVersion,b.maxVersion,b.quiet);if(!c)return null;var e=b.size,f=b.background,m=Math.floor,k=c.moduleCount,t=m(e/k),u=m(.5*(e-t*k)),g=document.createElement(\"div\"),C=void 0,A=void 0,q={position:\"relative\",left:0,top:0,padding:0,\nmargin:0,width:e,height:e},y={position:\"absolute\",padding:0,margin:0,width:t,height:t,\"background-color\":b.fill};Object.keys(q).every(function(b){return g.style[b]=q[b],g.style[b]});g.dataset.qrcode=c;f&&(g.style[\"background-color\"]=f);for(C=0;C<k;C+=1)for(A=0;A<k;A+=1)c.isDark(C,A)&&function(){var b=Object.assign({},y,{left:u+A*t,top:u+C*t}),c=document.createElement(\"div\");Object.keys(b).every(function(e){return c.style[e]=b[e],g.style[e]});g.appendChild(c)}();return g}function h(b){return P&&\"canvas\"===\nb.render?g(b):P&&\"image\"===b.render?document.createElement(\"img\").setAttribute(\"src\",g(b).toDataURL(\"image/png\")):A(b)}var P=function(){var b=document.createElement(\"canvas\");return!(!b.getContext||!b.getContext(\"2d\"))}(),n={render:\"canvas\",minVersion:1,maxVersion:40,ecLevel:\"L\",left:0,top:0,size:200,fill:\"#000\",background:null,text:\"no text\",radius:0,quiet:0,mode:0,mSize:.1,mPosX:.5,mPosY:.5,label:\"no label\",fontname:\"sans\",fontcolor:\"#000\",image:null};return function(b,c){c=Object.assign({},n,\"object\"===\n(void 0===c?\"undefined\":e(c))?c:{text:c});if(\"length\"in b)for(var d=0;d<b.length;d++)\"canvas\"===b[d].nodeName.toLowerCase()?m(b[d],c):b[d].appendChild(h(c));else\"canvas\"===b.nodeName.toLowerCase()?m(b,c):b.appendChild(h(c))}}(function(){var b=function(){function b(c,e){if(void 0===c.length)throw Error(c.length+\"/\"+e);var d=function(){for(var b=0;b<c.length&&0===c[b];)b+=1;for(var f=Array(c.length-b+e),d=0;d<c.length-b;d+=1)f[d]=c[d+b];return f}(),f={};return f.getAt=function(b){return d[b]},f.getLength=\nfunction(){return d.length},f.multiply=function(c){for(var e=Array(f.getLength()+c.getLength()-1),d=0;d<f.getLength();d+=1)for(var m=0;m<c.getLength();m+=1)e[d+m]^=k.gexp(k.glog(f.getAt(d))+k.glog(c.getAt(m)));return b(e,0)},f.mod=function(c){if(0>f.getLength()-c.getLength())return f;for(var e=k.glog(f.getAt(0))-k.glog(c.getAt(0)),d=Array(f.getLength()),m=0;m<f.getLength();m+=1)d[m]=f.getAt(m);for(m=0;m<c.getLength();m+=1)d[m]^=k.gexp(k.glog(c.getAt(m))+e);return b(d,0).mod(c)},{getAt:f.getAt,getLength:f.getLength,\nmultiply:f.multiply,mod:f.mod}}var c=function(c,e){var f=d[e],k=null,t=0,u=null,C=[],q={},y=function(e,d){for(var q=t=4*c+17,y=Array(q),h=0;h<q;h+=1){y[h]=Array(q);for(var D=0;D<q;D+=1)y[h][D]=null}k=y;U(0,0);U(t-7,0);U(0,t-7);q=m.getPatternPosition(c);for(y=0;y<q.length;y+=1)for(h=0;h<q.length;h+=1){var D=q[y],H=q[h];if(null==k[D][H])for(var w=-2;2>=w;w+=1)for(var z=-2;2>=z;z+=1)k[D+w][H+z]=-2===w||2===w||-2===z||2===z||0===w&&0===z}for(q=8;q<t-8;q+=1)null==k[q][6]&&(k[q][6]=0==q%2);for(q=8;q<t-\n8;q+=1)null==k[6][q]&&(k[6][q]=0==q%2);q=m.getBCHTypeInfo(f<<3|d);for(y=0;15>y;y+=1)h=!e&&1==(q>>y&1),6>y?k[y][8]=h:8>y?k[y+1][8]=h:k[t-15+y][8]=h;for(y=0;15>y;y+=1)h=!e&&1==(q>>y&1),8>y?k[8][t-y-1]=h:9>y?k[8][15-y-1+1]=h:k[8][15-y-1]=h;k[t-8][8]=!e;if(7<=c){q=m.getBCHTypeNumber(c);for(y=0;18>y;y+=1)k[Math.floor(y/3)][y%3+t-8-3]=!e&&1==(q>>y&1);for(y=0;18>y;y+=1)k[y%3+t-8-3][Math.floor(y/3)]=!e&&1==(q>>y&1)}if(null==u){e=g.getRSBlocks(c,f);H=A();for(q=0;q<C.length;q+=1)y=C[q],H.put(y.getMode(),4),\nH.put(y.getLength(),m.getLengthInBits(y.getMode(),c)),y.write(H);for(y=q=0;y<e.length;y+=1)q+=e[y].dataCount;if(H.getLengthInBits()>8*q)throw Error(\"code length overflow. (\"+H.getLengthInBits()+\">\"+8*q+\")\");for(H.getLengthInBits()+4<=8*q&&H.put(0,4);0!=H.getLengthInBits()%8;)H.putBit(!1);for(;!(H.getLengthInBits()>=8*q||(H.put(236,8),H.getLengthInBits()>=8*q));)H.put(17,8);q=h=w=0;D=Array(e.length);y=Array(e.length);for(z=0;z<e.length;z+=1){var n=e[z].dataCount,N=e[z].totalCount-n,h=Math.max(h,n),\nq=Math.max(q,N);D[z]=Array(n);for(var P=0;P<D[z].length;P+=1)D[z][P]=255&H.getBuffer()[P+w];w+=n;N=m.getErrorCorrectPolynomial(N);n=b(D[z],N.getLength()-1).mod(N);y[z]=Array(N.getLength()-1);for(N=0;N<y[z].length;N+=1)P=N+n.getLength()-y[z].length,y[z][N]=0<=P?n.getAt(P):0}for(w=H=0;w<e.length;w+=1)H+=e[w].totalCount;H=Array(H);for(z=w=0;z<h;z+=1)for(n=0;n<e.length;n+=1)z<D[n].length&&(H[w]=D[n][z],w+=1);for(h=0;h<q;h+=1)for(D=0;D<e.length;D+=1)h<y[D].length&&(H[w]=y[D][h],w+=1);u=H}e=u;q=-1;y=t-\n1;h=7;D=0;d=m.getMaskFunction(d);for(H=t-1;0<H;H-=2)for(6===H&&--H;;){for(w=0;2>w;w+=1)null==k[y][H-w]&&(z=!1,D<e.length&&(z=1==(e[D]>>>h&1)),d(y,H-w)&&(z=!z),k[y][H-w]=z,--h,-1===h&&(D+=1,h=7));if(0>(y+=q)||t<=y){y-=q;q=-q;break}}},U=function(b,c){for(var e=-1;7>=e;e+=1)if(!(-1>=b+e||t<=b+e))for(var d=-1;7>=d;d+=1)-1>=c+d||t<=c+d||(k[b+e][c+d]=0<=e&&6>=e&&(0===d||6===d)||0<=d&&6>=d&&(0===e||6===e)||2<=e&&4>=e&&2<=d&&4>=d)};return q.addData=function(b){b=h(b);C.push(b);u=null},q.isDark=function(b,\nc){if(0>b||t<=b||0>c||t<=c)throw Error(b+\",\"+c);return k[b][c]},q.getModuleCount=function(){return t},q.make=function(){for(var b=0,c=0,e=0;8>e;e+=1){y(!0,e);var d=m.getLostPoint(q);(0===e||b>d)&&(b=d,c=e)}y(!1,c)},q.createTableTag=function(b,c){b=b||2;c='<table style=\" border-width: 0px; border-style: none; border-collapse: collapse;'+(\" padding: 0px; margin: \"+(void 0===c?4*b:c)+\"px;\");c+='\"><tbody>';for(var e=0;e<q.getModuleCount();e+=1){c+=\"<tr>\";for(var d=0;d<q.getModuleCount();d+=1)c+='<td style=\"',\nc+=\" border-width: 0px; border-style: none;\",c+=\" border-collapse: collapse;\",c+=\" padding: 0px; margin: 0px;\",c+=\" width: \"+b+\"px;\",c+=\" height: \"+b+\"px;\",c+=\" background-color: \",c+=q.isDark(e,d)?\"#000000\":\"#ffffff\",c+=\";\",c+='\"/>';c+=\"</tr>\"}return c+=\"</tbody>\",c+\"</table>\"},q.createImgTag=function(b,c){b=b||2;c=void 0===c?4*b:c;var e=q.getModuleCount()*b+2*c,d=c,f=e-c;return z(e,e,function(c,e){return d<=c&&c<f&&d<=e&&e<f?q.isDark(Math.floor((e-d)/b),Math.floor((c-d)/b))?0:1:1})},{addData:q.addData,\nisDark:q.isDark,getModuleCount:q.getModuleCount,make:q.make,createTableTag:q.createTableTag,createImgTag:q.createImgTag}};c.stringToBytes=f