:function(e,t){o(e,t,r)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,n);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},n[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,n)},updateClassFactory:function(e,t){o(e,t,n)}}}();t.a=n},function(e,t,r){\n\nvar n={parseBuffer:function(e){return new i(e).parse()},addBoxProcessor:function(e,t){\"string\"==typeof e&&\"function\"==typeof t&&(a.prototype._boxProcessors[e]=t)},createFile:function(){return new i},createBox:function(e,t,r){var n=a.create(e);return t&&t.append(n,r),n},createFullBox:function(e,t,r){var i=n.createBox(e,t,r);return i.version=0,i.flags=0,i},Utils:{}};n.Utils.dataViewToString=function(e,t){var r=t||\"utf-8\";if(\"undefined\"!=typeof TextDecoder)return new TextDecoder(r).decode(e);var n=[],i=0;if(\"utf-8\"===r)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),n.push(String.fromCharCode(a))}else for(;i<e.byteLength;)n.push(String.fromCharCode(e.getUint8(i++)));return n.join(\"\")},n.Utils.utf8ToByteArray=function(e){var t,r;if(\"undefined\"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?(t.push(192|n>>6),t.push(128|63&n)):n<65536?(t.push(224|n>>12),t.push(128|63&n>>6),t.push(128|63&n)):(t.push(240|n>>18),t.push(128|63&n>>12),t.push(128|63&n>>6),t.push(128|63&n))}return t},n.Utils.appendBox=function(e,t,r){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==r)if(null!=r){var n,i=-1;if(\"number\"==typeof r)i=r;else{if(\"string\"==typeof r)n=r;else{if(\"object\"!=typeof r||!r.type)return void e.boxes.push(t);n=r.type}for(var a=0;a<e.boxes.length;a++)if(n===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=n.parseBuffer,t.addBoxProcessor=n.addBoxProcessor,t.createFile=n.createFile,t.createBox=n.createBox,t.createFullBox=n.createFullBox,t.Utils=n.Utils,n.Cursor=function(e){this.offset=void 0===e?0:e};var i=function(e){this._cursor=new n.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var r=[];return i._sweep.call(this,e,r,t),r},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=a.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,r){for(var n in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&r)return;i._sweep.call(this.boxes[n],e,t,r)}},i.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var r=new Uint8Array(t);for(this._rawo=new DataView(r.buffer),this.bytes=r,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return r.buffer},i.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)};var a=function(){this._cursor=new n.Cursor};a.parse=function(e){var t=new a;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},a.create=function(e){var t=new a;return t.type=e,t.boxes=[],t},a.prototype._boxContainers=[\"dinf\",\"edts\",\"mdia\",\"meco\",\"mfra\",\"minf\",\"moof\",\"moov\",\"mvex\",\"stbl\",\"strk\",\"traf\",\"trak\",\"tref\",\"udta\",\"vttc\",\"sinf\",\"schi\",\"encv\",\"enca\"],a.prototype._boxProcessors={},a.prototype._procField=function(e,t,r){this._parsing?this[e]=this._readField(t,r):this._writeField(t,r,this[e])},a.prototype._procFieldArray=function(e,t,r,n){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(r,n);else for(i=0;i<this[e].length;i++)this._writeField(r,n,this[e][i])},a.prototype._procFullBox=function(){this._procField(\"version\",\"uint\",8),this._procField(\"flags\",\"uint\",24)},a.prototype._procEntries=function(e,t,r){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push({}),r.call(this,this[e][n]);else for(n=0;n<t;n++)r.call(this,this[e][n])},a.prototype._procSubEntries=function(e,t,r,n){var i;if(this._parsing)for(e[t]=[],i=0;i<r;i++)e[t].push({}),n.call(this,e[t][i]);else for(i=0;i<r;i++)n.call(this,e[t][i])},\na.prototype._procEntryField=function(e,t,r,n){this._parsing?e[t]=this._readField(r,n):this._writeField(r,n,e[t])},a.prototype._procSubBoxes=function(e,t){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push(a.parse(this));else for(r=0;r<t;r++)this._rawo?this[e][r].write():this.size+=this[e][r].getLength()},a.prototype._readField=function(e,t){switch(e){case\"uint\":return this._readUint(t);case\"int\":return this._readInt(t);case\"template\":return this._readTemplate(t);case\"string\":return-1===t?this._readTerminatedString():this._readString(t);case\"data\":return this._readData(t);case\"utf8\":return this._readUTF8String();default:return-1}},a.prototype._readInt=function(e){var t=null,r=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(r);break;case 16:t=this._raw.getInt16(r);break;case 32:t=this._raw.getInt32(r);break;case 64:var n=this._raw.getInt32(r),i=this._raw.getInt32(r+4);t=n*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},a.prototype._readUint=function(e){var t,r,n=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:n=this._raw.getUint8(i);break;case 16:n=this._raw.getUint16(i);break;case 24:n=((t=this._raw.getUint16(i))<<8)+(r=this._raw.getUint8(i+2));break;case 32:n=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),r=this._raw.getUint32(i+4),n=t*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,n},a.prototype._readString=function(e){for(var t=\"\",r=0;r<e;r++){var n=this._readUint(8);t+=String.fromCharCode(n)}return t},a.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},a.prototype._readTerminatedString=function(){for(var e=\"\";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},a.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var r=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,r}return null},a.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?n.Utils.dataViewToString(t):t},a.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField(\"size\",\"uint\",32),this._procField(\"type\",\"string\",4),1===this.size&&this._procField(\"largesize\",\"uint\",64),\"uuid\"===this.type&&this._procFieldArray(\"usertype\",16,\"uint\",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},a.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},a.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(a.parse(this))},a.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)},a.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField(\"size\",\"uint\",32),this._procField(\"type\",\"string\",4),1===this.size&&this._procField(\"largesize\",\"uint\",64),\"uuid\"===this.type&&this._procFieldArray(\"usertype\",16,\"uint\",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),\nthis.size},a.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField(\"size\",\"uint\",32),this._procField(\"type\",\"string\",4),1===this.size&&this._procField(\"largesize\",\"uint\",64),\"uuid\"===this.type&&this._procFieldArray(\"usertype\",16,\"uint\",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},a.prototype._writeInt=function(e,t){if(this._rawo){var r=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(r,t);break;case 16:this._rawo.setInt16(r,t);break;case 32:this._rawo.setInt32(r,t);break;case 64:var n=Math.floor(t/Math.pow(2,32)),i=t-n*Math.pow(2,32);this._rawo.setUint32(r,n),this._rawo.setUint32(r+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeUint=function(e,t){if(this._rawo){var r,n,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:r=(16776960&t)>>8,n=255&t,this._rawo.setUint16(i,r),this._rawo.setUint8(i+2,n);break;case 32:this._rawo.setUint32(i,t);break;case 64:n=t-(r=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,r),this._rawo.setUint32(i+4,n)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeString=function(e,t){for(var r=0;r<e;r++)this._writeUint(8,t.charCodeAt(r))},a.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},a.prototype._writeTemplate=function(e,t){var r=Math.floor(t),n=(t-r)*Math.pow(2,e/2);this._writeUint(e/2,r),this._writeUint(e/2,n)},a.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,r=0;r<e.length;r++)this._rawo.setInt8(t+r,e[r]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},a.prototype._writeUTF8String=function(e){var t=n.Utils.utf8ToByteArray(e);if(this._rawo)for(var r=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)r.setUint8(i,t[i]);else this.size+=t.length},a.prototype._writeField=function(e,t,r){switch(e){case\"uint\":this._writeUint(t,r);break;case\"int\":this._writeInt(t,r);break;case\"template\":this._writeTemplate(t,r);break;case\"string\":-1==t?this._writeTerminatedString(r):this._writeString(t,r);break;case\"data\":this._writeData(r);break;case\"utf8\":this._writeUTF8String(r)}},a.prototype._boxProcessors.avc1=a.prototype._boxProcessors.avc2=a.prototype._boxProcessors.avc3=a.prototype._boxProcessors.avc4=a.prototype._boxProcessors.hvc1=a.prototype._boxProcessors.hev1=a.prototype._boxProcessors.encv=function(){this._procFieldArray(\"reserved1\",6,\"uint\",8),this._procField(\"data_reference_index\",\"uint\",16),this._procField(\"pre_defined1\",\"uint\",16),this._procField(\"reserved2\",\"uint\",16),this._procFieldArray(\"pre_defined2\",3,\"uint\",32),this._procField(\"width\",\"uint\",16),this._procField(\"height\",\"uint\",16),this._procField(\"horizresolution\",\"template\",32),this._procField(\"vertresolution\",\"template\",32),this._procField(\"reserved3\",\"uint\",32),this._procField(\"frame_count\",\"uint\",16),this._procFieldArray(\"compressorname\",32,\"uint\",8),this._procField(\"depth\",\"uint\",16),this._procField(\"pre_defined3\",\"int\",16),this._procField(\"config\",\"data\",-1)},a.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField(\"entry_count\",\"uint\",32),this._procSubBoxes(\"entries\",this.entry_count)},\na.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField(\"entry_count\",\"uint\",32),this._procEntries(\"entries\",this.entry_count,(function(e){this._procEntryField(e,\"segment_duration\",\"uint\",1===this.version?64:32),this._procEntryField(e,\"media_time\",\"int\",1===this.version?64:32),this._procEntryField(e,\"media_rate_integer\",\"int\",16),this._procEntryField(e,\"media_rate_fraction\",\"int\",16)}))},a.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField(\"timescale\",\"uint\",32),this._procField(\"presentation_time\",\"uint\",64),this._procField(\"event_duration\",\"uint\",32),this._procField(\"id\",\"uint\",32),this._procField(\"scheme_id_uri\",\"string\",-1),this._procField(\"value\",\"string\",-1)):(this._procField(\"scheme_id_uri\",\"string\",-1),this._procField(\"value\",\"string\",-1),this._procField(\"timescale\",\"uint\",32),this._procField(\"presentation_time_delta\",\"uint\",32),this._procField(\"event_duration\",\"uint\",32),this._procField(\"id\",\"uint\",32)),this._procField(\"message_data\",\"data\",-1)},a.prototype._boxProcessors.free=a.prototype._boxProcessors.skip=function(){this._procField(\"data\",\"data\",-1)},a.prototype._boxProcessors.frma=function(){this._procField(\"data_format\",\"uint\",32)},a.prototype._boxProcessors.ftyp=a.prototype._boxProcessors.styp=function(){this._procField(\"major_brand\",\"string\",4),this._procField(\"minor_version\",\"uint\",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray(\"compatible_brands\",e,\"string\",4)},a.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField(\"pre_defined\",\"uint\",32),this._procField(\"handler_type\",\"string\",4),this._procFieldArray(\"reserved\",3,\"uint\",32),this._procField(\"name\",\"string\",-1)},a.prototype._boxProcessors.mdat=function(){this._procField(\"data\",\"data\",-1)},a.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField(\"creation_time\",\"uint\",1==this.version?64:32),this._procField(\"modification_time\",\"uint\",1==this.version?64:32),this._procField(\"timescale\",\"uint\",32),this._procField(\"duration\",\"uint\",1==this.version?64:32),this._parsing||\"string\"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField(\"language\",\"uint\",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField(\"pre_defined\",\"uint\",16)},a.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField(\"fragment_duration\",\"uint\",1==this.version?64:32)},a.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField(\"sequence_number\",\"uint\",32)},a.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField(\"mfra_size\",\"uint\",32)},a.prototype._boxProcessors.mp4a=a.prototype._boxProcessors.enca=function(){this._procFieldArray(\"reserved1\",6,\"uint\",8),this._procField(\"data_reference_index\",\"uint\",16),this._procFieldArray(\"reserved2\",2,\"uint\",32),this._procField(\"channelcount\",\"uint\",16),this._procField(\"samplesize\",\"uint\",16),this._procField(\"pre_defined\",\"uint\",16),this._procField(\"reserved3\",\"uint\",16),this._procField(\"samplerate\",\"template\",32),this._procField(\"esds\",\"data\",-1)},a.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField(\"creation_time\",\"uint\",1==this.version?64:32),this._procField(\"modification_time\",\"uint\",1==this.version?64:32),this._procField(\"timescale\",\"uint\",32),this._procField(\"duration\",\"uint\",1==this.version?64:32),this._procField(\"rate\",\"template\",32),this._procField(\"volume\",\"template\",16),this._procField(\"reserved1\",\"uint\",16),this._procFieldArray(\"reserved2\",2,\"uint\",32),this._procFieldArray(\"matrix\",9,\"template\",32),this._procFieldArray(\"pre_defined\",6,\"uint\",32),this._procField(\"next_track_ID\",\"uint\",32)},a.prototype._boxProcessors.payl=function(){this._procField(\"cue_text\",\"utf8\")},a.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray(\"SystemID\",16,\"uint\",8),\nthis._procField(\"DataSize\",\"uint\",32),this._procFieldArray(\"Data\",this.DataSize,\"uint\",8)},a.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField(\"scheme_type\",\"uint\",32),this._procField(\"scheme_version\",\"uint\",32),1&this.flags&&this._procField(\"scheme_uri\",\"string\",-1)},a.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray(\"sample_dependency_table\",e,\"uint\",8)},a.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField(\"reference_ID\",\"uint\",32),this._procField(\"timescale\",\"uint\",32),this._procField(\"earliest_presentation_time\",\"uint\",1==this.version?64:32),this._procField(\"first_offset\",\"uint\",1==this.version?64:32),this._procField(\"reserved\",\"uint\",16),this._procField(\"reference_count\",\"uint\",16),this._procEntries(\"references\",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,\"reference\",\"uint\",32),this._procEntryField(e,\"subsegment_duration\",\"uint\",32),this._procEntryField(e,\"sap\",\"uint\",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},a.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField(\"balance\",\"uint\",16),this._procField(\"reserved\",\"uint\",16)},a.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField(\"subsegment_count\",\"uint\",32),this._procEntries(\"subsegments\",this.subsegment_count,(function(e){this._procEntryField(e,\"ranges_count\",\"uint\",32),this._procSubEntries(e,\"ranges\",e.ranges_count,(function(e){this._procEntryField(e,\"level\",\"uint\",8),this._procEntryField(e,\"range_size\",\"uint\",24)}))}))},a.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField(\"entry_count\",\"uint\",32),this._procSubBoxes(\"entries\",this.entry_count)},a.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField(\"entry_count\",\"uint\",32),this._procEntries(\"entries\",this.entry_count,(function(e){this._procEntryField(e,\"sample_delta\",\"uint\",32),this._procEntryField(e,\"subsample_count\",\"uint\",16),this._procSubEntries(e,\"subsamples\",e.subsample_count,(function(e){this._procEntryField(e,\"subsample_size\",\"uint\",1===this.version?32:16),this._procEntryField(e,\"subsample_priority\",\"uint\",8),this._procEntryField(e,\"discardable\",\"uint\",8),this._procEntryField(e,\"codec_specific_parameters\",\"uint\",32)}))}))},a.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField(\"default_IsEncrypted\",\"uint\",24),this._procField(\"default_IV_size\",\"uint\",8),this._procFieldArray(\"default_KID\",16,\"uint\",8)},a.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField(\"baseMediaDecodeTime\",\"uint\",1==this.version?64:32)},a.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField(\"track_ID\",\"uint\",32),1&this.flags&&this._procField(\"base_data_offset\",\"uint\",64),2&this.flags&&this._procField(\"sample_description_offset\",\"uint\",32),8&this.flags&&this._procField(\"default_sample_duration\",\"uint\",32),16&this.flags&&this._procField(\"default_sample_size\",\"uint\",32),32&this.flags&&this._procField(\"default_sample_flags\",\"uint\",32)},a.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField(\"track_ID\",\"uint\",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField(\"reserved\",\"uint\",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField(\"number_of_entry\",\"uint\",32),this._procEntries(\"entries\",this.number_of_entry,(function(e){\nthis._procEntryField(e,\"time\",\"uint\",1===this.version?64:32),this._procEntryField(e,\"moof_offset\",\"uint\",1===this.version?64:32),this._procEntryField(e,\"traf_number\",\"uint\",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,\"trun_number\",\"uint\",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,\"sample_number\",\"uint\",8*(this.length_size_of_sample_num+1))}))},a.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField(\"creation_time\",\"uint\",1==this.version?64:32),this._procField(\"modification_time\",\"uint\",1==this.version?64:32),this._procField(\"track_ID\",\"uint\",32),this._procField(\"reserved1\",\"uint\",32),this._procField(\"duration\",\"uint\",1==this.version?64:32),this._procFieldArray(\"reserved2\",2,\"uint\",32),this._procField(\"layer\",\"uint\",16),this._procField(\"alternate_group\",\"uint\",16),this._procField(\"volume\",\"template\",16),this._procField(\"reserved3\",\"uint\",16),this._procFieldArray(\"matrix\",9,\"template\",32),this._procField(\"width\",\"template\",32),this._procField(\"height\",\"template\",32)},a.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField(\"track_ID\",\"uint\",32),this._procField(\"default_sample_description_index\",\"uint\",32),this._procField(\"default_sample_duration\",\"uint\",32),this._procField(\"default_sample_size\",\"uint\",32),this._procField(\"default_sample_flags\",\"uint\",32)},a.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField(\"sample_count\",\"uint\",32),1&this.flags&&this._procField(\"data_offset\",\"int\",32),4&this.flags&&this._procField(\"first_sample_flags\",\"uint\",32),this._procEntries(\"samples\",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,\"sample_duration\",\"uint\",32),512&this.flags&&this._procEntryField(e,\"sample_size\",\"uint\",32),1024&this.flags&&this._procEntryField(e,\"sample_flags\",\"uint\",32),2048&this.flags&&this._procEntryField(e,\"sample_composition_time_offset\",1===this.version?\"int\":\"uint\",32)}))},a.prototype._boxProcessors[\"url \"]=a.prototype._boxProcessors[\"urn \"]=function(){this._procFullBox(),\"urn \"===this.type&&this._procField(\"name\",\"string\",-1),this._procField(\"location\",\"string\",-1)},a.prototype._boxProcessors.vlab=function(){this._procField(\"source_label\",\"utf8\")},a.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField(\"graphicsmode\",\"uint\",16),this._procFieldArray(\"opcolor\",3,\"uint\",16)},a.prototype._boxProcessors.vttC=function(){this._procField(\"config\",\"utf8\")},a.prototype._boxProcessors.vtte=function(){}},function(e,t,r){\"use strict\";r.d(t,\"a\",(function(){return n}));function n(){return\"2.7.0\"}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(){}return e.getLocalStorage=function(e){var t=\"\";try{t=window.localStorage.getItem(e)}catch(e){}return t},e.setLocalStorage=function(e,t){try{window.localStorage.setItem(e,t)}catch(e){}},e.getSessionStorage=function(e){var t=\"\";try{t=window.sessionStorage.getItem(e)}catch(e){}return t},e.setSessionStorage=function(e,t){try{window.sessionStorage.setItem(e,t)}catch(e){}},e}();t.default=n},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.STRING=t.ERROR=t.EVENTS=void 0;t.EVENTS={SCRIPT_LOADED:\"scripLoaded\",VIDEO_INFO:\"videoInfo\",WARNING:\"warning\",AST_IN_FUTURE:\"astInFuture\",BUFFER_EMPTY:\"bufferStalled\",BUFFER_LOADED:\"bufferLoaded\",BUFFER_LEVEL_STATE_CHANGED:\"bufferStateChanged\",ERROR:\"error\",FRAGMENT_LOADING_COMPLETED:\"fragmentLoadingCompleted\",FRAGMENT_LOADING_HEADER_RECEIVED:\"fragmentLoadingHeaderReceived\",FRAGMENT_LOADING_PROGRESS:\"fragmentLoadingProgress\",FRAGMENT_LOADING_STARTED:\"fragmentLoadingStarted\",FRAGMENT_LOADING_ABANDONED:\"fragmentLoadingAbandoned\",FRAGMENT_LOADED_ERROR:\"fragmentLoadedError\",FRAGMENT_P2P_LOAD_INFO:\"fragmentP2pLoadInfo\",PCDN_LOADED_ERROR:\"pcdnLoadedError\",LOG:\"log\",MANIFEST_LOADED:\"manifestLoaded\",METRICS_CHANGED:\"metricsChanged\",METRIC_CHANGED:\"metricChanged\",METRIC_ADDED:\"metricAdded\",METRIC_UPDATED:\"metricUpdated\",PERIOD_SWITCH_COMPLETED:\"periodSwitchCompleted\",PERIOD_SWITCH_STARTED:\"periodSwitchStarted\",\nQUALITY_CHANGE_REQUESTED:\"qualityChangeRequested\",QUALITY_CHANGE_RENDERED:\"qualityChangeRendered\",TRACK_CHANGE_RENDERED:\"trackChangeRendered\",SOURCE_INITIALIZED:\"sourceInitialized\",STREAM_INITIALIZED:\"streamInitialized\",STREAM_TEARDOWN_COMPLETE:\"streamTeardownComplete\",TEXT_TRACKS_ADDED:\"allTextTracksAdded\",TEXT_TRACK_ADDED:\"textTrackAdded\",TTML_PARSED:\"ttmlParsed\",TTML_TO_PARSE:\"ttmlToParse\",CAN_PLAY:\"canPlay\",PLAYBACK_ENDED:\"playbackEnded\",PLAYBACK_ERROR:\"playbackError\",PLAYBACK_NOT_ALLOWED:\"playbackNotAllowed\",PLAYBACK_METADATA_LOADED:\"playbackMetaDataLoaded\",PLAYBACK_PAUSED:\"playbackPaused\",PLAYBACK_PLAYING:\"playbackPlaying\",PLAYBACK_PROGRESS:\"playbackProgress\",PLAYBACK_RATE_CHANGED:\"playbackRateChanged\",PLAYBACK_SEEKED:\"playbackSeeked\",PLAYBACK_SEEKING:\"playbackSeeking\",PLAYBACK_SEEK_ASKED:\"playbackSeekAsked\",PLAYBACK_STARTED:\"playbackStarted\",PLAYBACK_TIME_UPDATED:\"playbackTimeUpdated\",PLAYBACK_WAITING:\"playbackWaiting\",MANIFEST_VALIDITY_CHANGED:\"manifestValidityChanged\",KEY_ADDED:\"public_keyAdded\",KEY_ERROR:\"public_keyError\",KEY_MESSAGE:\"public_keyMessage\",KEY_SESSION_CLOSED:\"public_keySessionClosed\",KEY_SESSION_CREATED:\"public_keySessionCreated\",KEY_SESSION_REMOVED:\"public_keySessionRemoved\",KEY_STATUSES_CHANGED:\"public_keyStatusesChanged\",KEY_SYSTEM_ACCESS_COMPLETE:\"public_keySystemAccessComplete\",KEY_SYSTEM_SELECTED:\"public_keySystemSelected\",LICENSE_REQUEST_COMPLETE:\"public_licenseRequestComplete\",PROTECTION_CREATED:\"public_protectioncreated\",PROTECTION_DESTROYED:\"public_protectiondestroyed\",DELAY_TO_APPEND_TO_BUFFER:\"delayToAppendBuffer\",QUALITY_CHANGE_DOWNLOADED:\"qualityChangeDownloaded\",QUOTA_EXCEEDED:\"quotaExceeded\",GET_NEXT_FRAGMENT:\"getNextFragment\",APPENDING_NEXT_SOURCE:\"appendingNextSource\",APPENDED_NEXT_SOURCE:\"appendedNextSource\",APPENDED_NEXT_SOURCE_DURATION_CHANGED:\"appendedNextSourceDurationChanged\",START_OFFSET_TIME_WARNING:\"startOffsetTimeWarning\",BUFFERING_OPTIMIZATION:\"buffering_optimization\"};t.ERROR={INTERNAL_ERROR:-1,DURATION_IS_NOT_ALL_EQUAL:-2,DURATION_DEVIATION_IS_TOO_LARGE:-3,START_OFFSET_TIME_WARNING:-4,DOWNLOAD_ERROR:4,DOWNLOAD_MPD_ERROR:4001,DOWNLOAD_XINK_ERROR:4002,DOWNLOAD_INIT_SEGMENT_ERROR:4003,DOWNLOAD_MEDIA_SEGMENT_ERROR:4004,DOWNLOAD_INDEX_SEGMENT_ERROR:4005,DOWNLOAD_SWITCHING_SEGMENT_ERROR:4006,DOWNLOAD_OTHER_ERROR:4007,DOWNLOAD_FRAGMENT_ERROR:4101,DOWNLOAD_FRAGMENT_ERROR_RETRY_SUCCESS:4102,DOWNLOAD_FRAGMENT_ERROR_RETRY_FAILURE:4103,DOWNLOAD_FRAGMENT_ERROR_TIMEOUT:4105,CONNECT_FRAGMENT_ERROR_TIMEOUT:4106,MANIFEST_ERROR:5,MANIFEST_TYPE_ERROR:5001,MANIFEST_RESOLVE_ERROR:5002,MEDIA_ERROR:6,MEDIA_ABORTED_ERROR:6001,MEDIA_NETWORK_ERROR:6002,MEDIA_DECODE_ERROR:6003,MEDIA_SUPPORTED_ERROR:6004,MEDIA_ENCRYPTED_ERROR:6005,MEDIA_UNKNOWN_ERROR:6e3};t.STRING={VIDEO:\"video\",AUDIO:\"audio\",LOG:\"log\",WARNING:\"warning\",ERROR:\"error\",ABR_DYNAMIC:\"abrDynamic\",ABR_BOLA:\"abrBola\",ABR_THROUGHPUT:\"abrThroughput\",SWITCH_SOURCE_TRANSITION_ELEMENT_CLASS_NAME:\"bilidp-switch-source-transition-canvas\"}},function(e,t,r){\"use strict\";var n=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.init()}return e.prototype.init=function(){this.STREAM=\"stream\",this.VIDEO=\"video\",this.AUDIO=\"audio\",this.TEXT=\"text\",this.FRAGMENTED_TEXT=\"fragmentedText\",this.EMBEDDED_TEXT=\"embeddedText\",this.MUXED=\"muxed\",this.IMAGE=\"image\",this.LOCATION=\"Location\",this.INITIALIZE=\"initialize\",this.TEXT_SHOWING=\"showing\",this.TEXT_HIDDEN=\"hidden\",this.CC1=\"CC1\",this.CC3=\"CC3\",this.STPP=\"stpp\",this.TTML=\"ttml\",this.VTT=\"vtt\",this.WVTT=\"wvtt\",this.UTF8=\"utf-8\",this.SUGGESTED_PRESENTATION_DELAY=\"suggestedPresentationDelay\",this.SCHEME_ID_URI=\"schemeIdUri\",this.START_TIME=\"starttime\",this.ABR_STRATEGY_DYNAMIC=\"abrDynamic\",this.ABR_STRATEGY_BOLA=\"abrBola\",this.ABR_STRATEGY_THROUGHPUT=\"abrThroughput\",this.MOVING_AVERAGE_SLIDING_WINDOW=\"slidingWindow\",this.MOVING_AVERAGE_EWMA=\"ewma\"},e}());var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.init()}\nreturn e.prototype.init=function(){this.TCP_CONNECTION=\"TcpList\",this.HTTP_REQUEST=\"HttpList\",this.TRACK_SWITCH=\"RepSwitchList\",this.BUFFER_LEVEL=\"BufferLevel\",this.BUFFER_STATE=\"BufferState\",this.DVR_INFO=\"DVRInfo\",this.DROPPED_FRAMES=\"DroppedFrames\",this.SCHEDULING_INFO=\"SchedulingInfo\",this.REQUESTS_QUEUE=\"RequestsQueue\",this.MANIFEST_UPDATE=\"ManifestUpdate\",this.MANIFEST_UPDATE_STREAM_INFO=\"ManifestUpdatePeriodInfo\",this.MANIFEST_UPDATE_TRACK_INFO=\"ManifestUpdateRepresentationInfo\",this.PLAY_LIST=\"PlayList\",this.DVB_ERRORS=\"DVBErrors\"},e}());var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.init()}return e.prototype.init=function(){this.DOWNLOAD_ERROR=4,this.DOWNLOAD_MPD_ERROR=4001,this.DOWNLOAD_XINK_ERROR=4002,this.DOWNLOAD_INIT_SEGMENT_ERROR=4003,this.DOWNLOAD_MEDIA_SEGMENT_ERROR=4004,this.DOWNLOAD_INDEX_SEGMENT_ERROR=4005,this.DOWNLOAD_SWITCHING_SEGMENT_ERROR=4006,this.DOWNLOAD_OTHER_ERROR=4007,this.DOWNLOAD_FRAGMENT_ERROR=4101,this.DOWNLOAD_FRAGMENT_ERROR_RETRY_SUCCESS=4102,this.DOWNLOAD_FRAGMENT_ERROR_RETRY_FAILURE=4103,this.DOWNLOAD_FRAGMENT_ERROR_RANGE=4104,this.DOWNLOAD_FRAGMENT_ERROR_TIMEOUT=4105,this.CONNECT_FRAGMENT_ERROR_TIMEOUT=4106,this.DOWNLOAD_PCDN_SCRIPT_ERROR=4201,this.DOWNLOAD_PCDN_SCRIPT_TIMEOUT=4202,this.DOWNLOAD_PCDN_DISABLED=4203,this.MANIFEST_ERROR=5,this.MANIFEST_TYPE_ERROR=5001,this.MANIFEST_RESOLVE_ERROR=5002,this.MEDIA_ERROR=6,this.MEDIA_ABORTED_ERROR=6001,this.MEDIA_NETWORK_ERROR=6002,this.MEDIA_DECODE_ERROR=6003,this.MEDIA_SUPPORTED_ERROR=6004,this.MEDIA_ENCRYPTED_ERROR=6005,this.MEDIA_UNKNOWN_ERROR=6e3},e}());var o=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.schemeIdUri=\"\",this.value=\"\"},s=r(0);function u(){var e={};function t(t,r,n){var i=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===r&&(!n||n===e.scope))return i=t,!0})),i):i}return{on:function(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!r)throw new Error(\"event type cannot be null or undefined\");if(!n||\"function\"!=typeof n)throw new Error(\"listener must be a function: \"+n);if(!(t(r,n,i)>=0)){e[r]=e[r]||[];var o={callback:n,scope:i,priority:a},s=e[r].some((function(t,n){if(t&&a>t.priority)return e[r].splice(n,0,o),!0}));s||e[r].push(o)}},off:function(r,n,i){if(r&&n&&e[r]){var a=t(r,n,i);a<0||(e[r][a]=null)}},trigger:function(t,r){if(t&&e[t]){if((r=r||{}).hasOwnProperty(\"type\"))throw new Error(\"'type' is a reserved word for event dispatching\");r.type=t,e[t]=e[t].filter((function(e){return e})),e[t].forEach((function(e){return e&&e.callback.call(e.scope,r)}))}},reset:function(){e={}}}}u.__dashjs_factory_name=\"EventBus\";var l=s.a.getSingletonFactory(u);l.EVENT_PRIORITY_LOW=0,l.EVENT_PRIORITY_HIGH=5e3,s.a.updateSingletonFactory(u.__dashjs_factory_name,l);var d=l;var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e)}return e.prototype.extend=function(e,t){if(e){var r=!!t&&t.override,n=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||n&&-1===e[i].indexOf(\"public_\")||(this[i]=e[i])}},e}();function f(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function h(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var p=new(function(e){function t(){return f(this,t),h(this,e.apply(this,arguments))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var r=function(e,t){\nif(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,e.call(this));return r.BUFFERING_COMPLETED=\"bufferingCompleted\",r.BUFFER_CLEARED=\"bufferCleared\",r.BUFFER_LEVEL_UPDATED=\"bufferLevelUpdated\",r.BYTES_APPENDED=\"bytesAppended\",r.BYTES_APPENDED_END_FRAGMENT=\"bytesAppendedEndFragment\",r.CHECK_FOR_EXISTENCE_COMPLETED=\"checkForExistenceCompleted\",r.CURRENT_TRACK_CHANGED=\"currentTrackChanged\",r.DATA_UPDATE_COMPLETED=\"dataUpdateCompleted\",r.DATA_UPDATE_STARTED=\"dataUpdateStarted\",r.INITIALIZATION_LOADED=\"initializationLoaded\",r.INIT_FRAGMENT_LOADED=\"initFragmentLoaded\",r.INIT_REQUESTED=\"initRequested\",r.INTERNAL_MANIFEST_LOADED=\"internalManifestLoaded\",r.LIVE_EDGE_SEARCH_COMPLETED=\"liveEdgeSearchCompleted\",r.LOADING_COMPLETED=\"loadingCompleted\",r.LOADING_PROGRESS=\"loadingProgress\",r.LOADING_DATA_PROGRESS=\"loadingDataProgress\",r.LOADING_ABANDONED=\"loadingAborted\",r.MANIFEST_UPDATED=\"manifestUpdated\",r.MEDIA_FRAGMENT_LOADED=\"mediaFragmentLoaded\",r.QUOTA_EXCEEDED=\"quotaExceeded\",r.REPRESENTATION_UPDATED=\"representationUpdated\",r.SEGMENTS_LOADED=\"segmentsLoaded\",r.SERVICE_LOCATION_BLACKLIST_ADD=\"serviceLocationBlacklistAdd\",r.SERVICE_LOCATION_BLACKLIST_CHANGED=\"serviceLocationBlacklistChanged\",r.SOURCEBUFFER_REMOVE_COMPLETED=\"sourceBufferRemoveCompleted\",r.STREAMS_COMPOSED=\"streamsComposed\",r.STREAM_BUFFERING_COMPLETED=\"streamBufferingCompleted\",r.STREAM_COMPLETED=\"streamCompleted\",r.TEXT_TRACKS_QUEUE_INITIALIZED=\"textTracksQueueInitialized\",r.TIMED_TEXT_REQUESTED=\"timedTextRequested\",r.TIME_SYNCHRONIZATION_COMPLETED=\"timeSynchronizationComplete\",r.URL_RESOLUTION_FAILED=\"urlResolutionFailed\",r.VIDEO_CHUNK_RECEIVED=\"videoChunkReceived\",r.WALLCLOCK_TIME_UPDATED=\"wallclockTimeUpdated\",r.XLINK_ELEMENT_LOADED=\"xlinkElementLoaded\",r.XLINK_READY=\"xlinkReady\",r.REQUEST_RETRYED=\"requestRetryed\",r.BUFFER_CREATED=\"bufferCreated\",r}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(c)));var g=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType=\"arraybuffer\",this.representationId=null,this.timeout=1e4};g.ACTION_DOWNLOAD=\"download\",g.ACTION_COMPLETE=\"complete\";var m=g;function E(){var e,t=this.context,r=d(t).getInstance(),n=void 0,i=void 0,a=void 0,o=void 0;return e={log:function(){var e=\"\",t=null;i&&(t=(new Date).getTime(),e+=\"[\"+(t-o)+\"]\"),a&&this&&this.getClassName&&(e+=\"[\"+this.getClassName()+\"]\",this.getType&&(e+=\"[\"+this.getType()+\"]\")),e.length>0&&(e+=\" \"),Array.apply(null,arguments).forEach((function(t){e+=t+\" \"})),n&&(undefined),r.trigger(p.LOG,{message:e})},setLogTimestampVisible:function(e){i=e},setCalleeNameVisible:function(e){a=e},setLogToBrowserConsole:function(e){n=e},getLogToBrowserConsole:function(){return n}},n=!1,i=!0,a=!1,o=(new Date).getTime(),e}E.__dashjs_factory_name=\"Debug\";var _=s.a.getSingletonFactory(E),T=\"loading\",y=\"executed\",v=\"failed\";function A(e){e=e||{};var t=this.context,r=_(t).getInstance().log,n=d(t).getInstance(),i=e.metricsModel,a=e.fragmentLoader,o=void 0,s=void 0,u=void 0,l=void 0;function c(e){var t;return!!e&&(t=!1,u.some((function(r){if(n=e,i=r,!isNaN(n.index)&&n.startTime===i.startTime&&n.adaptationIndex===i.adaptationIndex&&n.type===i.type||function(e,t){\nreturn isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,r)||function(e,t){return e.action===m.ACTION_COMPLETE&&e.action===t.action}(e,r))return t=!0;var n,i})),t)}function f(e){return isNaN(e.duration)?.25:e.duration/8}function h(e){u=u.filter((function(t){var r=f(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-r}))}function g(e,t){t<=e+.5||(u=u.filter((function(r){var n=f(r);return isNaN(r.startTime)||r.startTime>=t-n||isNaN(r.duration)||r.startTime+r.duration<=e+n})))}function E(e,t,r){for(var n=e.length-1;n>=0;n--){var i=e[n],a=i.startTime,o=a+i.duration;if(r=isNaN(r)?f(i):r,!isNaN(a)&&!isNaN(o)&&t+r>=a&&t-r<o||isNaN(a)&&isNaN(t))return i}return null}function A(e,t){i.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),i.addRequestsQueue(e.mediaType,l,u)}function R(e){if(e.sender===a&&!e.error){if(l.splice(l.indexOf(e.request),1),e.response&&!e.error){var t=u&&u[u.length-1],i=s.getPlaybackController().getTime()||0,o=e.request,d=t&&(isNaN(t.index)||isNaN(t.startTime)&&isNaN(t.duration)),c=o&&(isNaN(o.index)||isNaN(o.startTime)&&isNaN(o.duration)),f=t&&(0===i||o.startTime-1<=i&&o.startTime+o.duration+1>=i),h=t&&o.index-t.index==1||u&&u.length&&u.filter((function(e){return o.index-e.index==1})).length||0===o.index;if(r(\"push\",o.mediaType,JSON.stringify({index:o.index,isLastNaNRequest:d,isCurrentNaNRequest:c,isCurrentTimeInFirstRequest:f,currentTime:i})),!c&&f&&u.length>1&&!h&&u.splice(1,u.length-1),t&&!c&&!f&&!h)return void s.getScheduleController().start();u.push(e.request)}A(e.request,e.error?v:y),n.trigger(p.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}),e.request&&e.request.p2pLoadInfo&&\"{}\"!=JSON.stringify(e.request.p2pLoadInfo)&&n.trigger(p.FRAGMENT_P2P_LOAD_INFO,{p2pLoadInfo:e.request.p2pLoadInfo})}}function I(e){e.sender===a&&n.trigger(p.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this})}function S(e){e.sender===a&&n.trigger(p.FRAGMENT_LOADING_ABANDONED,{streamProcessor:this.getStreamProcessor(),request:e.request,mediaType:e.mediaType})}function N(){null,u=[],l=[]}return o={setStreamProcessor:function(e){s=e},getStreamProcessor:function(){return s},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],r=[];return t.forEach((function(t){var n=function(e){var t=void 0;switch(e){case T:t=l;break;case y:t=u;break;default:t=[]}return t}(t);r=r.concat(function(e,t){if(t.hasOwnProperty(\"time\"))return[E(e,t.time,t.threshold)];return e.filter((function(e){for(var r in t)if(\"state\"!==r&&t.hasOwnProperty(r)&&e[r]!=t[r])return!1;return!0}))}(n,e))})),r},isFragmentLoaded:c,isFragmentLoadedOrPending:function(e){var t=!1,r=0,n=void 0;if(!(t=c(e)))for(r=0;r<l.length;r++)n=l[r],e.url===n.url&&e.startTime===n.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:h,removeExecutedRequestsAfterTime:function(e){u=u.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<=e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var r=0,n=0,i=e.length;n<i;n++)g(r,e.start(n)),r=e.end(n);t>0&&g(r,t)}else h()},clearExecutedRequestBySeeking:function(){u=[]},abortRequests:function(){a.abort(),l=[]},executeRequest:function(e){switch(e.action){case m.ACTION_COMPLETE:u.push(e),A(e,y),r(\"[FragmentModel] executeRequest trigger STREAM_COMPLETED\"),n.trigger(p.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case m.ACTION_DOWNLOAD:A(e,T),l.push(e),function(e){n.trigger(p.FRAGMENT_LOADING_STARTED,{sender:o,request:e}),a.load(e)}(e);break;default:r(\"Unknown request action.\")}},reset:function(){n.off(p.LOADING_COMPLETED,R,this),n.off(p.LOADING_DATA_PROGRESS,I,this),n.off(p.LOADING_ABANDONED,S,this),a&&a.reset(),N()},addExecutedRequest:function(){},resetInitialSettings:N,resetPreloadData:function(){a&&a.resetPreloadData()}},N(),n.on(p.LOADING_COMPLETED,R,o),n.on(p.LOADING_DATA_PROGRESS,I,o),n.on(p.LOADING_ABANDONED,S,o),o}A.__dashjs_factory_name=\"FragmentModel\";var R=s.a.getClassFactory(A)\n;R.FRAGMENT_MODEL_LOADING=T,R.FRAGMENT_MODEL_EXECUTED=y,R.FRAGMENT_MODEL_CANCELED=\"canceled\",R.FRAGMENT_MODEL_FAILED=v,s.a.updateClassFactory(A.__dashjs_factory_name,R);var I=R;var S=function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.code=t||null,this.message=r||null,this.data=n||null,this.errorCode=i||null,this.httpCode=a||null};function N(e,t,r){var n=this.context,i=_(n).getInstance().log,a=d(n).getInstance(),o=void 0,s=void 0,u=[],l=r;function c(){return o?o.buffered:[]}function f(){var e=this;if(u.length>0){s=!0;var t=u[0];u.splice(0,1);var r=[],n=function(){var n=c();!function(e,t,r,n){t&&t.length>0&&t.length<r.length&&function(e,t){for(var r=0;r<e.length;r++){var n=Math.round(e.start(r)),i=Math.round(e.end(r));if(i===t.start||n===t.end||t.start>=n&&t.end<=i)return!0}return!1}(t,n)&&a.trigger(p.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:r.end(r.length-2),to:r.start(r.length-1),unintended:!0})}(e,r,n,t),u.length>0?f.call(this):(s=!1,l&&l({chunk:t}))};try{0===t.bytes.length?n.call(this):(r=c(),o.appendBuffer?o.appendBuffer(t.bytes):o.append(t.bytes,t),h(o,n.bind(this)))}catch(e){i('SourceBuffer append failed \"'+e+'\"'),u.length>0?f():s=!1,l&&l({chunk:t,error:new S(e.code,e.message,null)})}}}function h(e,t){var r=void 0,n=function(){e.updating||(clearInterval(r),t())};if(e.updating)if(\"function\"==typeof e.addEventListener)try{e.addEventListener(\"updateend\",(function r(){e.updating||(e.removeEventListener(\"updateend\",r,!1),t())}),!1)}catch(e){r=setInterval(n,50)}else r=setInterval(n,50);else t()}var g={getAllBufferRanges:c,getBuffer:function(){return o},append:function(e){u.push(e),s||h(o,f.bind(this))},remove:function(t,r,n){var i=this;h(o,(function(){try{t>=0&&r>t&&(n||\"ended\"!==e.readyState)&&o.remove(t,r),h(o,(function(){a.trigger(p.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:i,from:t,to:r,unintended:!1})}))}catch(e){a.trigger(p.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:i,from:t,to:r,unintended:!1,error:new S(e.code,e.message,null)})}}))},abort:function(){try{(\"open\"===e.readyState||o.setTextTrack&&\"ended\"===e.readyState)&&o.abort()}catch(e){i('SourceBuffer append abort failed: \"'+e+'\"')}u=[]},reset:function(){if(o){try{e.removeSourceBuffer(o)}catch(e){i(\"Failed to remove source buffer from media source.\")}s=!1,o=null}u=[],l=null},setAppendWindowEnd:function t(r){r<=0||h(o,(function(){if(\"open\"===e.readyState)o.appendWindowEnd=r;else var n=setTimeout((function(){clearTimeout(n),t(r)}),50)}))},updateTimestampOffset:function(e){o.timestampOffset===e||isNaN(e)||h(o,(function(){o.timestampOffset=e}))}};return function(){s=!1;var r=t.codec;try{if(r.match(/application\\/mp4;\\s*codecs=\"(stpp|wvtt).*\"/i))throw new Error(\"not really supported\");o=e.addSourceBuffer(r)}catch(e){throw e}}(),g}N.__dashjs_factory_name=\"SourceBufferSink\";var D=s.a.getClassFactory(N);function O(e){var t=this.context,r=_(t).getInstance().log,n=[],i=void 0,a=e;function o(e,t){n=n.filter((function(r){return!((isNaN(t)||r.start<t)&&(isNaN(e)||r.end>e))}))}return{getAllBufferRanges:function(){for(var e=[],t=0;t<n.length;t++){var r=n[t];0===e.length||r.start>e[e.length-1].end?e.push({start:r.start,end:r.end}):e[e.length-1].end=r.end}var i={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(i,\"length\",{get:function(){return e.length}}),i},append:function(e){\"InitializationSegment\"!==e.segmentType?(n.push(e),n.sort((function(e,t){return e.start-t.start})),i=null):i=e,r(\"PreBufferSink appended chunk s: \"+e.start+\"; e: \"+e.end),a&&a({chunk:e})},remove:o,abort:function(){},discharge:function(e,t){var r=function(e,t){return n.filter((function(r){return(isNaN(t)||r.start<t)&&(isNaN(e)||r.end>e)}))}(e,t);return i&&(r.push(i),i=null),o(e,t),r},reset:function(){n=[],i=null,a=null}}}O.__dashjs_factory_name=\"PreBufferSink\";var C=s.a.getClassFactory(O),M={DEFAULT:.5,STRONG:1,WEAK:0};function P(e,t,r){return{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:function(e){var t=M.DEFAULT;return e!==M.DEFAULT&&e!==M.STRONG&&e!==M.WEAK||(t=e),t}(r)}}\nP.__dashjs_factory_name=\"SwitchRequest\";var b=s.a.getClassFactory(P);b.NO_CHANGE=-1,b.PRIORITY=M,s.a.updateClassFactory(P.__dashjs_factory_name,b);var w=b;function L(e){e=e||{};var t=this.context,r=_(t).getInstance().log,n=e.metricsModel;return{getMaxIndex:function(e){var i=w(t).create();if(!(e&&e.hasOwnProperty(\"getMediaInfo\")&&e.hasOwnProperty(\"getMediaType\")&&e.hasOwnProperty(\"useBufferOccupancyABR\")&&e.hasOwnProperty(\"getAbrController\")&&e.hasOwnProperty(\"getStreamProcessor\")))return i;!function(){if(!n||!n.hasOwnProperty(\"getReadOnlyMetricsFor\"))throw new Error(\"Missing config parameter(s)\")}();var a=e.getMediaInfo(),o=e.getMediaType(),s=n.getReadOnlyMetricsFor(o),u=e.getStreamProcessor(),l=e.getAbrController(),d=e.getStreamInfo(),c=d&&d.manifestInfo?d.manifestInfo.isDynamic:null,f=l.getThroughputHistory(),h=f.getSafeAverageThroughput(o,c),p=f.getAverageLatency(o),g=s.BufferState.length>0?s.BufferState[s.BufferState.length-1]:null,m=e.useBufferOccupancyABR();return!s||isNaN(h)||!g||m||l.getAbandonmentStateFor(o)!==ue.ABANDON_LOAD&&(g||c)&&(i.quality=l.getQualityForBitrate(a,h,p),u.getScheduleController().setTimeToLoadDelay(0),r(\"ThroughputRule requesting switch to index: \",i.quality,\"type: \",o,\"Average throughput\",Math.round(h),\"kbps\"),i.reason={throughput:h,latency:p}),i},reset:function(){}}}L.__dashjs_factory_name=\"ThroughputRule\";var F=s.a.getClassFactory(L);function x(e){e=e||{};var t=this.context,r=_(t).getInstance().log,n=e.mediaPlayerModel,i=e.metricsModel,a=e.dashMetrics,o=void 0,s=void 0,u=void 0;function l(){o={},s={},u=[]}var d={shouldAbandon:function(e){var l=w(t).create(w.NO_CHANGE,{name:x.__dashjs_factory_name});if(!(e&&e.hasOwnProperty(\"getMediaInfo\")&&e.hasOwnProperty(\"getMediaType\")&&e.hasOwnProperty(\"getCurrentRequest\")&&e.hasOwnProperty(\"getRepresentationInfo\")&&e.hasOwnProperty(\"getAbrController\")))return l;var d,c,f=e.getMediaInfo(),h=e.getMediaType(),p=e.getCurrentRequest();if(!isNaN(p.index)){d=h,c=p.index,o[d]=o[d]||{},o[d][c]=o[d][c]||{};var g=n.getStableBufferTime();if(a.getCurrentBufferLevel(i.getReadOnlyMetricsFor(h))>g)return l;var m=o[h][p.index];if(null===m||null===p.firstByteDate||s.hasOwnProperty(m.id))return l;if(void 0===m.firstByteTime&&(u[h]=[],m.firstByteTime=p.firstByteDate.getTime(),m.segmentDuration=p.duration,m.bytesTotal=p.bytesTotal,m.id=p.index),m.bytesLoaded=p.bytesLoaded,m.elapsedTime=(new Date).getTime()-m.firstByteTime,m.bytesLoaded>0&&m.elapsedTime>0&&function(e,t){u[e]=u[e]||[],u[e].push(t)}(h,Math.round(8*m.bytesLoaded/m.elapsedTime)),u[h].length>=5&&m.elapsedTime>500&&m.bytesLoaded<m.bytesTotal){var E=u[h].reduce((function(e,t){return e+t}),0);if(m.measuredBandwidthInKbps=Math.round(E/u[h].length),m.estimatedTimeOfDownload=+(8*m.bytesTotal/m.measuredBandwidthInKbps/1e3).toFixed(2),m.estimatedTimeOfDownload<1.8*m.segmentDuration||0===e.getRepresentationInfo().quality)return l;if(!s.hasOwnProperty(m.id)){var _=e.getAbrController(),T=m.bytesTotal-m.bytesLoaded,y=_.getBitrateList(f),v=_.getQualityForBitrate(f,m.measuredBandwidthInKbps*n.getBandwidthSafetyFactor());T>m.bytesTotal*y[v].bitrate/y[_.getQualityFor(h,f.streamInfo)].bitrate&&(l.quality=v,l.reason.throughput=m.measuredBandwidthInKbps,l.reason.fragmentID=m.id,s[m.id]=m,r(\"AbandonRequestsRule ( \",h,\"frag id\",m.id,\") is asking to abandon and switch to quality to \",v,\" measured bandwidth was\",m.measuredBandwidthInKbps),delete o[h][m.id])}}else m.bytesLoaded===m.bytesTotal&&delete o[h][m.id]}return l},reset:l};return l(),d}x.__dashjs_factory_name=\"AbandonRequestsRule\";var U=s.a.getClassFactory(x);function B(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var G=function e(){B(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},k=function e(){B(this,e),this.s=null,this.d=null,this.b=[]};G.GET=\"GET\",G.HEAD=\"HEAD\",G.MPD_TYPE=\"MPD\",\nG.XLINK_EXPANSION_TYPE=\"XLinkExpansion\",G.INIT_SEGMENT_TYPE=\"InitializationSegment\",G.INDEX_SEGMENT_TYPE=\"IndexSegment\",G.MEDIA_SEGMENT_TYPE=\"MediaSegment\",G.BITSTREAM_SWITCHING_SEGMENT_TYPE=\"BitstreamSwitchingSegment\",G.OTHER_TYPE=\"other\";var H=10;function V(e){e=e||{};var t=this.context,r=_(t).getInstance().log,n=e.dashMetrics,a=e.metricsModel,o=e.mediaPlayerModel,s=d(t).getInstance(),u=void 0,l=void 0;function c(e,t,r){var n=r.reduce((function(e,t,n){return t>r[e]?n:e}),0);if(0===n)return null;var i=Math.max(e,H+2*t.length),a=(r[n]-1)/(i/H-1);return{gp:a,Vp:H/a}}function f(e){var t={},r=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),n=function(e){return e.map((function(e){return Math.log(e)}))}(r);n=n.map((function(e){return e-n[0]+1}));var i=o.getStableBufferTime(),a=c(i,r,n);return a?(t.state=1,t.bitrates=r,t.utilities=n,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,h(t)):t.state=0,t}function h(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function g(e,t){var r=o.getStableBufferTime();if(e.stableBufferTime!==r){var i=c(r,e.bitrates,e.utilities);if(i.Vp!==e.Vp||i.gp!==e.gp){var s=n.getCurrentBufferLevel(a.getReadOnlyMetricsFor(t)),u=s+e.placeholderBuffer;u-=H,u*=i.Vp/e.Vp,u+=H,e.stableBufferTime=r,e.Vp=i.Vp,e.gp=i.gp,e.placeholderBuffer=Math.max(0,u-s)}}}function m(e,t){return e.Vp*(e.utilities[t]+e.gp)}function E(e,t){for(var r=e.bitrates[t],n=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(r*s-o*n)/(r-o));i=Math.max(i,u)}return i}function T(){for(var e in l)l.hasOwnProperty(e)&&2===l[e].state&&(l[e].placeholderBuffer=0)}function y(){for(var e in l)if(l.hasOwnProperty(e)){var t=l[e];0!==t.state&&(t.state=1,h(t))}}function v(){}function A(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=l[e.chunk.mediaInfo.type];if(t&&0!==t.state){var r=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,I(t,e.chunk.mediaInfo.type)}}}function R(e){if(e&&e.metric===i.HTTP_REQUEST&&e.value&&e.value.type===G.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=l[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),I(t,e.mediaType))}}function I(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var r=n.getCurrentBufferLevel(a.getReadOnlyMetricsFor(t))+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),i=m(e,e.lastQuality),o=Math.max(0,i-r);e.placeholderBuffer=Math.min(o,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function S(e){if(e){var t=l[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function N(e){if(e){var t=l[e.mediaType];if(t&&0!==t.state){var r=n.getCurrentBufferLevel(a.getReadOnlyMetricsFor(e.mediaType)),i=void 0;i=t.abrQuality>0?E(t,t.abrQuality):H;var o=Math.max(0,i-r);t.placeholderBuffer=Math.min(t.placeholderBuffer,o)}}}function D(){l={}}return u={getMaxIndex:function(e){var i=e.getMediaInfo(),o=e.getMediaType(),s=a.getReadOnlyMetricsFor(o),u=e.getStreamProcessor(),d=e.getStreamInfo(),c=e.getAbrController(),p=c.getThroughputHistory(),_=d?d.id:null,T=d&&d.manifestInfo&&d.manifestInfo.isDynamic,y=e.useBufferOccupancyABR(),v=w(t).create();if(v.reason=v.reason||{},!y)return v;u.getScheduleController().setTimeToLoadDelay(0);var A=function(e){var t=e.getMediaType(),r=l[t];return r?0!==r.state&&g(r,t):(r=f(e),l[t]=r),r}(e);if(0===A.state)return v\n;var R=n.getCurrentBufferLevel(s),I=p.getAverageThroughput(o,T),S=p.getSafeAverageThroughput(o,T),N=p.getAverageLatency(o),D=void 0;if(v.reason.state=A.state,v.reason.throughput=I,v.reason.latency=N,isNaN(I))return v;switch(A.state){case 1:D=c.getQualityForBitrate(i,S,N),v.quality=D,v.reason.throughput=S,A.placeholderBuffer=Math.max(0,E(A,D)-R),A.lastQuality=D,!isNaN(A.lastSegmentDurationS)&&R>=A.lastSegmentDurationS&&(A.state=2);break;case 2:!function(e,t){var r=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var n=.001*(r-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,n)}}else{var i=.001*(r-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=r,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,g(e,t)}(A,o),D=function(e,t){for(var r=e.bitrates.length,n=NaN,i=NaN,a=0;a<r;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,n=a)}return n}(A,R+A.placeholderBuffer);var O=c.getQualityForBitrate(i,S,N);D>A.lastQuality&&D>O&&(D=Math.max(O,A.lastQuality));var C=Math.max(0,R+A.placeholderBuffer-m(A,D));C<=A.placeholderBuffer?(A.placeholderBuffer-=C,C=0):(C-=A.placeholderBuffer,A.placeholderBuffer=0,D<c.getTopQualityIndexFor(o,_)?u.getScheduleController().setTimeToLoadDelay(1e3*C):C=0),v.quality=D,v.reason.throughput=I,v.reason.latency=N,v.reason.bufferLevel=R,v.reason.placeholderBuffer=A.placeholderBuffer,v.reason.delay=C,A.lastQuality=D;break;default:r(\"BOLA ABR rule invoked in bad state.\"),v.quality=c.getQualityForBitrate(i,S,N),v.reason.state=A.state,v.reason.throughput=S,v.reason.latency=N,A.state=1,h(A)}return v},reset:function(){D(),s.off(p.BUFFER_EMPTY,T,u),s.off(p.PLAYBACK_SEEKING,y,u),s.off(p.PERIOD_SWITCH_STARTED,v,u),s.off(p.MEDIA_FRAGMENT_LOADED,A,u),s.off(p.METRIC_ADDED,R,u),s.off(p.QUALITY_CHANGE_REQUESTED,S,u),s.off(p.FRAGMENT_LOADING_ABANDONED,N,u)}},D(),s.on(p.BUFFER_EMPTY,T,u),s.on(p.PLAYBACK_SEEKING,y,u),s.on(p.PERIOD_SWITCH_STARTED,v,u),s.on(p.MEDIA_FRAGMENT_LOADED,A,u),s.on(p.METRIC_ADDED,R,u),s.on(p.QUALITY_CHANGE_REQUESTED,S,u),s.on(p.FRAGMENT_LOADING_ABANDONED,N,u),u}V.__dashjs_factory_name=\"BolaRule\";var Y=s.a.getClassFactory(V),q=\"qualitySwitchRules\",W=\"abandonFragmentRules\";function Q(e){e=e||{};var t=this.context,r=e.mediaPlayerModel,n=e.metricsModel,i=e.dashMetrics,a=void 0,o=void 0;function s(e){return e.filter((function(e){return e.quality>w.NO_CHANGE}))}function u(e){var r,n={},i=void 0,a=void 0,o=void 0,s=void 0;if(0!==e.length){for(n[w.PRIORITY.STRONG]=w.NO_CHANGE,n[w.PRIORITY.WEAK]=w.NO_CHANGE,n[w.PRIORITY.DEFAULT]=w.NO_CHANGE,i=0,r=e.length;i<r;i+=1)(a=e[i]).quality!==w.NO_CHANGE&&(n[a.priority]=n[a.priority]>w.NO_CHANGE?Math.min(n[a.priority],a.quality):a.quality);return n[w.PRIORITY.WEAK]!==w.NO_CHANGE&&(o=n[w.PRIORITY.WEAK]),n[w.PRIORITY.DEFAULT]!==w.NO_CHANGE&&(o=n[w.PRIORITY.DEFAULT]),n[w.PRIORITY.STRONG]!==w.NO_CHANGE&&(o=n[w.PRIORITY.STRONG]),o!==w.NO_CHANGE&&(s=o),w(t).create(s)}}return{initialize:function(){a=[],o=[],r.getUseDefaultABRRules()&&(a.push(Y(t).create({metricsModel:n,dashMetrics:i,mediaPlayerModel:r})),a.push(F(t).create({metricsModel:n,dashMetrics:i})),o.push(U(t).create({metricsModel:n,dashMetrics:i,mediaPlayerModel:r}))),r.getABRCustomRules().forEach((function(e){e.type===q&&a.push(e.rule(t).create()),e.type===W&&o.push(e.rule(t).create())}))},reset:function(){[a,o].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),a=[],o=[]},getMaxQuality:function(e){return u(s(a.map((function(t){return t.getMaxIndex(e)}))))||w(t).create()},shouldAbandonFragment:function(e){return u(s(o.map((function(t){return t.shouldAbandon(e)}))))||w(t).create()}}}Q.__dashjs_factory_name=\"ABRRulesCollection\";var K=s.a.getClassFactory(Q);K.QUALITY_SWITCH_RULES=q,K.ABANDON_FRAGMENT_RULES=W,s.a.updateSingletonFactory(Q.__dashjs_factory_name,K);var j=K;var z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,\nthis.scanType=null,this.qualityIndex=NaN,this.id=\"\"};function X(e){var t=(e=e||{}).abrController,r=e.streamProcessor,n=e.streamProcessor.getCurrentRepresentationInfo(),i=e.switchHistory,a=e.droppedFramesHistory,o=e.currentRequest,s=e.useBufferOccupancyABR;return{getMediaType:function(){return n.mediaInfo.type},getMediaInfo:function(){return n.mediaInfo},getDroppedFramesHistory:function(){return a},getCurrentRequest:function(){return o},getSwitchHistory:function(){return i},getStreamInfo:function(){return n.mediaInfo.streamInfo},getStreamProcessor:function(){return r},getAbrController:function(){return t},getRepresentationInfo:function(){return n},useBufferOccupancyABR:function(){return s}}}X.__dashjs_factory_name=\"RulesContext\";var Z=s.a.getClassFactory(X);function J(){var e=[],t=[];return{push:function(r){r.newValue===w.NO_CHANGE&&(r.newValue=r.oldValue),e[r.oldValue]||(e[r.oldValue]={noDrops:0,drops:0,dropSize:0});var n=r.newValue-r.oldValue,i=n<0?1:0,a=i?-n:0,o=i?0:1;if(e[r.oldValue].drops+=i,e[r.oldValue].dropSize+=a,e[r.oldValue].noDrops+=o,t.push({idx:r.oldValue,noDrop:o,drop:i,dropSize:a}),t.length>8){var s=t.shift();e[s.idx].drops-=s.drop,e[s.idx].dropSize-=s.dropSize,e[s.idx].noDrops-=s.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}J.__dashjs_factory_name=\"SwitchRequestHistory\";var $=s.a.getClassFactory(J);function ee(){var e=[],t=0,r=0;return{push:function(n,i){var a=i&&i.droppedVideoFrames?i.droppedVideoFrames:0,o=i&&i.totalVideoFrames?i.totalVideoFrames:0,s=a-t;t=a;var u=o-r;r=o,isNaN(n)||(e[n]?(e[n].droppedVideoFrames+=s,e[n].totalVideoFrames+=u):e[n]={droppedVideoFrames:s,totalVideoFrames:u})},getFrameHistory:function(){return e},getFrameInfo:function(){return{droppedFrames:t,totalFrames:r}},reset:function(n){e=[],t=n.droppedVideoFrames,r=n.totalVideoFrames}}}ee.__dashjs_factory_name=\"DroppedFramesHistory\";var te=s.a.getClassFactory(ee);function re(e){var t=(e=e||{}).mediaPlayerModel,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;function u(e,t,r,n){var i=Math.pow(.5,r/n.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,r/n.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=r}function l(e,u,l){return t.getMovingAverageMethod()!==n.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var r=e?s.throughputHalfLife:s.latencyHalfLife,n=e?a[t]:o[t];if(!n||n.totalWeight<=0)return NaN;var i=n.fastEstimate/(1-Math.pow(.5,n.totalWeight/r.fast)),u=n.slowEstimate/(1-Math.pow(.5,n.totalWeight/r.slow));return e?Math.min(i,u):Math.max(i,u)}(e,u):function(e,t,n){var a=function(e,t,n){var a=void 0,o=void 0;if(e?(a=r[t],o=n?3:4):(a=i[t],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var u=a[s]/a[s-1];if((u>=1.3||u<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,t,n),o=(e?r:i)[t];if(0===a||!o||0===o.length)return NaN;return(o=o.slice(-a)).reduce((function(e,t){return e+t}))/o.length}(e,u,l)}function d(e,t){return l(!0,e,t)}function c(e){r[e]=r[e]||[],i[e]=i[e]||[],a[e]=a[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},o[e]=o[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function f(){r={},i={},a={},o={}}var h={push:function(e,l,d){if(l.trace&&l.trace.length){!1;var f=l.tresponse.getTime()-l.trequest.getTime()||1,h=l._tfinish.getTime()-l.tresponse.getTime()||1,p=l.trace.reduce((function(e,t){return e+t.b[0]}),0),g=f+h,m=Math.round(8*p/g);if(!(p<1e4)){if(c(e),function(e,r,i){return e===n.VIDEO?i+r<t.getCacheLoadThresholdForType(n.VIDEO):e===n.AUDIO?i+r<t.getCacheLoadThresholdForType(n.AUDIO):void 0}(e,f,h)){if(r[e].length>0&&!r[e].hasCachedEntries)return;r[e].hasCachedEntries=!0}else r[e]&&r[e].hasCachedEntries&&function(e){delete r[e],delete i[e],delete a[e],delete o[e],c(e)}(e);r[e].push(m),r[e].length>5&&r[e].shift(),i[e].push(f),i[e].length>5&&i[e].shift(),u(a[e],m,.001*h,s.throughputHalfLife),u(o[e],f,1,s.latencyHalfLife)}}},getAverageThroughput:d,getSafeAverageThroughput:function(e,r){var n=d(e,r);return isNaN(n)||(n*=t.getBandwidthSafetyFactor()),n},getAverageLatency:function(e){return l(!1,e)},getDict:function(e){return{throughput:r[e],\nlatency:i[e]}},reset:f};return s={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},f(),h}re.__dashjs_factory_name=\"ThroughputHistory\";var ne=s.a.getClassFactory(re),ie=\"abandonload\",ae=\"allowload\";function oe(){var e=this.context,t=_(e).getInstance(),r=d(e).getInstance(),a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,g=void 0,m=void 0,E=void 0,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,S=void 0,N=void 0,D=void 0,O=void 0,C=void 0,M=void 0,P=void 0,b=void 0,L=void 0,F=void 0,x=void 0,U=void 0,B=void 0,k=void 0,H=void 0,V=void 0,Y={video:0,audio:0},q={video:{},audio:{}};function W(e){e||(l={video:!0,audio:!0}),c={},f={},h={},g={},E={},m={},L={},U={},y=!1,H=!0,v=!1,void 0===A&&(A=!1),b=void 0,F=void 0,x=void 0,clearTimeout(T),T=null}function Q(e){e.mediaType===n.VIDEO&&(b=e.oldQuality,F.push(b,C.getPlaybackQuality()))}function K(e){e.metric!==i.HTTP_REQUEST||!e.value||e.value.type!==G.MEDIA_SEGMENT_TYPE||e.mediaType!==n.AUDIO&&e.mediaType!==n.VIDEO||x.push(e.mediaType,e.value,H),e.metric!==i.BUFFER_LEVEL||e.mediaType!==n.AUDIO&&e.mediaType!==n.VIDEO||function(e,t){var r=M.getABRStrategy();if(r===n.ABR_STRATEGY_BOLA)return void(U[e]=!0);if(r===n.ABR_STRATEGY_THROUGHPUT)return void(U[e]=!1);var i=M.getStableBufferTime(),a=i,s=.5*i,u=U[e],l=t>(u?s:a);U[e]=l,l!==u&&o(l?\"AbrController (\"+e+\") switching from throughput to buffer occupancy ABR rule (buffer: \"+t.toFixed(3)+\").\":\"AbrController (\"+e+\") switching from buffer occupancy to throughput ABR rule (buffer: \"+t.toFixed(3)+\").\")}(e.mediaType,.001*e.value.level)}function X(e,t){return c[t]=c[t]||{},c[t].hasOwnProperty(e)||(c[t][e]=0),function(e,t){if(t!==n.VIDEO||!y||!m[t])return e;A||me();var r=N.getValue(),i=D.getAdaptationForType(r,0,t).Representation,a=e;if(R>0&&S>0){for(;a>0&&i[a]&&R<i[a].width&&R-i[a-1].width<i[a].width-R;)a-=1;i.length-2>=a&&i[a].width===i[a+1].width&&(a=Math.min(e,a+1))}return a}(function(e,t,r){var n=se(t);if(isNaN(n)||n>=1||n<0)return e;return Math.min(e,Math.round(r*n))}(function(e,t){var r=e;if(!m[t])return r;var n=oe(t);void 0!==n&&(r=Math.max(e,n));var i=re(t);void 0!==i&&(r=Math.min(r,i));return r}(c[t][e],e),e,c[t][e]),e)}function J(e){return h.hasOwnProperty(\"max\")&&h.max.hasOwnProperty(e)?h.max[e]:NaN}function ee(e){return h.hasOwnProperty(\"min\")&&h.min.hasOwnProperty(e)?h.min[e]:NaN}function re(e){var t=J(e);return t?fe(m[e].getMediaInfo(),t):void 0}function oe(e){var t=ee(e);if(t){var r=he(m[e].getMediaInfo()),n=fe(m[e].getMediaInfo(),t);return r[n]&&n<r.length-1&&r[n].bitrate<1e3*t&&n++,n}}function se(e){return g.hasOwnProperty(\"max\")&&g.max.hasOwnProperty(e)?g.max[e]:1}function ue(e){return l[e]}function le(e,t,r,n){var i=t.id,a=ge(e);if(!(null!==r&&!isNaN(r)&&r%1==0))throw new Error(\"argument is not an integer\");var o=X(e,i);r!==a&&r>=0&&r<=o&&de(e,a,r,o,n)}function de(e,n,i,a,s){if(e&&m[e]){var u=m[e].getStreamInfo(),l=u?u.id:null;if(t.getLogToBrowserConsole()){var d=k.getCurrentBufferLevel(B.getReadOnlyMetricsFor(e));o(\"AbrController (\"+e+\") switch from \"+n+\" to \"+i+\"/\"+a+\" (buffer: \"+d+\") \"+(s?JSON.stringify(s):\".\"))}!function(e,t,r){f[t]=f[t]||{},f[t][e]=r}(e,l,i),r.trigger(p.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:u,oldQuality:n,newQuality:i,reason:s})}}function ce(e,t){E[e].state=t}function fe(e,t,r){if(H&&r&&m[e.type].getCurrentRepresentationInfo()&&m[e.type].getCurrentRepresentationInfo().fragmentDuration){r/=1e3;var n=m[e.type].getCurrentRepresentationInfo().fragmentDuration;if(r>n)return 0;t*=1-r/n}var i=he(e);if(!i||0===i.length)return 0;for(var a=i.length-1;a>=0;a--){if(1e3*t>=i[a].bitrate)return a}return 0}function he(e){if(!e||!e.bitrateList)return null;for(var t=e.bitrateList,r=e.type,n=[],i=void 0,a=0,o=t.length;a<o;a++)(i=new z).mediaType=r,i.qualityIndex=a,i.id=t[a].id,i.bitrate=t[a].bandwidth,i.width=t[a].width,i.height=t[a].height,i.scanType=t[a].scanType,n.push(i);return n}function pe(e){return U[e]}function ge(e){if(e&&m[e]){var t=m[e].getStreamInfo(),r=t?t.id:null;if(r)return f[r]=f[r]||{},f[r].hasOwnProperty(e)||(f[r][e]=_e(e,!1)||0),f[r][e]}return 0}\nfunction me(){if(C){var e=v&&window.hasOwnProperty(\"devicePixelRatio\")?window.devicePixelRatio:1;R=C.getClientWidth()*e,S=C.getClientHeight()*e}}function Ee(t){var r=t.request.mediaType;if(ue(r)){var n=m[r];if(!n)return;var i=Z(e).create({abrController:a,streamProcessor:n,currentRequest:t.request,useBufferOccupancyABR:pe(r)}),o=s.shouldAbandonFragment(i);if(o.quality>w.NO_CHANGE){var l=n.getFragmentModel();l.getRequests({state:I.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(l.abortRequests(),ce(r,ie),L[r].reset(),L[r].push({oldValue:ge(r,u.getActiveStreamInfo()),newValue:o.quality,confidence:1,reason:o.reason}),le(r,u.getActiveStreamInfo(),o.quality,o.reason),clearTimeout(T),T=setTimeout((function(){ce(r,ae),T=null}),M.getAbandonLoadTimeout()))}}}function _e(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var r=M.getPreloadData();if(r&&r[e+\"id\"])return m[e].getRepresentationController().getQualityForRepresentationId(r[e+\"id\"])}return Y[e]||0}return a={isPlayingAtTopQuality:function(e){var t=e.id,r=ge(n.AUDIO),i=ge(n.VIDEO);return r===X(n.AUDIO,t)&&i===X(n.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,r=e.streamInfo.id,n=e.representationCount-1;return function(e,t,r){c[t]=c[t]||{},c[t][e]=r}(t,r,n),n},getThroughputHistory:function(){return x},getBitrateList:he,getQualityForBitrate:fe,getMaxAllowedBitrateFor:J,getTopBitrateInfoFor:function(e){if(e&&m&&m[e]){var t=m[e].getStreamInfo();if(t.id){var r=X(e,t.id),n=he(m[e].getMediaInfo());return n[r]?n[r]:null}}return null},getMinAllowedBitrateFor:ee,setMaxAllowedBitrateFor:function(e,t){h.max=h.max||{},h.max[e]=t},setMinAllowedBitrateFor:function(e,t){h.min=h.min||{},h.min[e]=t},getMaxAllowedIndexFor:re,getMinAllowedIndexFor:oe,getMaxAllowedRepresentationRatioFor:se,setMaxAllowedRepresentationRatioFor:function(e,t){g.max=g.max||{},g.max[e]=t},getInitialBitrateFor:function(e){var t=P.getSavedBitrateSettings(e);if(!h.hasOwnProperty(e))if(g.hasOwnProperty(e)){var r=N.getValue(),i=D.getAdaptationForType(r,0,e).Representation;if(Array.isArray(i)){var a=Math.max(Math.round(i.length*g[e])-1,0);h[e]=i[a].bandwidth}else h[e]=0}else isNaN(t)?h[e]=e===n.VIDEO?1e3:100:h[e]=t;return h[e]},setInitialBitrateFor:function(e,t){h[e]=t},getInitialRepresentationRatioFor:function(e){return g.hasOwnProperty(e)?g[e]:null},setInitialRepresentationRatioFor:function(e,t){g[e]=t},setAutoSwitchBitrateFor:function(e,t){l[e]=t},getAutoSwitchBitrateFor:ue,getUseDeadTimeLatency:function(){return H},setUseDeadTimeLatency:function(e){H=e},setLimitBitrateByPortal:function(e){y=e},getLimitBitrateByPortal:function(){return y},getUsePixelRatioInLimitBitrateByPortal:function(){return v},setUsePixelRatioInLimitBitrateByPortal:function(e){v=e},getQualityFor:ge,getAbandonmentStateFor:function(e){return E[e]?E[e].state:null},setPlaybackQuality:le,checkPlaybackQuality:function(r){if(r&&m&&m[r]){var n=m[r].getStreamInfo(),i=n?n.id:null,u=ge(r),l=Z(e).create({abrController:a,streamProcessor:m[r],currentValue:u,switchHistory:L[r],droppedFramesHistory:F,useBufferOccupancyABR:pe(r)});if(F){var d=C.getPlaybackQuality();d&&F.push(b,d)}if(ue(r)){var c=oe(r),f=X(r,i),h=s.getMaxQuality(l),p=h.quality;if(void 0!==c&&p<c&&(p=c),p>f&&(p=f),L[r].push({oldValue:u,newValue:p}),p>w.NO_CHANGE&&p!=u)E[r].state!==ae&&p===u||de(r,u,p,f,h.reason);else if(t.getLogToBrowserConsole()){var g=k.getCurrentBufferLevel(B.getReadOnlyMetricsFor(r));o(\"AbrController (\"+r+\") stay on \"+u+\"/\"+f+\" (buffer: \"+g+\")\")}}}},getTopQualityIndexFor:X,setElementSize:me,setWindowResizeEventCalled:function(e){A=e},createAbrRulesCollection:function(){(s=j(e).create({metricsModel:B,dashMetrics:k,mediaPlayerModel:M,adapter:O})).initialize()},registerStreamType:function(t,i){L[t]=$(e).create(),m[t]=i,E[t]=E[t]||{},E[t].state=ae,U[t]=!1,r.on(p.LOADING_PROGRESS,Ee,this),t==n.VIDEO&&(r.on(p.QUALITY_CHANGE_RENDERED,Q,this),F=te(e).create(),me()),r.on(p.METRIC_ADDED,K,this),x=ne(e).create({mediaPlayerModel:M})},unRegisterStreamType:function(e){delete m[e]},setDefaultQualityFor:function(e,t){Y[e]=Number(t)||0,\no(\"Set default quality for \"+e+\" - \"+Y[e])},getDefaultQualityFor:_e,getDroppedFramesInfo:function(){return F&&F.getFrameInfo&&F.getFrameInfo()||{}},setCurrentSegmentInfoFor:function(e,t){q[e]=t},getCurrentSegmentInfoFor:function(e){return q[e]},getInitializeDate:function(){return V},setConfig:function(e){e&&(e.streamController&&(u=e.streamController),e.domStorage&&(P=e.domStorage),e.mediaPlayerModel&&(M=e.mediaPlayerModel),e.metricsModel&&(B=e.metricsModel),e.dashMetrics&&(k=e.dashMetrics),e.dashManifestModel&&(D=e.dashManifestModel),e.adapter&&(O=e.adapter),e.manifestModel&&(N=e.manifestModel),e.videoModel&&(C=e.videoModel),e.initializeDate&&(V=e.initializeDate))},reset:function(){W(!0),r.off(p.LOADING_PROGRESS,Ee,this),r.off(p.QUALITY_CHANGE_RENDERED,Q,this),r.off(p.METRIC_ADDED,K,this),s&&s.reset()}},o=t.log.bind(a),W(),a}oe.__dashjs_factory_name=\"AbrController\";var se=s.a.getSingletonFactory(oe);se.ABANDON_LOAD=ie,se.QUALITY_DEFAULT=0,s.a.updateSingletonFactory(oe.__dashjs_factory_name,se);var ue=se,le=\"neverReplace\",de=\"alwaysReplace\",ce=\"highestBitrate\",fe=\"widestRange\",he=ce;function pe(){var e,t=this.context,r=_(t).getInstance().log,i=d(t).getInstance(),a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=[de,le],f=[ce,fe],h={video:0,audio:0};function g(e,t){if(!e||!t)return[];var r=t.id;return a[r]&&a[r][e]?a[r][e].list:[]}function m(e,t){return!e||!t||t&&!a[t.id]?null:a[t.id][e].current}function E(e){if(e){var t=e.type,r=e.streamInfo,n=r.id,o=m(t,r);if(a[n]&&a[n][t]&&(!o||!R(e,o))){a[n][t].current=e,o&&i.trigger(p.CURRENT_TRACK_CHANGED,{oldMediaInfo:o,newMediaInfo:e,switchMode:u[t]});var s=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);s&&a[n][t].storeLastSettings&&(s.roles&&(s.role=s.roles[0],delete s.roles),s.accessibility&&(s.accessibility=s.accessibility[0]),s.audioChannelConfiguration&&(s.audioChannelConfiguration=s.audioChannelConfiguration[0]),l.setSavedMediaSettings(t,s))}}}function T(e,t){e&&t&&(o[e]=t)}function y(e){return e?o[e]:null}function v(){return s||he}function A(e){return e===n.AUDIO||e===n.VIDEO||e===n.TEXT||e===n.FRAGMENTED_TEXT||e===n.IMAGE}function R(e,t){var r=e.id===t.id,n=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return r&&n&&i&&a&&o&&s}function I(){a={},o={audio:null,video:null},u={audio:de,video:le}}function S(e,t){var r=!e.lang||e.lang===t.lang,n=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],a=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return r&&n&&i&&a&&o}function N(e){var t=v(),n=[],i=function(e){var t=0,r=[],n=void 0;return e.forEach((function(e){(n=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>t?(t=n,r=[e]):n===t&&r.push(e)})),r},a=function(e){var t=0,r=[],n=void 0;return e.forEach((function(e){(n=e.representationCount)>t?(t=n,r=[e]):n===t&&r.push(e)})),r};switch(t){case ce:(n=i(e)).length>1&&(n=a(n));break;case fe:(n=a(e)).length>1&&(n=i(e));break;default:r(\"track selection mode is not supported: \"+t)}return n[0]}return e={checkInitialMediaSettingsForType:function(e,t){var r=y(e),i=g(e,t),a=[];e!==n.FRAGMENTED_TEXT?(r||T(e,r=l.getSavedMediaSettings(e)),i&&0!==i.length&&(r&&i.forEach((function(e){S(r,e)&&a.push(e)})),0===a.length?E(N(i)):a.length>1?E(N(a)):E(a[0]))):E(i[0])},addTrack:function(e){if(e){var t=e.type;if(A(t)){var r=e.streamInfo.id;a[r]||(a[r]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],\nstoreLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var n=a[r][t].list,i=0,o=n.length;i<o;++i)if(R(n[i],e))return;n.push(e);var s=y(t);s&&S(s,e)&&!m(t,e.streamInfo)&&E(e)}}},getTracksFor:g,getCurrentTrackFor:m,isCurrentTrack:function(e){var t=e.type,r=e.streamInfo.id;return a[r]&&a[r][t]&&R(a[r][t].current,e)},setTrack:E,setInitialSettings:T,getInitialSettings:y,setSwitchMode:function(e,t){-1!==c.indexOf(t)?u[e]=t:r(\"track switch mode is not supported: \"+t)},getSwitchMode:function(e){return u[e]},setSelectionModeForInitialTrack:function(e){-1!==f.indexOf(e)?s=e:r(\"track selection mode is not supported: \"+e)},getSelectionModeForInitialTrack:v,isMultiTrackSupportedByType:A,isTracksEqual:R,setStartOffsetTimeForType:function(e,t){e&&t>0&&(h[e]=t)},getStartOffsetTimeForType:function(e){return h[e]||0},setConfig:function(e){e&&(e.errHandler&&e.errHandler,e.domStorage&&(l=e.domStorage))},reset:I},I(),e}pe.__dashjs_factory_name=\"MediaController\";var ge=s.a.getSingletonFactory(pe);ge.TRACK_SWITCH_MODE_NEVER_REPLACE=le,ge.TRACK_SWITCH_MODE_ALWAYS_REPLACE=de,ge.TRACK_SELECTION_MODE_HIGHEST_BITRATE=ce,ge.TRACK_SELECTION_MODE_WIDEST_RANGE=fe,ge.DEFAULT_INIT_TRACK_SELECTION_MODE=he,s.a.updateSingletonFactory(pe.__dashjs_factory_name,ge);var me=ge;var Ee=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var r=0;r<t.boxes.length;r++)this.boxes.push(new e(t.boxes[r]));switch(this.isComplete=!0,t.type){case\"sidx\":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var n=0;n<t.references.length;n++){var i={reference_type:t.references[n].reference_type,referenced_size:t.references[n].referenced_size,subsegment_duration:t.references[n].subsegment_duration};this.references.push(i)}}break;case\"emsg\":this.id=t.id,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case\"mdhd\":this.timescale=t.timescale;break;case\"mfhd\":this.sequence_number=t.sequence_number;break;case\"subs\":this.entry_count=t.entry_count,this.entries=t.entries;break;case\"tfhd\":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case\"tfdt\":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case\"trun\":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}break;case\"elst\":this.boxes=t.entries;break;case\"mvhd\":this.timescale=t.timescale}}return e.prototype.getChildBox=function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]},e.prototype.getChildBoxes=function(e){for(var t=[],r=0;r<this.boxes.length;r++)this.boxes[r].type===e&&t.push(this.boxes[r]);return t},e}();function _e(){var e=void 0;function t(t){var n=[];if(!t||!e||\"function\"!=typeof e.fetchAll)return n;for(var i=e.fetchAll(t),a=void 0,o=0,s=i.length;o<s;o++)(a=r(i[o]))&&n.push(a);return n}function r(e){if(!e)return null;var t=new Ee(e);return e.hasOwnProperty(\"_incomplete\")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&\"function\"==typeof e.fetch?r(e.fetch(t)):null},getBoxes:t,\nsetData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var r=t(e.boxes[e.boxes.length-1].type);return r.length>0?r[r.length-1]:null}}}_e.__dashjs_factory_name=\"IsoFile\";var Te=s.a.getClassFactory(_e),ye=r(1),ve=r.n(ye);var Ae=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.lastCompletedOffset=t,this.found=r,this.size=n};function Re(){var e=this.context;function t(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function r(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return{parse:function(t){if(!t)return null;void 0===t.fileStart&&(t.fileStart=0);var r=ve.a.parseBuffer(t),n=Te(e).create();return n.setData(r),n},findLastTopIsoBoxCompleted:function(e,n,i){if(void 0===i&&(i=0),!n||i+8>=n.byteLength)return new Ae(0,!1);for(var a=n instanceof ArrayBuffer?new Uint8Array(n):n,o=void 0,s=0;i<a.byteLength;){var u=t(a,i),l=r(a,i+4);if(0===u)break;i+u<=a.byteLength&&(e.indexOf(l)>=0?o=new Ae(i,!0,u):s=i+u),i+=u}return o||new Ae(s,!1)}}}Re.__dashjs_factory_name=\"BoxParser\";var Ie=s.a.getSingletonFactory(Re);function Se(){var e={};return{save:function(t){var r=t.streamId,n=t.representationId;e[r]=e[r]||{},e[r][n]=t},extract:function(t,r){return e&&e[t]&&e[t][r]?e[t][r]:null},reset:function(){e={}}}}Se.__dashjs_factory_name=\"InitCache\";var Ne=s.a.getSingletonFactory(Se),De=\"bufferLoaded\",Oe=\"bufferStalled\",Ce=.5,Me=.5,Pe=.01,be=\"BufferController\";function we(e){e=e||{};var t=this.context,r=d(t).getInstance(),i=e.metricsModel,a=e.mediaPlayerModel,o=e.errHandler,s=e.streamController,u=e.mediaController,l=e.adapter,c=e.abrController,f=e.playbackController,h=e.type,g=e.streamProcessor,m=void 0,E=void 0,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,S=void 0,N=void 0,O=void 0,M=void 0,P=void 0,b=void 0,w=void 0,L=void 0,F=void 0,x=void 0,U=void 0,B=void 0,k=void 0,H=void 0,V=void 0,Y=void 0,q=void 0,W=void 0,Q=void 0,K=void 0;function j(e){if(!x||!e||!g)return null;if(R)try{\"function\"==typeof(O=D(t).create(R,e,$.bind(this))).getBuffer().initialize&&O.getBuffer().initialize(h,g),r.trigger(p.BUFFER_CREATED,{mediaType:e.type})}catch(e){E(\"Caught error on create SourceBuffer: \"+e),o.mediaSourceError(\"Error creating \"+h+\" source buffer.\")}else O=C(t).create($.bind(this));_e(g.getRepresentationInfoForQuality(T).MSETimeOffset)}function z(e){e.fragmentModel===g.getFragmentModel()&&(E(\"Init fragment finished loading saving to\",h+\"'s init cache\"),E(\"Append Init fragment\",h,\" with representationId:\",e.chunk.representationId,\" and quality:\",e.chunk.quality),O?O.setAppendWindowEnd(a.getCachedDurationOffset(\"duration\")):K=function(){var e=a.getCachedDurationOffset(\"duration\");O.setAppendWindowEnd(e)},Z(e.chunk))}function X(e){if(e.fragmentModel===g.getFragmentModel()){var r=e.chunk,n=r.bytes,i=r.quality,a=g.getRepresentationInfoForQuality(i),o=l.getEventsFor(a.mediaInfo,g),s=l.getEventsFor(a,g);if(o&&o.length>0||s&&s.length>0){var u=function(e,r,n,i){for(var a=Math.max(!r||isNaN(r.startTime)?0:r.startTime,0),o=[],s=[],u=n.concat(i),d=0,c=u.length;d<c;d++)o[u[d].schemeIdUri]=u[d];for(var f=Ie(t).getInstance().parse(e).getBoxes(\"emsg\"),h=0,p=f.length;h<p;h++){var g=l.getEvent(f[h],o,a);g&&s.push(g)}return s}(n,g.getFragmentModel().getRequests({state:I.FRAGMENT_MODEL_EXECUTED,quality:i,index:r.index})[0],o,s);g.getEventController().addInbandEvents(u)}if(V){Y=r;var d=O&&O.getAllBufferRanges();d&&d.length>0&&f.getTimeToStreamEnd()>Ce&&(E(\"Clearing buffer because track changed - \"+(d.end(d.length-1)+.5)),pe([{start:0,end:d.end(d.length-1)+.5,force:!0}]))}else Z(r)}}function Z(e,t){!L||t?(L=!0,b=e,e.startOffsetTime=u.getStartOffsetTimeForType(e.mediaInfo.type),O?O.append(e):q.push(e),e.mediaInfo.type===n.VIDEO&&r.trigger(p.VIDEO_CHUNK_RECEIVED,{chunk:e})):H.push(e)}function J(e){if(e.mediaType===h&&(K&&(K(),K=null),q.length))for(var t=Date.now(),n=e.mediaType,i=c.getInitializeDate(),o=0;o<q.length;o++){var s=q[o]\n;s&&s.mediaInfo.type===n&&O&&O.append&&(q[o]=null,W&&(_e(W),W=0),O.append(s),r.trigger(p.DELAY_TO_APPEND_TO_BUFFER,{mediaType:n,appendTime:t-i,createdTime:Date.now()-i,isPreload:!!a.getPreloadData()}))}}function $(e){if(e.error){if(22===e.error.code&&(A=.8*Le(),E(\"Quota exceeded for type: \"+h+\", Critical Buffer: \"+A),A>0)){var t=Math.max(.2*A,1),n=A-t;a.setBufferToKeep(parseFloat(t).toFixed(5)),a.setBufferAheadToKeep(parseFloat(n).toFixed(5))}22!==e.error.code&&Fe()||(E(\"Clearing playback buffer to overcome quota exceed situation for type: \"+h),r.trigger(p.QUOTA_EXCEEDED,{sender:m,criticalBufferLevel:A,mediaType:h}),re(),L=!1)}else{(b=e.chunk)&&!isNaN(b.index)&&(S=Math.max(b.index,S),de());var i=O.getAllBufferRanges();if(b.segmentType===G.MEDIA_SEGMENT_TYPE)ne();else if(V){var o=f.getTime();E(\"[BufferController][\",h,\"] appendToBuffer seek target should be \"+o),g.getScheduleController().setSeekTarget(o),l.setIndexHandlerTime(g,o)}var s={sender:m,quality:b.quality,startTime:b.start,index:b.index,bufferedRanges:i};if(b&&!b.endFragment?r.trigger(p.BYTES_APPENDED,s):b&&r.trigger(p.BYTES_APPENDED_END_FRAGMENT,s),0===H.length)L=!1;else Z(H.shift(),!0)}}function ee(e){T!==e.newQuality&&h===e.mediaType&&g.getStreamInfo().id===e.streamInfo.id&&(_e(g.getRepresentationInfoForQuality(e.newQuality).MSETimeOffset),T=e.newQuality)}function te(){if(y&&(B=!0,y=!1,N=Number.POSITIVE_INFINITY),H=[],L=!1,h!==n.FRAGMENTED_TEXT){var e=O.getAllBufferRanges(),t=!0;if(e&&e.length>0)for(var r=f.getTime(),i=0,a=e.length;i<a;i++)r>=e.start(i)&&r<=e.end(i)-1&&(t=!1);t?(g.getFragmentModel().clearExecutedRequestBySeeking(),re()):ne()}else ne();U=void 0}function re(){var e=function(){var e=[],t=O.getAllBufferRanges();if(!t||0===t.length)return e;var r=f.getTime(),n=t.end(t.length-1)+Me,i=g.getFragmentModel().getRequests({state:I.FRAGMENT_MODEL_EXECUTED,time:r,threshold:Pe})[0];if(i){var a={start:0,end:i.startTime-Ce},o=g.getFragmentModel().getRequests({state:I.FRAGMENT_MODEL_EXECUTED,time:i.startTime-i.duration/2,threshold:Pe})[0];o&&o.startTime!=i.startTime&&(a.end=o.startTime),a.start<a.end&&a.end>t.start(0)&&e.push(a);var s={start:i.startTime+i.duration+Ce,end:n},u=g.getFragmentModel().getRequests({state:I.FRAGMENT_MODEL_EXECUTED,time:i.startTime+i.duration+Ce,threshold:Pe})[0];u&&u.startTime!==i.startTime&&(s.start=u.startTime+u.duration+Ce),s.start<s.end&&s.start<n&&e.push(s)}else E(\"getAllRangesWithSafetyFactor for\",h,\"- No request found in current time position, removing full buffer 0 -\",n),e.push({start:0,end:n});return e}();e&&0!==e.length||ne(),pe(e)}function ne(){V||(se(),le())}function ie(){ce()}function ae(){ce()}function oe(e,t){var r=O&&O.getAllBufferRanges(),n=0,i=0,a=null,o=null,s=0,u=void 0,l=void 0,d=t||.15;if(null!=r){for(l=0,u=r.length;l<u;l++)if(n=r.start(l),i=r.end(l),null===a)s=Math.abs(n-e),(e>=n&&e<i||s<=d)&&(a=n,o=i);else{if(!((s=n-o)<=d))break;o=i}if(null!==a)return{start:a,end:o}}return null}function se(){var e,t,n;f&&(e=function(){var e=f.getTime();if(U){var t=O.getAllBufferRanges();t&&t.length&&(e=Math.max(t.start(0),U))}return e}()||0,v=null===(n=oe(e,t))?0:n.end-e,r.trigger(p.BUFFER_LEVEL_UPDATED,{sender:m,bufferLevel:v}),ce())}function le(){g&&s&&g.getStreamInfo().id===s.getActiveStreamInfo().id&&(i.addBufferState(h,P,g.getScheduleController().getBufferTarget()),i.addBufferLevel(h,new Date,1e3*v))}function de(){S>=N-1&&!y&&void 0===O.discharge&&(y=!0,E(\"[BufferController][\"+h+\"] checkIfBufferingCompleted trigger BUFFERING_COMPLETED\"),r.trigger(p.BUFFERING_COMPLETED,{sender:m,streamInfo:g.getStreamInfo()}))}function ce(){\"audio\"!==h&&\"video\"!==h||(B&&!y&&f&&f.getTimeToStreamEnd()-v<Ce&&(B=!1,y=!0,E(\"[BufferController][\"+h+\"] checkIfSufficientBuffer trigger BUFFERING_COMPLETED\"),r.trigger(p.BUFFERING_COMPLETED,{sender:m,streamInfo:g.getStreamInfo()})),v<Ce&&!y?fe(Oe):(y||v>=a.getStableBufferTime())&&fe(De))}function fe(e){P===e||e===Oe&&0===f.getTime()||(P=e,le(),r.trigger(p.BUFFER_LEVEL_STATE_CHANGED,{sender:m,state:e,mediaType:h,streamInfo:g.getStreamInfo()}),r.trigger(e===De?p.BUFFER_LOADED:p.BUFFER_EMPTY,{mediaType:h\n}),E(e===De?\"Got enough buffer to start for \"+h:\"Waiting for more buffer before starting playback for \"+h))}function he(){O&&h!==n.FRAGMENTED_TEXT&&(y||pe(function(){var e=[],t=O.getAllBufferRanges();if(!t||0===t.length)return e;var r=f.getTime(),n={start:Math.max(0,r-a.getBufferToKeep()),end:r+a.getBufferAheadToKeep()},i=g.getFragmentModel().getRequests({state:I.FRAGMENT_MODEL_EXECUTED,time:r,threshold:Pe})[0];if(i)n.start=Math.min(i.startTime,n.start),n.end=Math.max(i.startTime+i.duration,n.end);else if(0===r&&f.getIsDynamic())return[];if(t.start(0)<=n.start){for(var o={start:0,end:n.start},s=0;s<t.length&&t.end(s)<=n.start;s++)o.end=t.end(s);o.start<o.end&&e.push(o)}if(t.end(t.length-1)>=n.end){var u={start:n.end,end:t.end(t.length-1)+Pe};u.start<u.end&&e.push(u)}return e}()))}function pe(e){e&&O&&0!==e.length&&(k.push.apply(k,e),F||ge())}function ge(){if(0===k.length||!O)return E(\"Nothing to prune, halt pruning\"),k=[],void(F=!1);var e=O.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return E(\"SourceBuffer is empty (or does not exist), halt pruning\"),k=[],void(F=!1);var t=k.shift();E(\"Removing\",h,\"buffer from:\",t.start,\"to\",t.end),F=!0;var r=f.getTime();r<t.end&&(y=!1,S=0,V||(g.getScheduleController().setSeekTarget(r),l.setIndexHandlerTime(g,r)));var n=s.getDuration()-1;n&&0===t.start&&t.end>=n&&(t.force=!0),O.remove(t.start,t.end,t.force)}function Ee(e){O===e.buffer&&(E(\"[BufferController][\",h,\"] onRemoved buffer from:\",e.from,\"to\",e.to),0===k.length&&(F=!1),e.unintended&&(E(\"[BufferController][\",h,\"] detected unintended removal from:\",e.from,\"to\",e.to,\"setting index handler time to\",e.from),l.setIndexHandlerTime(g,e.from)),F?ge():(V?(V=!1,Y&&Z(Y)):(E(\"onRemoved : call updateBufferLevel\"),se()),r.trigger(p.BUFFER_CLEARED,{sender:m,from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Fe()})))}function _e(e){0!==e&&(O&&O.updateTimestampOffset?O.updateTimestampOffset(e):W=e)}function Te(e){if(e.sender.getStreamProcessor()===g&&!e.error){var t=0;try{t=e.currentRepresentation.segmentAvailabilityRange.start}catch(e){}_e(t)}}function ye(e){e.fragmentModel===g.getFragmentModel()&&(N=e.request.index,de())}function ve(e){var t=O&&O.getAllBufferRanges();t&&e.newMediaInfo.type===h&&e.newMediaInfo.streamInfo.id===g.getStreamInfo().id&&(E(\"[BufferController][\"+h+\"] track change asked\"),u.getSwitchMode(h)===me.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&f.getTimeToStreamEnd()>Ce&&(y=!1,N=Number.POSITIVE_INFINITY))}function Ae(){++w*(a.getWallclockTimeUpdateInterval()/1e3)>=a.getBufferPruningInterval()&&(w=0,he())}function Re(){ce()}function Se(){if(a.getAppendingSourceState()){y=!1,N=Number.POSITIVE_INFINITY,x.reset();var e=a.getCachedDurationOffset(\"offset\");l.setIndexHandlerTime(g,e),g.resetPreloadData(),g.getFragmentModel().resetInitialSettings()}}function we(e,t){R=e,O&&t&&\"function\"==typeof O.discharge&&(M=O,j(t))}function Le(){var e,t=O.getAllBufferRanges(),r=0,n=void 0;if(!t)return r;for(n=0,e=t.length;n<e;n++)r+=t.end(n)-t.start(n);return r}function Fe(){return Le()<A}function xe(e){A=Number.POSITIVE_INFINITY,P=void 0,T=ue.QUALITY_DEFAULT,N=Number.POSITIVE_INFINITY,S=0,b=null,y=!1,L=!1,F=!1,B=!1,v=0,w=0,k=[],q=[],O&&(e||O.abort(),O.reset(),O=null),V=!1}return m={getBufferControllerType:function(){return be},initialize:function(e){0,we(e),T=c.getQualityFor(h,g.getStreamInfo()),r.on(p.DATA_UPDATE_COMPLETED,Te,this),r.on(p.INIT_FRAGMENT_LOADED,z,this),r.on(p.MEDIA_FRAGMENT_LOADED,X,this),r.on(p.QUALITY_CHANGE_REQUESTED,ee,this),r.on(p.STREAM_COMPLETED,ye,this),r.on(p.PLAYBACK_PLAYING,ae,this),r.on(p.PLAYBACK_PROGRESS,ne,this),r.on(p.PLAYBACK_TIME_UPDATED,ne,this),r.on(p.PLAYBACK_RATE_CHANGED,Re,this),r.on(p.PLAYBACK_SEEKING,te,this),r.on(p.PLAYBACK_STALLED,ie,this),r.on(p.WALLCLOCK_TIME_UPDATED,Ae,this),r.on(p.CURRENT_TRACK_CHANGED,ve,this,d.EVENT_PRIORITY_HIGH),r.on(p.SOURCEBUFFER_REMOVE_COMPLETED,Ee,this),r.on(p.BUFFER_CREATED,J,this),r.on(p.APPENDING_NEXT_SOURCE,Se,this)},createBuffer:j,dischargePreBuffer:function(){if(O&&M&&\"function\"==typeof M.discharge){var e=M.getAllBufferRanges()\n;if(e.length>0){for(var t=\"Beginning \"+h+\"PreBuffer discharge, adding buffer for:\",r=0;r<e.length;r++)t+=\" start: \"+e.start(r)+\", end: \"+e.end(r)+\";\";E(t)}else E(\"PreBuffer discharge requested, but there were no media segments in the PreBuffer.\");for(var n=M.discharge(),i=null,a=0;a<n.length;a++){var o=n[a],s=x.extract(o.streamId,o.representationId);s&&(i!==s&&(O.append(s),i=s),O.append(o))}M.reset(),M=null}},getType:function(){return h},getStreamProcessor:function(){return g},setSeekStartTime:function(e){U=e},getBuffer:function(){return O},getBufferLevel:function(){return v},getRangeAt:oe,setMediaSource:we,getMediaSource:function(){return R},getIsBufferingCompleted:function(){return y},switchInitData:function(e,t,n){var i=x.extract(e,t);V=!0===n&&n,Q=a.getAppendingSourceState(),i&&!Q?(E(\"Append Init fragment\",h,\" with representationId:\",i.representationId,\" and quality:\",i.quality),Z(i)):(Q&&(Q=!1,V=!1),r.trigger(p.INIT_REQUESTED,{sender:m}))},getIsPruningInProgress:function(){return F},reset:function(e){r.off(p.DATA_UPDATE_COMPLETED,Te,this),r.off(p.QUALITY_CHANGE_REQUESTED,ee,this),r.off(p.INIT_FRAGMENT_LOADED,z,this),r.off(p.MEDIA_FRAGMENT_LOADED,X,this),r.off(p.STREAM_COMPLETED,ye,this),r.off(p.CURRENT_TRACK_CHANGED,ve,this),r.off(p.PLAYBACK_PLAYING,ae,this),r.off(p.PLAYBACK_PROGRESS,ne,this),r.off(p.PLAYBACK_TIME_UPDATED,ne,this),r.off(p.PLAYBACK_RATE_CHANGED,Re,this),r.off(p.PLAYBACK_SEEKING,te,this),r.off(p.PLAYBACK_STALLED,ie,this),r.off(p.WALLCLOCK_TIME_UPDATED,Ae,this),r.off(p.SOURCEBUFFER_REMOVE_COMPLETED,Ee,this),r.off(p.BUFFER_CREATED,J,this),r.off(p.APPENDING_NEXT_SOURCE,Se,this),xe(e)}},E=_(t).getInstance().log.bind(m),x=Ne(t).getInstance(),H=[],q=[],W=0,xe(),m}we.__dashjs_factory_name=be;var Le=s.a.getClassFactory(we);Le.BUFFER_LOADED=De,Le.BUFFER_EMPTY=Oe,s.a.updateClassFactory(we.__dashjs_factory_name,Le);var Fe=Le;var xe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};function Ue(){var e=void 0;return{initialize:function(t){if(e=new xe,!t)return null;var r=t.indexOf(\"#\");if(-1!==r)for(var n=t.substr(r+1).split(\"&\"),i=0,a=n.length;i<a;++i){var o=n[i],s=o.indexOf(\"=\");if(-1!==s){var u=o.substring(0,s);e.hasOwnProperty(u)&&(e[u]=o.substr(s+1))}}},getURIFragmentData:function(){return e}}}Ue.__dashjs_factory_name=\"URIFragmentModel\";var Be=s.a.getSingletonFactory(Ue);function Ge(){var e,t=this.context,r=_(t).getInstance().log,i=d(t).getInstance(),a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,g=void 0,m=void 0,E=void 0,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,I=void 0,S=void 0;function N(e){!v&&e.fromStreamInfo&&void 0!==m[e.fromStreamInfo.id]&&(delete T[e.fromStreamInfo.id],delete m[e.fromStreamInfo.id])}function D(){var e=G(!0),t=v?e-y.start:0;return parseFloat((e+(y.duration-t)-w()).toFixed(5))}function O(){y&&f&&f.getElement()?f.play():R=!0}function C(){return y&&f?f.isPaused():null}function M(){y&&f&&f.pause()}function P(){return y&&f?f.isSeeking():null}function b(e){y&&f&&(i.trigger(p.PLAYBACK_SEEK_ASKED),r(\"Requesting seek to time: \"+e),f.setCurrentTime(e))}function w(){return y&&f?f.getTime():null}function L(){return y&&f?f.getPlaybackRate():null}function F(){return y&&f?f.getEnded():null}function x(){return v}function U(){0,h=NaN,g=null,R=!1,m={},E=0,S=0,T={},f&&(i.off(p.DATA_UPDATE_COMPLETED,Y,this),i.off(p.BUFFER_LEVEL_STATE_CHANGED,ie,this),i.off(p.BYTES_APPENDED_END_FRAGMENT,ne,this),i.off(p.PERIOD_SWITCH_STARTED,N,this),H(),f.removeEventListener(\"canplay\",q),f.removeEventListener(\"play\",W),f.removeEventListener(\"waiting\",Q),f.removeEventListener(\"playing\",K),f.removeEventListener(\"pause\",j),f.removeEventListener(\"error\",re),f.removeEventListener(\"seeking\",z),f.removeEventListener(\"seeked\",X),f.removeEventListener(\"timeupdate\",Z),f.removeEventListener(\"progress\",J),f.removeEventListener(\"ratechange\",$),f.removeEventListener(\"loadedmetadata\",ee),f.removeEventListener(\"ended\",te),f.removeEventListener(\"stalled\",ae)),\nf=null,y=null,v=null}function B(){var e=Be(t).getInstance().getURIFragmentData(),r=void 0;if(e){r={};var n=parseInt(e.r,10);n>=0&&y&&n<y.manifestInfo.DVRWindowSize&&null===e.t&&(e.t=Math.floor(Date.now()/1e3)-y.manifestInfo.DVRWindowSize+n),r.fragS=parseInt(e.s,10),r.fragT=parseInt(e.t,10)}return r}function G(e,t){var r=void 0,n=NaN,i=B();if(n=i?e?y.start:isNaN(i.fragS)?i.fragT:i.fragS:0,v)isNaN(n)||((r=n-y.manifestInfo.availableFrom.getTime()/1e3)>h||r<(isNaN(t)?NaN:t-y.manifestInfo.DVRWindowSize))&&(r=null),r=r||h;else if(!isNaN(n)&&n<Math.max(y.manifestInfo.duration,y.duration)&&n>=0)r=n;else{var a=m[y.id];r=void 0!==a?Math.max(void 0!==a.audio?a.audio:0,void 0!==a.video?a.video:0,y.start):y.start}return r}function k(){if(null===g){g=setInterval((function(){var e;i.trigger(p.WALLCLOCK_TIME_UPDATED,{isDynamic:v,time:new Date}),x()&&C()&&(e=Date.now(),(!I||e>I+500)&&(I=e,Z()))}),A.getWallclockTimeUpdateInterval())}}function H(){clearInterval(g),g=null}function V(){if(!C()&&v&&0!==f.getReadyState()){var e=w(),t=function(e){var t=o.getReadOnlyMetricsFor(n.VIDEO)||o.getReadOnlyMetricsFor(n.AUDIO),r=s.getCurrentDVRInfo(t),i=r?r.range:null,a=void 0;if(!i)return NaN;if(e>i.end)a=Math.max(i.end-2*y.manifestInfo.minBufferTime,i.start);else{if(!(e+.25<i.start))return e;a=i.start}return a}(e);!isNaN(t)&&t!==e&&b(t)}}function Y(e){if(!e.error){var t=c.convertDataToRepresentationInfo(e.currentRepresentation).mediaInfo.streamInfo;y.id===t.id&&(y=t,V())}}function q(){i.trigger(p.CAN_PLAY)}function W(){r(\"Native video element event: play\"),V(),k(),i.trigger(p.PLAYBACK_STARTED,{startTime:w()})}function Q(){r(\"Native video element event: waiting\"),i.trigger(p.PLAYBACK_WAITING,{playingTime:w()})}function K(){r(\"Native video element event: playing\"),i.trigger(p.PLAYBACK_PLAYING,{playingTime:w()})}function j(){r(\"Native video element event: pause\"),i.trigger(p.PLAYBACK_PAUSED,{ended:F()})}function z(){var e=w();r(\"Seeking to: \"+e),k(),i.trigger(p.PLAYBACK_SEEKING,{seekTime:e})}function X(){r(\"Native video element event: seeked\"),i.trigger(p.PLAYBACK_SEEKED)}function Z(){var e=w();e,i.trigger(p.PLAYBACK_TIME_UPDATED,{timeToEnd:D(),time:e})}function J(){i.trigger(p.PLAYBACK_PROGRESS)}function $(){var e=L();r(\"Native video element event: ratechange: \",e),i.trigger(p.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function ee(){r(\"Native video element event: loadedmetadata\"),i.trigger(p.PLAYBACK_METADATA_LOADED),k()}function te(){r(\"Native video element event: ended\"),M(),H(),i.trigger(p.PLAYBACK_ENDED,{isNativeEnded:!0})}function re(e){var t=e.target||e.srcElement;i.trigger(p.PLAYBACK_ERROR,{error:t.error})}function ne(e){var t,r=void 0,n=e.bufferedRanges;if(n&&n.length&&(!m[y.id]||!0!==m[y.id].started)){var i=e.sender.getType();void 0===T[y.id]&&(T[y.id]=[]),T[y.id][i]=n,void 0===m[y.id]&&(m[y.id]=[],m[y.id].started=!1),void 0===m[y.id][i]&&(m[y.id][i]=Math.max(n.start(0),y.start));var o=a.isVideoTrackPresent(),s=a.isAudioTrackPresent();t=G(!1),s&&o?isNaN(m[y.id].audio)||isNaN(m[y.id].video)||(m[y.id].audio<m[y.id].video?(r=m[y.id].video>t?m[y.id].video:t,n=T[y.id].audio):(r=m[y.id].audio>t?m[y.id].audio:t,n=T[y.id].video),function(e,t){if(t&&t.length>0)for(var r=0,n=t.length;r<n;r++)if(e>=t.start(r)&&e<t.end(r))return!0;return!1}(r,n)&&(P()||0===r||b(r),m[y.id].started=!0)):m[y.id][i]&&(r=m[y.id][i]>t?m[y.id][i]:t,P()||b(r),m[y.id].started=!0)}}function ie(e){e.streamInfo.id===y.id&&f.setStallState(e.mediaType,e.state===Fe.BUFFER_EMPTY)}function ae(e){r(\"Native video element event: stalled\",e),i.trigger(p.PLAYBACK_STALLED,{e:e})}return e={initialize:function(e){y=e,f.addEventListener(\"canplay\",q),f.addEventListener(\"play\",W),f.addEventListener(\"waiting\",Q),f.addEventListener(\"playing\",K),f.addEventListener(\"pause\",j),f.addEventListener(\"error\",re),f.addEventListener(\"seeking\",z),f.addEventListener(\"seeked\",X),f.addEventListener(\"timeupdate\",Z),f.addEventListener(\"progress\",J),f.addEventListener(\"ratechange\",$),f.addEventListener(\"loadedmetadata\",ee),f.addEventListener(\"ended\",te),f.addEventListener(\"stalled\",ae),v=y.manifestInfo.isDynamic,\nh=y.start,i.on(p.DATA_UPDATE_COMPLETED,Y,this),i.on(p.BYTES_APPENDED_END_FRAGMENT,ne,this),i.on(p.BUFFER_LEVEL_STATE_CHANGED,ie,this),i.on(p.PERIOD_SWITCH_STARTED,N,this),R&&(R=!1,O())},setConfig:function(e){e&&(e.streamController&&(a=e.streamController),e.metricsModel&&(o=e.metricsModel),e.dashMetrics&&(s=e.dashMetrics),e.manifestModel&&(u=e.manifestModel),e.dashManifestModel&&(l=e.dashManifestModel),e.mediaPlayerModel&&(A=e.mediaPlayerModel),e.adapter&&(c=e.adapter),e.videoModel&&(f=e.videoModel))},getStartTimeFromUriParameters:B,getStreamStartTime:G,getTimeToStreamEnd:D,getTime:w,getPlaybackRate:L,getPlayedRanges:function(){return y&&f?f.getPlayedRanges():null},getEnded:F,getIsDynamic:x,getStreamController:function(){return a},setLiveStartTime:function(e){h=e},getLiveStartTime:function(){return h},computeLiveDelay:function(e,t){var r=l.getMpd(u.getValue()),i=void 0,a=void 0;if(i=A.getUseSuggestedPresentationDelay()&&r.hasOwnProperty(n.SUGGESTED_PRESENTATION_DELAY)?r.suggestedPresentationDelay:A.getLowLatencyEnabled()?0:A.getLiveDelay()?A.getLiveDelay():isNaN(e)?2*y.manifestInfo.minBufferTime:e*A.getLiveDelayFragmentCount(),r.availabilityStartTime&&(S=r.availabilityStartTime.getTime()),t>0){var o=Math.max(t-10,t/2);a=Math.min(i,o)}else a=i;return E=a,a},getLiveDelay:function(){return E},getCurrentLiveLatency:function(){if(!v||isNaN(S))return NaN;var e=w();return isNaN(e)||0===e?0:(Math.round((new Date).getTime()-(1e3*e+S))/1e3).toFixed(3)},play:O,isPaused:C,pause:M,isSeeking:P,seek:b,reset:U},U(),e}Ge.__dashjs_factory_name=\"PlaybackController\";var ke=s.a.getSingletonFactory(Ge);function He(e){var t=(e=e||{}).timelineConverter,r=e.streamProcessor;return{getLiveEdge:function(){!function(){if(!(t&&t.hasOwnProperty(\"getExpectedLiveEdge\")&&r&&r.hasOwnProperty(\"getCurrentRepresentationInfo\")))throw new Error(\"Missing config parameter(s)\")}();var e=r.getCurrentRepresentationInfo(),n=e.DVRWindow.end;return e.useCalculatedLiveEdgeTime&&(n=t.getExpectedLiveEdge(),t.setClientTimeOffset(n-e.DVRWindow.end)),n},reset:function(){t=null,r=null}}}He.__dashjs_factory_name=\"LiveEdgeFinder\";var Ve=s.a.getClassFactory(He);function Ye(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var qe=function e(){Ye(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};qe.INITIAL_PLAYOUT_START_REASON=\"initial_playout\",qe.SEEK_START_REASON=\"seek\",qe.RESUME_FROM_PAUSE_START_REASON=\"resume\",qe.METRICS_COLLECTION_START_REASON=\"metrics_collection_start\";var We=function e