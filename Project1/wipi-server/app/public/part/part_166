(){Ye(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};function Qe(e){var t=(e=e||{}).dashMetrics,r=e.metricsModel,i=e.mediaPlayerModel,a=e.abrController;function o(e,o,s){var u=NaN,l=e.getCurrentRepresentationInfo();if(o===n.FRAGMENTED_TEXT);else if(o===n.AUDIO&&s){var d=t.getCurrentBufferLevel(r.getReadOnlyMetricsFor(n.VIDEO));u=isNaN(l.fragmentDuration)?d:Math.max(d,l.fragmentDuration)}else{var c=l.mediaInfo.streamInfo;if(a.isPlayingAtTopQuality(c))u=c.manifestInfo.duration>=i.getLongFormContentDurationThreshold()?i.getBufferTimeAtTopQualityLongForm():i.getBufferTimeAtTopQuality();else u=i.getStableBufferTime()}return u}return{execute:function(e,n,i){return t.getCurrentBufferLevel(r.getReadOnlyMetricsFor(n))<o(e,n,i)},getBufferTarget:o}}We.REPRESENTATION_SWITCH_STOP_REASON=\"representation_switch\",We.REBUFFERING_REASON=\"rebuffering\",We.USER_REQUEST_STOP_REASON=\"user_request\",We.END_OF_PERIOD_STOP_REASON=\"end_of_period\",We.END_OF_CONTENT_STOP_REASON=\"end_of_content\",We.METRICS_COLLECTION_STOP_REASON=\"metrics_collection_end\",We.FAILURE_STOP_REASON=\"failure\",Qe.__dashjs_factory_name=\"BufferLevelRule\";var Ke=s.a.getClassFactory(Qe);function je(e){e=e||{};var t=this.context,r=_(t).getInstance().log,n=e.adapter;return{execute:function(e,t){var i=e.getCurrentRepresentationInfo(),a=i.mediaInfo.type,o=e.getScheduleController(),s=o.getSeekTarget(),u=!isNaN(s),l=e.getBufferController(),d=u?s:n.getIndexHandlerTime(e);if(isNaN(d))return null\n;if(u&&o.setSeekTarget(NaN),l){var c=l.getRangeAt(d);null===c||u||(r(\"Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end for\",a,\".\",d,\"was changed to\",c.end),d=c.end)}var f=void 0;if(t)d=t.startTime+t.duration/2,f=n.getFragmentRequestForTime(e,i,d,{timeThreshold:0,ignoreIsFinished:!0});else{for(f=n.getFragmentRequestForTime(e,i,d,{keepIdx:!u});f&&f.action!==m.ACTION_COMPLETE&&e.getFragmentModel().isFragmentLoaded(f);)f=n.getNextFragmentRequest(e,i);f&&(isNaN(f.startTime+f.duration)||n.setIndexHandlerTime(e,f.startTime+f.duration),f.delayLoadingTime=(new Date).getTime()+o.getTimeToLoadDelay(),o.setTimeToLoadDelay(0))}return f}}}je.__dashjs_factory_name=\"NextFragmentRequestRule\";var ze=s.a.getClassFactory(je);function Xe(e){e=e||{};var t=this.context,r=d(t).getInstance(),i=e.metricsModel,a=e.adapter,o=e.dashMetrics,s=e.dashManifestModel,u=e.timelineConverter,l=e.mediaPlayerModel,c=e.abrController,f=e.playbackController,h=e.streamController,g=e.type,m=e.streamProcessor,E=e.mediaController,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,S=void 0,N=void 0,D=void 0,O=void 0,C=void 0,M=void 0,P=void 0,b=void 0,w=void 0,L=void 0,F=void 0,x=void 0,U=void 0,B=void 0,G=void 0,k=void 0,H=void 0,V=void 0,Y=void 0,q={video:-1,audio:-1};function W(){A&&!m.isBufferingCompleted()?(y(\"[ScheduleController][\",g,\"] start\"),Ie(),S=!1,R&&(R=!1),Z(!1),z(0)):y(\"[ScheduleController][\",g,\"] start denied\")}function Q(){S||(y(\"[ScheduleController][\",g,\"] stop\"),S=!0,clearTimeout(P))}function K(e,t){U[t]=U[t]||{};var r=c.getTopQualityIndexFor(e,t);return U[t][e]!=r&&(y(\"Top quality \"+e+\" index has changed from \"+U[t][e]+\" to \"+r),U[t][e]=r,!0)}function j(){var e=m.getBufferController();if(S||C||f.isPaused()&&!F)y(\"[ScheduleController][\",g,\"] - schedule stop!\");else if(e.getIsBufferingCompleted())y(\"Schedule stop because buffering is completed!\");else{!function(){var e=1.5*(A.fragmentDuration||5),t=v.getRequests({state:I.FRAGMENT_MODEL_EXECUTED,time:f.getTime()+e,threshold:0})[0];if(t&&-1===G.indexOf(t)&&!s.getIsTextTrack(g)){var r=l.getFastSwitchEnabled(),n=m.getBufferLevel(),i=c.getAbandonmentStateFor(g);t.mediaType&&c.setCurrentSegmentInfoFor(t.mediaType,{index:t.index,startTime:t.startTime,duration:t.duration,url:t.url});var a=!E.isCurrentTrack(t.mediaInfo)&&E.getSwitchMode(t.mediaInfo.type)===me.TRACK_SWITCH_MODE_NEVER_REPLACE,o=t.quality!==A.quality;r&&(a||o)&&n>=e&&i!==ue.ABANDON_LOAD?(ee(t),y(\"Reloading outdated fragment at index: \",t.index)):t.quality>A.quality&&(y(\"The buffer has better quality it in then what we would request so set append point to end of buffer!!\"),ve(f.getTime()+m.getBufferLevel()))}}();var t=G.length>0,n=m.getStreamInfo();if(H||isNaN(B)||k||t||K(A.mediaInfo.type,n.id)||w.execute(m,g,h.isVideoTrackPresent())){Z(!0),t||k||c.checkPlaybackQuality(g),function(){r.trigger(p.GET_NEXT_FRAGMENT,{mediaType:g,currentTime:m.getPlaybackController().getTime(),bufferLevel:m.getBufferLevel(),bufferResetInProgress:H,lastInitQuality:isNaN(B),switchTrack:k,isReplacement:t,hasTopQualityChanged:K(A.mediaInfo.type,n.id),bufferLevelRule:w.execute(m,g,h.isVideoTrackPresent()),final:H||isNaN(B)||k||t||K(A.mediaInfo.type,n.id)||w.execute(m,g,h.isVideoTrackPresent())});var e=m.getFragmentController();if(A.quality!==B)y(\"ScheduleController - \"+g+\" - quality has changed, get init request for representationid = \"+A.id),B=A.quality,m.switchInitData(A.id);else if(k)y(\"ScheduleController - \"+g+\" - switch track has been asked, get init request for \"+g+\" with representationid = \"+A.id),H=E.getSwitchMode(g)===me.TRACK_SWITCH_MODE_ALWAYS_REPLACE,m.switchInitData(A.id,H),B=A.quality,k=!1;else{var i=G.shift();if(e.isInitializationRequest(i))m.switchInitData(i.representationId);else{var a=void 0;m.getBufferController().getIsPruningInProgress()||!(a=L.execute(m,i))&&n.manifestInfo&&n.manifestInfo.isDynamic&&y(\"getNextFragment - \"+g+\" - Playing at the bleeding live edge and frag is not available yet\"),a?(y(\"ScheduleController - \"+g+\" - getNextFragment - request is \"+a.url),\nv.executeRequest(a)):(Z(!1),z(500))}}}()}else z(500)}}function z(e){clearTimeout(P),P=setTimeout(j,e)}function X(e){e.sender&&e.sender.getStreamProcessor()===m&&J(A.quality)}function Z(e){C!==e?C=e:y(\"[ScheduleController][\",g,\"] isFragmentProcessingInProgress is already equal to\",e)}function J(e){var t=a.getInitRequest(m,e);t&&(t.mediaType&&c.setCurrentSegmentInfoFor(t.mediaType,{index:t.index,startTime:t.startTime,duration:t.duration,url:t.url}),Z(!0),v.executeRequest(t))}function $(){k=!0}function ee(e){G.push(e)}function te(e){if(g===e.mediaType&&m.getStreamInfo().id===e.streamInfo.id){if(null==(A=m.getRepresentationInfoForQuality(e.newQuality)))throw new Error(\"Unexpected error! - currentRepresentationInfo is null or undefined\");q[g]=e.newQuality,Re(new Date,We.REPRESENTATION_SWITCH_STOP_REASON),Ie(),f.isPaused()&&(Y={type:g,oldQuality:e.oldQuality})}}function re(e){if(f&&v){var t=v.getRequests({state:I.FRAGMENT_MODEL_EXECUTED,time:f.getTime(),threshold:0})[0];t&&f.getTime()>=t.startTime&&((!x.mediaInfo||t.mediaInfo.type===x.mediaInfo.type&&t.mediaInfo.id!==x.mediaInfo.id)&&e&&r.trigger(p.TRACK_CHANGE_RENDERED,{mediaType:g,oldMediaInfo:x.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===x.quality&&t.adaptationIndex===x.adaptationIndex||!e||q[g]===t.quality&&(r.trigger(p.QUALITY_CHANGE_RENDERED,{mediaType:g,oldQuality:x.quality,newQuality:t.quality}),q[g]=-1,Y=null),x={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function ne(e){e.error||e.sender.getStreamProcessor()!==m||(A=a.convertDataToRepresentationInfo(e.currentRepresentation),l.getAppendingSourceState()&&$())}function ie(e){e.error||m.getStreamInfo().id!==e.streamInfo.id||(A=m.getCurrentRepresentationInfo(),R&&(f.getIsDynamic()?(u.setTimeSyncCompleted(!0),function(){var e=m.getLiveEdgeFinder();if(e){var t=e.getLiveEdge(),r=A.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,s=t-f.computeLiveDelay(A.fragmentDuration,r),d=a.getFragmentRequestForTime(m,A,s,{ignoreIsFinished:!0});if(l.getLowLatencyEnabled()){var c=d.duration<l.getLiveDelay()?d.startTime:d.startTime+d.duration-l.getLiveDelay();f.setLiveStartTime(c)}else f.setLiveStartTime(d.startTime);(b=f.getStreamStartTime(!1,t))>A.mediaInfo.streamInfo.start+A.mediaInfo.streamInfo.duration&&f.seek(b);var h=o.getCurrentManifestUpdate(i.getMetricsFor(n.STREAM));i.updateManifestUpdateInfo(h,{currentTime:b,presentationStartTime:t,latency:t-b,clientTimeOffset:u.getClientTimeOffset()})}}()):(b=f.getStreamStartTime(!1),m.getBufferController().setSeekStartTime(b))),S&&W())}function ae(e){e.fragmentModel===v&&(Q(),Z(!1),y(\"[ScheduleController] Stream is complete\"),l.getAppendingSourceState()&&W())}function oe(e){e.sender===v&&(y(\"[ScheduleController][\",g,\"] - onFragmentLoadingCompleted\"),s.getIsTextTrack(g)&&Z(!1),e.error&&e.request.serviceLocation&&!S&&Z(!1),H&&(V=e.request),f.isPaused()&&Y&&e.request.quality===q[g]&&(r.trigger(p.QUALITY_CHANGE_RENDERED,{mediaType:g,oldQuality:x.quality||Y.oldQuality,newQuality:e.request.quality}),q[g]=-1,Y=null))}function se(){re(!0)}function le(e){e.sender.getStreamProcessor()===m&&(H&&!isNaN(e.startTime)&&(H=!1,v.addExecutedRequest(V)),Z(!1),z(0))}function de(e){e.streamProcessor===m&&(y(\"[ScheduleController][onFragmentLoadingAbandoned] for \"+g+\", request: \"+e.request.url+\" has been aborted\"),f.isSeeking()||k||(y(\"[ScheduleController][onFragmentLoadingAbandoned] for \"+g+\", request: \"+e.request.url+\" has to be downloaded again, origin is not seeking process or switch track call\"),ee(e.request)),Z(!1),z(0))}function ce(e){e.sender.getStreamProcessor()===m&&Q()}function fe(e){e.sender.getStreamProcessor()===m&&(e.unintended?m.getFragmentModel().removeExecutedRequestsAfterTime(e.from,m.getStreamInfo().duration):m.getFragmentModel().syncExecutedRequestsWithBufferedRange(m.getBufferController().getBuffer().getAllBufferRanges(),m.getStreamInfo().duration),e.hasEnoughSpaceToAppend&&S&&W())}function he(e){e.sender.getStreamProcessor()!==m||e.state!==Fe.BUFFER_EMPTY||f.isSeeking()||(y(\"[ScheduleController][\",g,\"] - Buffer is empty! Stalling!\"),\nRe(new Date,We.REBUFFERING_REASON))}function pe(e){e.sender.getStreamProcessor()===m&&(Q(),Z(!1))}function ge(){v.abortRequests(),Q()}function Ee(e){e.sender.getStreamProcessor()===m&&J(e.index)}function _e(){!S&&F||W()}function Te(e){b=e.seekTime,Ae(0),S&&W();var t=o.getCurrentManifestUpdate(i.getMetricsFor(n.STREAM)),r=A.DVRWindow&&f?A.DVRWindow.end-f.getTime():NaN;i.updateManifestUpdateInfo(t,{latency:r}),C?(y(\"[ScheduleController][onPlaybackSeeking] for \"+g+\", call fragmentModel.abortRequests in order to seek quicker\"),v.abortRequests(),q[g]>=0&&(a.setIndexHandlerTime(m,b),m.switchInitData(A.id)),Z(!1),z(500)):z(0)}function ye(e){D&&(D.playbackspeed=e.playbackRate.toString())}function ve(e){b=e}function Ae(e){M=e}function Re(e,t){if(N&&!1===O){var r=D.start,n=e.getTime()-r.getTime();D.duration=n,D.stopreason=t,N.trace.push(D),O=!0}}function Ie(){N&&!0===O&&A&&(O=!1,(D=new We).representationid=A.id,D.start=new Date,D.mstart=1e3*f.getTime(),D.playbackspeed=f.getPlaybackRate().toString())}function Se(){B=NaN}function Ne(){C=!1,M=0,b=NaN,N=null,D=null,O=!0,R=!0,B=NaN,x={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},U={},G=[],S=!0,k=!1,H=!1,V=null}return T={initialize:function(){v=m.getFragmentModel(),F=l.getScheduleWhilePaused(),w=Ke(t).create({abrController:c,dashMetrics:o,metricsModel:i,mediaPlayerModel:l}),L=ze(t).create({adapter:a}),s.getIsTextTrack(g)&&r.on(p.TIMED_TEXT_REQUESTED,Ee,this),r.on(p.QUALITY_CHANGE_REQUESTED,te,this),r.on(p.DATA_UPDATE_STARTED,ce,this),r.on(p.DATA_UPDATE_COMPLETED,ne,this),r.on(p.FRAGMENT_LOADING_COMPLETED,oe,this),r.on(p.STREAM_COMPLETED,ae,this),r.on(p.STREAM_INITIALIZED,ie,this),r.on(p.BUFFER_LEVEL_STATE_CHANGED,he,this),r.on(p.BUFFER_CLEARED,fe,this),r.on(p.BYTES_APPENDED_END_FRAGMENT,le,this),r.on(p.INIT_REQUESTED,X,this),r.on(p.QUOTA_EXCEEDED,pe,this),r.on(p.PLAYBACK_SEEKING,Te,this),r.on(p.PLAYBACK_STARTED,_e,this),r.on(p.PLAYBACK_RATE_CHANGED,ye,this),r.on(p.PLAYBACK_TIME_UPDATED,se,this),r.on(p.URL_RESOLUTION_FAILED,ge,this),r.on(p.FRAGMENT_LOADING_ABANDONED,de,this),r.on(p.MANIFEST_UPDATED,Se,this)},getType:function(){return g},getSeekTarget:function(){return b},setSeekTarget:ve,setTimeToLoadDelay:Ae,getTimeToLoadDelay:function(){return M},replaceRequest:ee,switchTrackAsked:$,isStarted:function(){return!1===S},start:W,stop:Q,reset:function(){r.off(p.DATA_UPDATE_STARTED,ce,this),r.off(p.DATA_UPDATE_COMPLETED,ne,this),r.off(p.BUFFER_LEVEL_STATE_CHANGED,he,this),r.off(p.QUALITY_CHANGE_REQUESTED,te,this),r.off(p.FRAGMENT_LOADING_COMPLETED,oe,this),r.off(p.STREAM_COMPLETED,ae,this),r.off(p.STREAM_INITIALIZED,ie,this),r.off(p.QUOTA_EXCEEDED,pe,this),r.off(p.BYTES_APPENDED_END_FRAGMENT,le,this),r.off(p.BUFFER_CLEARED,fe,this),r.off(p.INIT_REQUESTED,X,this),r.off(p.PLAYBACK_RATE_CHANGED,ye,this),r.off(p.PLAYBACK_SEEKING,Te,this),r.off(p.PLAYBACK_STARTED,_e,this),r.off(p.PLAYBACK_TIME_UPDATED,se,this),r.off(p.URL_RESOLUTION_FAILED,ge,this),r.off(p.FRAGMENT_LOADING_ABANDONED,de,this),r.off(p.MANIFEST_UPDATED,Se,this),s.getIsTextTrack(g)&&r.off(p.TIMED_TEXT_REQUESTED,Ee,this),Q(),re(!1),Ne()},setPlayList:function(e){N=e},getBufferTarget:function(){return w.getBufferTarget(m,g,h.isVideoTrackPresent())},finalisePlayList:function(e,t){Re(e,t),N=null}},y=_(t).getInstance().log.bind(T),Ne(),T}Xe.__dashjs_factory_name=\"ScheduleController\";var Ze=s.a.getClassFactory(Xe);var Je=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.init()}return e.prototype.init=function(){this.BASE_URL=\"BaseURL\",this.SEGMENT_BASE=\"SegmentBase\",this.SEGMENT_TEMPLATE=\"SegmentTemplate\",this.SEGMENT_LIST=\"SegmentList\",this.SEGMENT_URL=\"SegmentURL\",this.SEGMENT_TIMELINE=\"SegmentTimeline\",this.SEGMENT_PROFILES=\"segmentProfiles\",this.ADAPTATION_SET=\"AdaptationSet\",this.REPRESENTATION=\"Representation\",this.REPRESENTATION_INDEX=\"RepresentationIndex\",this.SUB_REPRESENTATION=\"SubRepresentation\",this.INITIALIZATION=\"Initialization\",this.INITIALIZATION_MINUS=\"initialization\",this.MPD=\"MPD\",this.PERIOD=\"Period\",\nthis.ASSET_IDENTIFIER=\"AssetIdentifier\",this.EVENT_STREAM=\"EventStream\",this.ID=\"id\",this.PROFILES=\"profiles\",this.SERVICE_LOCATION=\"serviceLocation\",this.RANGE=\"range\",this.INDEX=\"index\",this.MEDIA=\"media\",this.BYTE_RANGE=\"byteRange\",this.INDEX_RANGE=\"indexRange\",this.MEDIA_RANGE=\"mediaRange\",this.VALUE=\"value\",this.CONTENT_TYPE=\"contentType\",this.MIME_TYPE=\"mimeType\",this.BITSTREAM_SWITCHING=\"BitstreamSwitching\",this.BITSTREAM_SWITCHING_MINUS=\"bitstreamSwitching\",this.CODECS=\"codecs\",this.DEPENDENCY_ID=\"dependencyId\",this.MEDIA_STREAM_STRUCTURE_ID=\"mediaStreamStructureId\",this.METRICS=\"Metrics\",this.METRICS_MINUS=\"metrics\",this.REPORTING=\"Reporting\",this.WIDTH=\"width\",this.HEIGHT=\"height\",this.SAR=\"sar\",this.FRAMERATE=\"frameRate\",this.AUDIO_SAMPLING_RATE=\"audioSamplingRate\",this.MAXIMUM_SAP_PERIOD=\"maximumSAPPeriod\",this.START_WITH_SAP=\"startWithSAP\",this.MAX_PLAYOUT_RATE=\"maxPlayoutRate\",this.CODING_DEPENDENCY=\"codingDependency\",this.SCAN_TYPE=\"scanType\",this.FRAME_PACKING=\"FramePacking\",this.AUDIO_CHANNEL_CONFIGURATION=\"AudioChannelConfiguration\",this.CONTENT_PROTECTION=\"ContentProtection\",this.ESSENTIAL_PROPERTY=\"EssentialProperty\",this.SUPPLEMENTAL_PROPERTY=\"SupplementalProperty\",this.INBAND_EVENT_STREAM=\"InbandEventStream\",this.ACCESSIBILITY=\"Accessibility\",this.ROLE=\"Role\",this.RATING=\"Rating\",this.CONTENT_COMPONENT=\"ContentComponent\",this.SUBSET=\"Subset\",this.LANG=\"lang\",this.VIEWPOINT=\"Viewpoint\",this.ROLE_ASARRAY=\"Role_asArray\",this.ACCESSIBILITY_ASARRAY=\"Accessibility_asArray\",this.AUDIOCHANNELCONFIGURATION_ASARRAY=\"AudioChannelConfiguration_asArray\",this.CONTENTPROTECTION_ASARRAY=\"ContentProtection_asArray\",this.MAIN=\"main\",this.DYNAMIC=\"dynamic\",this.INTERACTIVE=\"interactive\",this.MEDIA_PRESENTATION_DURATION=\"mediaPresentationDuration\",this.MINIMUM_UPDATE_PERIOD=\"minimumUpdatePeriod\",this.CODEC_PRIVATE_DATA=\"codecPrivateData\",this.BANDWITH=\"bandwidth\",this.SOURCE_URL=\"sourceURL\",this.TIMESCALE=\"timescale\",this.DURATION=\"duration\",this.START_NUMBER=\"startNumber\",this.PRESENTATION_TIME_OFFSET=\"presentationTimeOffset\",this.AVAILABILITY_START_TIME=\"availabilityStartTime\",this.AVAILABILITY_END_TIME=\"availabilityEndTime\",this.TIMESHIFT_BUFFER_DEPTH=\"timeShiftBufferDepth\",this.MAX_SEGMENT_DURATION=\"maxSegmentDuration\",this.PRESENTATION_TIME=\"presentationTime\",this.MIN_BUFFER_TIME=\"minBufferTime\",this.MAX_SUBSEGMENT_DURATION=\"maxSubsegmentDuration\",this.START=\"start\",this.AVAILABILITY_TIME_OFFSET=\"availabilityTimeOffset\",this.AVAILABILITY_TIME_COMPLETE=\"availabilityTimeComplete\",this.CENC_DEFAULT_KID=\"cenc:default_KID\",this.DVB_PRIORITY=\"dvb:priority\",this.DVB_WEIGHT=\"dvb:weight\"},e}());var $e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return e.hasInitialization=function(e){return null!==e.initialization||null!==e.range},e.hasSegments=function(e){return e.segmentInfoType!==Je.BASE_URL&&e.segmentInfoType!==Je.SEGMENT_BASE&&!e.indexRange},e}();function et(){var e=this.context,t=d(e).getInstance(),r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,g=void 0,m=void 0,E=void 0,_=void 0,T=void 0,y=void 0,v=[];function A(){return o}function R(){return u}function I(){i=null,a=-1,o=!0,s=[],l=null,f=null,h=null,g=null,m=null,E=null,_=null}function N(){var e=new Date,t=R(),r=1e3*f.getTime();h.addRepresentationSwitch(t.adaptation.type,e,r,t.id)}function D(){var e=T.getStreamInfo(),t=e?e.manifestInfo:null,r=t?t.isDynamic:null,n=m.calcSegmentAvailabilityRange(u,r)\n;h.addDVRInfo(T.getType(),f.getTime(),t,n)}function O(e){return s[e]}function C(e){return s.indexOf(e)}function M(e){var n=e;o=!1,t.trigger(p.AST_IN_FUTURE,{delay:n}),setTimeout((function(){if(!A()){o=!0,t.trigger(p.DATA_UPDATE_STARTED,{sender:r}),s.forEach((function(e){e.segmentAvailabilityRange=null}));for(var e=0;e<s.length;e++)c.updateRepresentation(s[e],!0)}}),n)}function P(e){if(e.sender.getStreamProcessor()===T&&A()){var r=e.representation,a=h.getMetricsFor(n.STREAM),d=R().adaptation.type,c=h.getMetricsFor(R().adaptation.type),g=_.getCurrentManifestUpdate(a),m=!1,E=0,y=void 0,v=void 0;if(r.adaptation.period.mpd.manifest.type===Je.DYNAMIC&&!r.adaptation.period.mpd.manifest.ignorePostponeTimePeriod){var I=r.segmentAvailabilityRange.end-r.segmentAvailabilityRange.start;E=1e3*(f.computeLiveDelay(u.segmentDuration,T.getStreamInfo().manifestInfo.DVRWindowSize)-I)}if(E>0)return D(),M(E),v=new S(1,\"Segments update failed\",null),void t.trigger(p.DATA_UPDATE_COMPLETED,{sender:this,data:i,currentRepresentation:u,error:v});if(g){for(var O=0;O<g.representationInfo.length;O++)if((y=g.representationInfo[O]).index===r.index&&y.mediaType===T.getType()){m=!0;break}m||h.addManifestUpdateRepresentationInfo(g,r.id,r.index,r.adaptation.period.index,T.getType(),r.presentationTimeOffset,r.startNumber,r.segmentInfoType)}(function(e){var t=l.getQualityFor(e),r=T.getStreamInfo(),n=l.getTopQualityIndexFor(e,r.id),i=l.getMinAllowedIndexFor(e);void 0!==i&&t<i&&(t=i),t>n&&(t=n);for(var a=t;a<1;a++){var o=s[a].segmentInfoType;if(null===s[a].segmentAvailabilityRange||!$e.hasInitialization(s[a])||(o===Je.SEGMENT_BASE||o===Je.BASE_URL)&&!s[a].segments)return!1}return!0})(d)&&(o=!1,l.setPlaybackQuality(T.getType(),T.getStreamInfo(),C(u)),h.updateManifestUpdateInfo(g,{latency:u.segmentAvailabilityRange.end-f.getTime()}),_.getCurrentRepresentationSwitch(c)||N(),t.trigger(p.DATA_UPDATE_COMPLETED,{sender:this,data:i,currentRepresentation:u}))}}function b(e){e.isDynamic&&function(e){for(var t=void 0,r=0,n=s.length;r<n;r++)(t=s[r]).segmentAvailabilityRange=m.calcSegmentAvailabilityRange(t,e)}(e.isDynamic)}function w(e){e.sender.getStreamProcessor()===T&&(y.getValue().doNotUpdateDVRWindowOnBufferUpdated||D())}function L(e){if(e.mediaType===T.getType()&&T.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality){var t=e.newQuality;v[t]||(v[t]=!0,c.updateRepresentation(s[t],!0)),u=O(e.newQuality);var r=l.getThroughputHistory().getAverageThroughput(e.mediaType);isNaN(r)||g.setSavedBitrateSettings(e.mediaType,r),N()}}function F(e){if(e.newDuration){var t=R();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return r={initialize:function(){c=T.getIndexHandler()},setConfig:function(e){e.abrController&&(l=e.abrController),e.domStorage&&(g=e.domStorage),e.metricsModel&&(h=e.metricsModel),e.dashMetrics&&(_=e.dashMetrics),e.dashManifestModel&&(E=e.dashManifestModel),e.playbackController&&(f=e.playbackController),e.timelineConverter&&(m=e.timelineConverter),e.manifestModel&&(y=e.manifestModel),e.streamProcessor&&(T=e.streamProcessor)},getData:function(){return i},getDataIndex:function(){return a},isUpdating:A,updateData:function(e,r,d){var f=T.getStreamInfo(),h=l.getTopQualityIndexFor(d,f.id),g=l.getMinAllowedIndexFor(d),m=void 0;if(o=!0,t.trigger(p.DATA_UPDATE_STARTED,{sender:this}),s=function(e){return a=E.getIndexForAdaptation(i,e.period.mpd.manifest,e.period.index),E.getRepresentationsForAdaptation(e)}(r),null!==i&&i.id==e.id||d===n.FRAGMENTED_TEXT||(l.getThroughputHistory().getAverageThroughput(d)||l.getInitialBitrateFor(d,f)),m=l.getQualityFor(d),void 0!==g&&m<g&&(m=g),m>h&&(m=h),u=O(m),i=e,d!==n.VIDEO&&d!==n.AUDIO&&d!==n.FRAGMENTED_TEXT)return o=!1,void t.trigger(p.DATA_UPDATE_COMPLETED,{sender:this,data:i,currentRepresentation:u});(v=[])[m]=!0,c.updateRepresentation(s[m],!0)},getStreamProcessor:function(){return T},getCurrentRepresentation:R,getRepresentationForQuality:O,getQualityForRepresentationId:function(e){return C(s.find((function(t){return t.id===e})))},reset:function(){t.off(p.QUALITY_CHANGE_REQUESTED,L,r),\nt.off(p.REPRESENTATION_UPDATED,P,r),t.off(p.WALLCLOCK_TIME_UPDATED,b,r),t.off(p.BUFFER_LEVEL_UPDATED,w,r),t.off(p.MANIFEST_VALIDITY_CHANGED,F,r),I(),v=[]}},I(),t.on(p.QUALITY_CHANGE_REQUESTED,L,r),t.on(p.REPRESENTATION_UPDATED,P,r),t.on(p.WALLCLOCK_TIME_UPDATED,b,r),t.on(p.BUFFER_LEVEL_UPDATED,w,r),t.on(p.MANIFEST_VALIDITY_CHANGED,F,r),r}et.__dashjs_factory_name=\"RepresentationController\";var tt=s.a.getClassFactory(et);function rt(){var e=void 0,t=/^[a-z][a-z0-9+\\-.]*:/i,r=/^https?:\\/\\//i,n=/^https:\\/\\//i,i=/^([a-z][a-z0-9+\\-.]*:\\/\\/[^\\/]+)\\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var r=s;if(!t)return e;if(!d(e))return e;c(e)&&(r=u),f(e)&&(r=l);var n=r(t),i=\"/\"!==n.charAt(n.length-1)&&\"/\"!==e.charAt(0)?\"/\":\"\";return[n,e].join(i)};function s(e){var t=e.indexOf(\"/\"),r=e.lastIndexOf(\"/\");return-1!==t?r===t+1?e:(-1!==e.indexOf(\"?\")&&(e=e.substring(0,e.indexOf(\"?\"))),e.substring(0,r+1)):\"\"}function u(e){var t=e.match(i);return t?t[1]:\"\"}function l(e){var r=e.match(t);return r?r[0]:\"\"}function d(e){return!t.test(e)}function c(e){return d(e)&&\"/\"===e.charAt(0)}function f(e){return 0===e.indexOf(\"//\")}return function(){try{new window.URL(\"x\",\"http://y\");e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:d,isPathAbsolute:c,isSchemeRelative:f,isHTTPURL:function(e){return r.test(e)},isHTTPS:function(e){return n.test(e)},resolve:function(t,r){return e(t,r)}}}rt.__dashjs_factory_name=\"URLUtils\";var nt=s.a.getSingletonFactory(rt);var it=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};function at(e,t){for(;e.length<t;)e=\"0\"+e;return e}function ot(e,t){return e.representation.startNumber+t}function st(e,t,r){var n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=t.length,d=\"%0\".length;if(!e)return e;for(;;){if((n=e.indexOf(\"$\"+t))<0)return e;if((i=e.indexOf(\"$\",n+l))<0)return e;if((a=e.indexOf(\"%0\",n+l))>n&&a<i)switch(o=e.charAt(i-1),s=parseInt(e.substring(a+d,i-1),10),o){case\"d\":case\"i\":case\"u\":u=at(r.toString(),s);break;case\"x\":u=at(r.toString(16),s);break;case\"X\":u=at(r.toString(16),s).toUpperCase();break;case\"o\":u=at(r.toString(8),s);break;default:return e}else u=r;e=e.substring(0,n)+u+e.substring(i+1)}}function ut(e,t,r,n){var i,a,o=void 0,s=void 0;return s=r.segmentDuration,isNaN(s)&&(s=r.adaptation.period.duration),i=parseFloat((r.adaptation.period.start+n*s).toFixed(5)),a=parseFloat((i+s).toFixed(5)),(o=new it).representation=r,o.duration=s,o.presentationStartTime=i,o.mediaStartTime=e.calcMediaTimeFromPresentationTime(o.presentationStartTime,r),o.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(o.presentationStartTime,r.adaptation.period.mpd,t),o.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(a,r.adaptation.period.mpd,t),o.wallStartTime=e.calcWallTimeForSegment(o,t),o.replacementNumber=ot(o,n),o.availabilityIdx=n,o}function lt(e,t,r,n,i,a,o,s,u,l){var d,c,f=n/a,h=Math.min(i/a,r.adaptation.period.mpd.maxSegmentDuration),p=void 0;return c=(d=e.calcPresentationTimeFromMediaTime(f,r))+h,(p=new it).representation=r,p.duration=h,p.mediaStartTime=f,p.presentationStartTime=d,p.availabilityStartTime=r.adaptation.period.mpd.manifest.loadedTime,p.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(c,r.adaptation.period.mpd,t),p.wallStartTime=e.calcWallTimeForSegment(p,t),p.replacementTime=l||n,p.replacementNumber=ot(p,u),o=st(o,\"Number\",p.replacementNumber),o=st(o,\"Time\",p.replacementTime),p.media=o,p.mediaRange=s,p.availabilityIdx=u,p}function dt(e,t){if(!t||!t.segments)return null;var r=t.segments.length,n=void 0,i=void 0;if(e<r&&(n=t.segments[e])&&n.availabilityIdx===e)return n\n;for(i=0;i<r;i++)if((n=t.segments[i])&&n.availabilityIdx===e)return n;return null}function ct(e,t,r,n,i,a){var o=r.segmentDuration,s=r.adaptation.period.mpd.manifest.minBufferTime,u=r.segmentAvailabilityRange,l={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(r,u.start),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(r,u.end)},d=r.segments,c=2*o,f=a||Math.max(2*s,10*o),h=NaN,p=null,g=void 0;return l.start=Math.max(l.start,0),t&&!e.isTimeSyncCompleted()?{start:g=Math.floor(l.start/o),end:Math.floor(l.end/o)}:(h=d&&d.length>0?(p=dt(i,r))?e.calcPeriodRelativeTimeFromMpdRelativeTime(r,p.presentationStartTime):i>0?i*o:e.calcPeriodRelativeTimeFromMpdRelativeTime(r,n):i>0?i*o:t?l.end:l.start,{start:g=Math.floor(Math.max(h-c,l.start)/o),end:Math.floor(Math.min(g+f/o,l.end/o))})}function ft(e,t){var r=(e=e||{}).timelineConverter;return{getSegments:function(e,n,i,a){if(function(){if(!(r&&r.hasOwnProperty(\"calcMediaTimeFromPresentationTime\")&&r.hasOwnProperty(\"calcSegmentAvailabilityRange\")&&r.hasOwnProperty(\"calcMediaTimeFromPresentationTime\")))throw new Error(\"Missing config parameter(s)\")}(),!e)throw new Error(\"no representation\");void 0===n&&(n=null);var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentTimeline,u=o.SegmentURL_asArray,l=e.availableSegmentsNumber>0,d=void 0;d=a||(i>-1||null!==n?10:1/0);var c,f,h,p=0,g=0,m=-1,E=[],_=null,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,I=void 0,S=void 0,N=void 0,D=function(n,i){var a=o.media,s=n.mediaRange;return u&&(a=u[i].media||\"\",s=u[i].mediaRange),lt(r,t,e,p,n.d,N,a,s,m,n.tManifest)};for(N=e.timescale,c=s.S_asArray,h=i,null!==n&&(_=r.calcMediaTimeFromPresentationTime(n,e)),y=0,f=c.length;y<f;y++){if(A=0,(T=c[y]).hasOwnProperty(\"r\")&&(A=T.r),T.hasOwnProperty(\"t\")&&(g=(p=T.t)/N),A<0){if((I=c[y+1])&&I.hasOwnProperty(\"t\"))R=I.t/N;else{var O=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:r.calcSegmentAvailabilityRange(e,t).end;R=r.calcMediaTimeFromPresentationTime(O,e),e.segmentDuration=T.d/N}A=Math.ceil((R-g)/(T.d/N))-1}if(S){if(l)break;m+=A+1}else for(v=0;v<=A;v++)if(m++,E.length>d){if(S=!0,l)break}else null!==_?g>=_-T.d/N*1.5&&E.push(D(T,m)):m>=h&&E.push(D(T,m)),g=(p+=T.d)/N}return l||(e.availableSegmentsNumber=m+1),E}}}ft.__dashjs_factory_name=\"TimelineSegmentsGetter\";var ht=s.a.getClassFactory(ft);function pt(e,t){var r=e.timelineConverter;return{getSegments:function(e,n,i,a){var o,s,u,l=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,d=e.segmentDuration,c=e.segmentAvailabilityRange,f=[],h=null,p=null,g=void 0,m=void 0;for(u=e.startNumber,o=(g=isNaN(d)&&!t?{start:u,end:u}:ct(r,t,e,n,i,a)).start,s=g.end,m=o;m<=s;m++)(p=ut(r,t,e,m)).replacementTime=(u+m-1)*e.segmentDuration,h=st(h=l.media,\"Number\",p.replacementNumber),h=st(h,\"Time\",p.replacementTime),p.media=h,f.push(p),p=null;return isNaN(d)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((c.end-c.start)/d),f}}}pt.__dashjs_factory_name=\"TemplateSegmentsGetter\";var gt=s.a.getClassFactory(pt);function mt(e,t){var r=(e=e||{}).timelineConverter;return{getSegments:function(e,n,i,a){var o,s,u,l,d=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,c=d.SegmentURL_asArray.length,f=[],h=void 0,p=void 0,g=void 0;for(l=e.startNumber,o=ct(r,t,e,n,i,a),s=Math.max(o.start,0),u=Math.min(o.end,d.SegmentURL_asArray.length-1),h=s;h<=u;h++)g=d.SegmentURL_asArray[h],(p=ut(r,t,e,h)).replacementTime=(l+h-1)*e.segmentDuration,p.media=g.media?g.media:\"\",p.mediaRange=g.mediaRange,p.index=g.index,p.indexRange=g.indexRange,f.push(p),p=null;return e.availableSegmentsNumber=c,f}}}\nmt.__dashjs_factory_name=\"ListSegmentsGetter\";var Et=s.a.getClassFactory(mt);function _t(e,t){var r,n=this.context,i=void 0,a=void 0,o=void 0;return r={getSegments:function(e,t,r,n,s){var u=void 0,l=e.segmentInfoType;l!==Je.SEGMENT_BASE&&l!==Je.BASE_URL&&function(e,t){var r=e.segments,n=!1,i=void 0,a=void 0;r&&0!==r.length?(a=r[0].availabilityIdx,i=r[r.length-1].availabilityIdx,n=t<a||t>i):n=!0;return n}(e,r)?(l===Je.SEGMENT_TIMELINE?u=i.getSegments(e,t,r,s):l===Je.SEGMENT_TEMPLATE?u=a.getSegments(e,t,r,s):l===Je.SEGMENT_LIST&&(u=o.getSegments(e,t,r,s)),n&&n(e,u)):u=e.segments}},i=ht(n).create(e,t),a=gt(n).create(e,t),o=Et(n).create(e,t),r}_t.__dashjs_factory_name=\"SegmentsGetter\";var Tt=s.a.getClassFactory(_t);function yt(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}yt.__dashjs_factory_name=\"RequestModifier\";var vt=s.a.getSingletonFactory(yt);function At(e){var t=(e=e||{}).requestModifier;return{load:function(e){var r=new Date,n=e.request,i=new XMLHttpRequest;i.open(e.method,e.url,!0),n.responseType&&(i.responseType=n.responseType),n.range&&i.setRequestHeader(\"Range\",\"bytes=\"+n.range),n.requestStartDate||(n.requestStartDate=r),t&&(i=t.modifyRequestHeader(i)),i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.timeout=e.timeout,i.ontimeout=e.ontimeout,i.onprogress=e.progress,i.onabort=e.onabort,i.onreadystatechange=function(){2===i.readyState&&e.onHeadersReceived()},i.send(),e.response=i},abort:function(e){e.response.abort()},getP2pType:function(){return\"\"}}}At.__dashjs_factory_name=\"XHRLoader\";var Rt=s.a.getClassFactory(At);function It(e){var t=void 0,r={cdn:0,p2p:0},n=void 0,i=(e=e||{}).p2pType,a=!1,o=_(this.context).getInstance().log,s=\"[P2PLoader]\";return{load:function(u){n=u;var l=u.request;t||(t=new e.supplier(u.url,e.video,l.mediaType),o(s,\"[\"+i+\"] new sdk loader [\"+l.mediaType+\"]\")),t.onDataArrival=function(e){var n=t&&t.loadInfo();n&&(l.p2pLoadInfo||(l.p2pLoadInfo={cdn:0,p2p:0}),l.p2pLoadInfo.url=n.url),u.progress&&u.progress(null,e,n&&{cdn:n.cdn-r.cdn,p2p:n.p2p-r.p2p}),r=n||r},t.onError=function(e,t){o(s,\"[\"+i+\"] error, status:\"+e+\", msg:\"+t+\", type:\"+l.mediaType),u.response={status:e,statusText:t},a=!1,u.onerror(),u.onend()},t.onComplete=function(){o(s,\"[\"+i+\"] onComplete, type:\"+n.request.mediaType),a=!1,u.onload(),u.onend()};var d=void 0;if(l.range){var c=l.range.split(\"-\");d={from:parseInt(c[0]),to:parseInt(c[1]||\"-1\")}}else d={from:0,to:-1};o(s,\"[\"+i+\"] load \"+l.mediaType+\" url:\"+u.url+\", range: \"+d.from+\"-\"+d.to),t.load(d,u.withCredentials);var f=t.loadInfo();f&&(l.p2pLoadInfo||(l.p2pLoadInfo={cdn:0,p2p:0}),l.p2pLoadInfo.url=f.url),a=!0},abort:function(){a=!1,t&&(t.abort(),t.onDataArrival=void 0,t.onError=void 0,t.onComplete=void 0),n.onabort(),n.onend(),o(s,\"[\"+i+\"] abort sdk [\"+n.request.mediaType+\"]\")},destroySdk:function(){var e=function(){a=!1,t&&(t.destroy(),t=void 0,o(s,\"[\"+i+\"] destroy sdk [\"+n.request.mediaType+\"]\")),r={cdn:0,p2p:0}};a?(t.onError=function(t,r){o(s,\"[\"+i+\"] error, status:\"+t+\", msg:\"+r+\", type:\"+n.request.mediaType),n.response={status:t,statusText:r},n.onerror(),n.onend(),e()},t.onComplete=function(){o(s,\"[\"+i+\"] detroy sdk onComplete, type:\"+n.request.mediaType),n.onload(),n.onend(),e()}):e()},getUrl:function(){return n.url||\"\"},getP2pType:function(){return i}}}It.__dashjs_factory_name=\"P2PLoader\";var St=s.a.getClassFactory(It);function Nt(e){var t=(e=e||{}).requestModifier;function r(e,t){e.reader.read().then(t).catch((function(){}))}return{load:function(e){var n=new Date,i=e.request,a=new Headers;i.range&&a.append(\"Range\",\"bytes=\"+i.range),i.requestStartDate||(i.requestStartDate=n),t&&t.modifyRequestHeader({setRequestHeader:function(e,t){a.append(e,t)}});var o=void 0;\"function\"==typeof window.AbortController&&(o=new AbortController,e.abortController=o);var s={method:e.method,headers:a,credentials:e.withCredentials?\"include\":void 0,signal:o?o.signal:void 0};fetch(e.url,s).then((function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,\ne.response.responseURL=t.url,t.ok||e.onerror();var n=\"\",i=!0,a=!1,o=void 0;try{for(var s,u=t.headers.keys()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;n+=l+\": \"+t.headers.get(l)+\"\\n\"}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}if(e.response.responseHeaders=n,e.onHeadersReceived(),!t.body)return t.arrayBuffer().then((function(t){e.response.response=t;var r={loaded:t.byteLength,total:t.byteLength};e.progress(r),e.onload(),e.onend()}));var d=parseInt(t.headers.get(\"Content-Length\"),10),c=0,f=!1,h=new Uint8Array,p=0;e.reader=t.body.getReader();r(e,(function t(n){var i=n.value;if(n.done)return h&&(e.progress({loaded:c,total:isNaN(d)?c:d,lengthComputable:!0}),e.response.response=h.buffer),e.onload(),void e.onend();if(i&&i.length>0){h=function(e,t){if(0===e.length)return t;var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(h,i),c+=i.length;var a=Ie().getInstance().findLastTopIsoBoxCompleted([\"moov\",\"mdat\"],h,p);if(a.found){var o=a.lastCompletedOffset+a.size,s=void 0;o===h.length?(s=h,h=new Uint8Array):(s=new Uint8Array(h.subarray(0,o)),h=h.subarray(o)),e.progress({data:s.buffer,lengthComputable:!1,noTrace:!0}),p=0}else p=a.lastCompletedOffset,f||(e.progress({lengthComputable:!1,noTrace:!0}),f=!0)}r(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel()}catch(e){}}}}Nt.__dashjs_factory_name=\"FetchLoader\";var Dt=s.a.getClassFactory(Nt);function Ot(){var e=this.context,t=d(e).getInstance();return{capabilityError:function(e){t.trigger(p.ERROR,{error:\"capability\",event:e})},downloadError:function(e,r,n,i,a){t.trigger(p.ERROR,{error:\"download\",event:{id:e,url:r,request:n},code:i,httpCode:a})},manifestError:function(e,r,n,i,a,o){t.trigger(p.ERROR,{error:\"manifestError\",event:{message:e,id:r,manifest:n,event:i},code:a,httpCode:o})},timedTextError:function(e,r,n){t.trigger(p.ERROR,{error:\"cc\",event:{message:e,id:r,cc:n}})},mediaSourceError:function(e,r){t.trigger(p.ERROR,{error:\"mediasource\",event:e,code:r})},mediaKeySessionError:function(e){t.trigger(p.ERROR,{error:\"key_session\",event:e})},mediaKeyMessageError:function(e){t.trigger(p.ERROR,{error:\"key_message\",event:e})},mssError:function(e){t.trigger(p.ERROR,{error:\"mssError\",event:e})}}}Ot.__dashjs_factory_name=\"ErrorHandler\";var Ct=s.a.getSingletonFactory(Ot);Ct.CAPABILITY_ERROR_MEDIASOURCE=\"mediasource\",Ct.CAPABILITY_ERROR_MEDIAKEYS=\"mediakeys\",Ct.DOWNLOAD_ERROR_ID_MANIFEST=\"manifest\",Ct.DOWNLOAD_ERROR_ID_SIDX=\"SIDX\",Ct.DOWNLOAD_ERROR_ID_CONTENT=\"content\",Ct.DOWNLOAD_ERROR_ID_INITIALIZATION=\"initialization\",Ct.DOWNLOAD_ERROR_ID_XLINK=\"xlink\",Ct.DOWNLOAD_ERROR_ID_PCDN_SDK=\"pcdnsdk\",Ct.MANIFEST_ERROR_ID_CODEC=\"codec\",Ct.MANIFEST_ERROR_ID_PARSE=\"parse\",Ct.MANIFEST_ERROR_ID_NOSTREAMS=\"nostreams\",Ct.TIMED_TEXT_ERROR_ID_PARSE=\"parse\",s.a.updateSingletonFactory(Ot.__dashjs_factory_name,Ct);var Mt=Ct;function Pt(){return{arraybuffer2string:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))},base642ab:function(e){e=window.atob(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return t},concat:function(e,t){var r=new Uint8Array(e),n=new Uint8Array(t),i=new Uint8Array(r.length+n.length);return i.set(r),i.set(n,r.length),i.buffer}}}Pt.__dashjs_factory_name=\"ArrayBufferHandler\";var bt=s.a.getSingletonFactory(Pt);function wt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Lt={video:null,audio:null};function Ft(e){e=e||{};var t,r,n=this.context,i=d(n).getInstance(),o=e.errHandler,s=e.videoModel,u=e.metricsModel,l=e.mediaPlayerModel,c=e.requestModifier,f=e.useFetch||!1,h=(e.dashMetrics,void 0),g=void 0,m=void 0,E=[],_=void 0,T={},y=bt(n).getInstance(),v=[],A=0,R=void 0,I=void 0,S=e.preloadData;function N(e){Lt[e]&&Lt[e].destroySdk&&(Lt[e].destroySdk(),Lt[e]=null)}function D(){i.trigger(p.PCDN_LOADED_ERROR,{code:a.DOWNLOAD_PCDN_DISABLED,from:1}),l.setP2pPermission(!1)}\nreturn S&&(S.video&&\"string\"==typeof S.video&&(S.video=y.base642ab(S.video)),S.audio&&\"string\"==typeof S.audio&&(S.audio=y.base642ab(S.audio))),t={load:function(e){e.request&&function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=t.request,v=\"\",O=0,C=0;if(d.range){var M=d.range.split(\"-\");if(O=parseInt(M[0]),C=parseInt(M[1]),d.mediaType&&d.representationId&&S&&S[d.mediaType+\"id\"]===d.representationId+\"\"&&S[d.mediaType]){if(C<S[d.mediaType].byteLength)return C+1===S[d.mediaType].byteLength&&(d.preloadEnd=1),void t.success(S[d.mediaType].slice(O,C+1));O<S[d.mediaType].byteLength&&(v=S[d.mediaType].slice(O,C+1),d.range=S[d.mediaType].byteLength+\"-\"+C,d.preloadEnd=1)}}d.firstByteDate=null;var P=[],b=d.representationId,w=2e3,L=!0,F=!0,x=new Date,U=x,B=0,k=void 0,H=T[b]||0,V=!1,Y=1,q=0,W=void 0;if(d.urls&&d.urls.length>1&&H&&(d.url=d.urls[H],t.url=d.urls[H]),!c||!u||!o)throw new Error(\"config object is not correct or missing\");var Q=c.modifyRequestURL(d.url),K=function(e){F=!1;var t=new Date;d.requestStartDate=x,d.requestEndDate=t,d.firstByteDate=d.firstByteDate||t,d.checkExistenceOnly||u.addHttpRequest(d.mediaType,null,d.type,d.url,k.response?k.response.responseURL:null,d.serviceLocation||null,d.range||null,d.requestStartDate,d.firstByteDate,d.requestEndDate,k.response?k.response.status:null,d.duration,k.response&&k.response.getAllResponseHeaders?k.response.getAllResponseHeaders():k.response?k.response.responseHeaders:null,e?P:null)},j=function(){if(clearTimeout(q),-1!==h.indexOf(k)){h.splice(h.indexOf(k),1),W=!1;var n=k&&k.response&&k.response.status;if(F)if(K(!1),r>0){var s=0,u=0;Date.now()-x<50&&(u=1e3*(a+1)),(n>=400&&n<500||n>=600)&&(u=0,s=0),A=setTimeout((function(){a++,i.trigger(p.REQUEST_RETRYED,{retryTimes:a,representationId:b,status:k.response&&k.response.status,url:d.url,mediaType:d.mediaType,range:d.range}),l.getP2pPermission()&&4203===n&&D(),t.request.urls&&t.request.urls.length>1?(T[b]=a%d.urls.length,H=T[b],t.request.url=d.urls[H],t.url=d.urls[H],r--,m.push(setTimeout((function(){e(t,r,a)}),s))):(r--,m.push(setTimeout((function(){e(t,r,a)}),s)))}),u)}else o.downloadError(_[d.type].type,d.url,d,_[d.type].code,k.response&&k.response.status),t.error&&t.error(d,\"error\",k.response&&k.response.statusText,k.response&&k.response.status),t.complete&&t.complete(d,k.response&&k.response.statusText),N(d.mediaType)}},z=w+1e3*a+50,X=d.timeout+3e3*a;q=setTimeout((function(){l.getP2pPermission()&&W.getP2pType()&&l.addP2pSDKErrorCount(),V=!0,W.abort(k),E.push(4106),t.connectTimeout&&t.connectTimeout(d,z),j()}),z);var Z=new Uint8Array,J=function(e,r,n){var i=new Date;if(n)for(var a in d.p2pLoadInfo||(d.p2pLoadInfo={}),n)d.p2pLoadInfo[a]=(d.p2pLoadInfo[a]||0)+n[a];if(!e){if(e={lengthComputable:!1,total:0,loaded:0},r&&(Z=y.concat(Z,r),e.loaded=Z.byteLength),d.range){var o=d.range.split(\"-\"),s=parseInt(o[0]),u=parseInt(o[1]);u&&(e.total=u-s+1)}e.loaded&&e.total&&(e.lengthComputable=!0)}L&&(L=!1,(Y=i-x)<w&&clearTimeout(q),(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(d.firstByteDate=i)),e.lengthComputable&&(d.bytesLoaded=e.loaded,d.bytesTotal=e.total),e.noTrace||(P.push({s:U,d:i.getTime()-U.getTime(),b:[e.loaded?e.loaded-B:0]}),U=i,B=e.loaded),t.progress&&e.loaded&&t.progress(e.loaded)},$=function(){if(k.response){if(k.response.status>=200&&k.response.status<=299){var e=k.response.response;v&&(e=y.concat(v,k.response.response),d.range=O+\"-\"+C),K(!0),t.success&&t.success(e,k.response.statusText,k.response.responseURL),t.complete&&t.complete(d,k.response.statusText)}}else{var r=Z;v&&(r=y.concat(v,Z),d.range=O+\"-\"+C),K(!0),t.success&&t.success(r,\"\",Q),t.complete&&t.complete(d,\"\")}},ee=function(){clearTimeout(q),clearTimeout(A),t.abort&&!V&&t.abort(d)},te=function(){E.push(4105),t.timeout&&t.timeout(d,Y,X),j()},re=function(){d.headersReceivedDate=new Date,t.headersReceived&&t.headersReceived(k.response&&k.response.getAllResponseHeaders&&k.response.getAllResponseHeaders())};if(f&&window.fetch&&\"arraybuffer\"===d.responseType)W=Dt(n).create({requestModifier:c});else{var ne=function(e,t){\nvar r=e.match(/^.+\\/([a-zA-Z0-9_\\-\\.]+)\\??[^\\/]+$/)&&e.match(/^.+\\/([a-zA-Z0-9_\\-\\.]+)\\??[^\\/]+$/)[1],n=t.match(/^.+\\/([a-zA-Z0-9_\\-\\.]+)\\??[^\\/]+$/)&&t.match(/^.+\\/([a-zA-Z0-9_\\-\\.]+)\\??[^\\/]+$/)[1];return r&&n&&r===n},ie=window.__DASH_P2P_TYPE__,ae={yf:window.YFDashIO,xl:window.xyvp&&window.xyvp.Loader,ks:window.KSLoader,pear:window.PearDownloader,bili:window.DIYSdk},oe=void 0,se=void 0,ue=void 0;if(ie&&l.getP2pPermission()){var le=ie.match(/([a-z]+)-([a-z0-9]+)/);le&&(oe=ae[le[1]],ue=\"cg2\"===le[2],se=\"eg\"===le[2]),oe||delete window.__DASH_P2P_TYPE__}if(se&&oe&&d.index>=0)Lt[d.mediaType]&&Lt[d.mediaType].getP2pType()&&ne(Lt[d.mediaType].getUrl(),Q)?W=Lt[d.mediaType]:(N(d.mediaType),W=St(n).create({video:s.getElement(),p2pType:ie,supplier:oe}),Lt[d.mediaType]=W);else if(ue&&oe&&\"video\"===d.mediaType){Q!==I&&(I=Q,R&&R.destroy(),R=new oe(Q,s.getElement(),\"watch\"))}W||(N(d.mediaType),W=Rt(n).create({requestModifier:c}))}var de=d.checkExistenceOnly?G.HEAD:G.GET,ce=l.getXHRWithCredentialsForType(d.type);k={url:Q,method:de,withCredentials:ce,timeout:X,request:d,onload:$,onend:j,onerror:j,ontimeout:te,progress:J,onabort:ee,onHeadersReceived:re,loader:W};var fe=(new Date).getTime();if(isNaN(d.delayLoadingTime)||fe>=d.delayLoadingTime)h.push(k),W.load(k);else{var he={httpRequest:k};g.push(he),he.delayTimeout=setTimeout((function(){if(-1!==g.indexOf(he)){g.splice(g.indexOf(he),1);try{x=new Date,U=x,h.push(he.httpRequest),W.load(he.httpRequest)}catch(e){he.httpRequest.onerror()}}}),d.delayLoadingTime-fe)}}(e,l.getRetryAttemptsForType(e.request.type))},abort:function(){R&&(R.destroy(),R=void 0,I=void 0),clearTimeout(A),v.forEach((function(e){return clearTimeout(e)})),m.forEach((function(e){return clearTimeout(e)})),m=[],g.forEach((function(e){return clearTimeout(e.delayTimeout)})),g=[],h.forEach((function(e){e&&e.request&&isNaN(e.request.index)||(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e),e.onabort())})),h=[]},setPreloadData:function(e){(S=e)&&(S.video&&\"string\"==typeof S.video&&(S.video=y.base642ab(S.video)),S.audio&&\"string\"==typeof S.audio&&(S.audio=y.base642ab(S.audio)))}},h=[],g=[],m=[],wt(r={},G.MPD_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_MANIFEST,code:a.DOWNLOAD_MPD_ERROR}),wt(r,G.XLINK_EXPANSION_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_XLINK,code:a.DOWNLOAD_XINK_ERROR}),wt(r,G.INIT_SEGMENT_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_INITIALIZATION,code:a.DOWNLOAD_INIT_SEGMENT_ERROR}),wt(r,G.MEDIA_SEGMENT_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_CONTENT,code:a.DOWNLOAD_MEDIA_SEGMENT_ERROR}),wt(r,G.INDEX_SEGMENT_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_CONTENT,code:a.DOWNLOAD_INDEX_SEGMENT_ERROR}),wt(r,G.BITSTREAM_SWITCHING_SEGMENT_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_CONTENT,code:a.DOWNLOAD_SWITCHING_SEGMENT_ERROR}),wt(r,G.OTHER_TYPE,{type:Mt.DOWNLOAD_ERROR_ID_CONTENT,code:a.DOWNLOAD_OTHER_ERROR}),_=r,t}Ft.__dashjs_factory_name=\"HTTPLoader\";var xt=s.a.getClassFactory(Ft);function Ut(){var e=this.context,t=_(e).getInstance().log,r=d(e).getInstance(),n=void 0,i=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0;function h(){if(!f||!f.hasOwnProperty(\"resolve\"))throw new Error(\"setConfig function has to be called previously\")}function g(e){if(e.url){var t=new m;return t.type=e.init?G.INIT_SEGMENT_TYPE:G.MEDIA_SEGMENT_TYPE,t.url=e.url,t.urls=e.urls,t.range=e.range.start+\"-\"+e.range.end,t.representationId=e.representationId,t.mediaType=e.mediaType,t}}function E(e,t,n){e?r.trigger(p.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):r.trigger(p.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new S(null,\"error loading segments\",null)})}return{setConfig:function(e){e.baseURLController&&(f=e.baseURLController),e.metricsModel&&(u=e.metricsModel),e.mediaPlayerModel&&(l=e.mediaPlayerModel),e.errHandler&&(n=e.errHandler),e.videoModel&&(i=e.videoModel)},initialize:function(){o=Ie(e).getInstance(),s=vt(e).getInstance(),c=xt(e).create({errHandler:n,videoModel:i,metricsModel:u,mediaPlayerModel:l,requestModifier:s,preloadData:l.getPreloadData()})},loadInitialization:function e(n,i){h();var a=null,s=null,u=f.resolve(n.path),l=i||{init:!0,\nurl:u?u.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500};t(\"Start searching for initialization.\");var d=g(l);c.load({request:d,success:function(i){l.bytesLoaded=l.range.end,s=o.parse(i),(a=function(e){var r=e.getBox(\"ftyp\"),n=e.getBox(\"moov\"),i=null,a=void 0,o=void 0;t(\"Searching for initialization.\"),n&&n.isComplete&&(a=r?r.offset:n.offset,o=n.offset+n.size-1,t(\"Found the initialization.  Range: \"+(i=a+\"-\"+o)));return i}(s))?(n.range=a,r.trigger(p.INITIALIZATION_LOADED,{representation:n})):(l.range.end=l.bytesLoaded+l.bytesToLoad,e(n,l))},error:function(){r.trigger(p.INITIALIZATION_LOADED,{representation:n})}}),t(\"Perform init search: \"+l.url)},loadSegments:function e(r,i,s,u,d){if(h(),s&&(void 0===s.start||void 0===s.end)){var p=s?s.toString().split(\"-\"):null;s=p?{start:parseFloat(p[0]),end:parseFloat(p[1])}:null}d=d||E;var m=null,_=null,T=!!s,y=f.resolve(r.path),v={init:!1,url:y?y.url:void 0,urls:y.urls,range:T?s:{start:0,end:1500},searching:!T,bytesLoaded:u?u.bytesLoaded:0,bytesToLoad:1500,representationId:r.id,mediaType:r.adaptation.type},A=g(v),R=function(){d(null,r,i)};c.load({request:A,success:function(s){if(v.bytesLoaded=v.range.end-v.range.start,m=o.parse(s),(_=m.getBox(\"sidx\"))&&_.isComplete){var u=_.references,c=void 0,f=void 0;if(null!=u&&u.length>0&&(c=1===u[0].reference_type),c){t(\"Initiate multiple SIDX load.\"),v.range.end=v.range.start+_.size;var h=void 0,p=void 0,g=void 0,E=void 0,T=[],y=0,A=(_.offset||v.range.start)+_.size,I=function(e){e?(T=T.concat(e),++y>=p&&d(T,r,i)):d(null,r,i)};for(h=0,p=u.length;h<p;h++)g=A,E=A+u[h].referenced_size-1,A+=u[h].referenced_size,e(r,null,{start:g,end:E},v,I)}else{t(\"Parsing segments from SIDX.\"),f=function(e,t){for(var r=e.references,n=r.length,i=e.timescale,a=e.earliest_presentation_time,o=t.range.start+e.offset+e.first_offset+e.size,s=[],u=void 0,l=void 0,d=void 0,c=void 0,f=0;f<n;f++)d=r[f].subsegment_duration,c=r[f].referenced_size,(u=new it).duration=d,u.startTime=a,u.timescale=i,l=o+c-1,u.mediaRange=o+\"-\"+l,s.push(u),a+=d,o+=c;return s}(_,v);try{var S=f[f.length-1],N=(S.duration+S.startTime)/S.timescale;r.adaptation.period.min?r.adaptation.period.min=Math.min(r.adaptation.period.min,N):r.adaptation.period.min=N;var D=l.getCachedDurationOffset(\"offset\");r.adaptation.period.duration=parseFloat((D+r.adaptation.period.min).toFixed(5)),t(\"Set real min period duration \"+r.adaptation.period.duration+\" ( \"+D+\" )\")}catch(e){t(\"Set real period error \"+i)}d(f,r,i)}}else R(),n.mediaSourceError(\"Error parsing \"+i+\" response.\",a.MEDIA_DECODE_ERROR)},error:R}),t(\"Perform SIDX load: \"+v.url)},resetPreloadData:function(){c&&c.setPreloadData(l.getPreloadData())},reset:function(){c.abort(),c=null,n=null,o=null,s=null}}}Ut.__dashjs_factory_name=\"SegmentBaseLoader\";var Bt=s.a.getSingletonFactory(Ut);function Gt(e){e=e||{};var t=this.context,r=d(t).getInstance(),i=nt(t).getInstance(),a=void 0,o=e.timelineConverter,s=e.dashMetrics,u=e.metricsModel,l=e.mediaPlayerModel,c=e.errHandler,f=e.baseURLController,h=void 0,g=void 0,E=void 0,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,I=void 0;function N(){E=-1,y=0,v=NaN,T=null,A=null,R=null}function D(e,t,r){var n=f.resolve(r.path),a=void 0,o=void 0,s=void 0;return n&&t!==n.url&&i.isRelative(t)?(a=n.url,o=n.urls||[],s=n.serviceLocation,t&&(a=i.resolve(t,a))):o=[a=t],!i.isRelative(a)&&(e.url=a,e.urls=o,e.serviceLocation=s,!0)}function O(e){var t=!1,r=A?A.getStreamInfo().manifestInfo.isDynamic:null;if(r||E!==e.availableSegmentsNumber){var n=dt(E,e);if(n){var i=parseFloat((n.presentationStartTime-e.adaptation.period.start).toFixed(5)),a=l.getCachedDurationOffset(\"duration\"),o=a?Math.min(e.adaptation.period.duration,a):e.adaptation.period.duration;o=e.adaptation.period.duration,g(e.segmentInfoType+\": \"+i+\" / \"+o),t=(e.segmentInfoType!==Je.SEGMENT_TIMELINE||!r)&&i>=o}else g(\"isMediaFinished - no segment found\")}else t=!0;return t}function C(e){R.getSegments(e,T,E,M)}function M(e,t){var r=A?A.getStreamInfo().manifestInfo.isDynamic:null;if(e.segments=t,\nt&&t.length>0&&(v=isNaN(v)?t[0].presentationStartTime:Math.min(t[0].presentationStartTime,v),r&&isNaN(o.getExpectedLiveEdge()))){var i=t[t.length-1].presentationStartTime,a=u.getMetricsFor(n.STREAM);o.setExpectedLiveEdge(i),u.updateManifestUpdateInfo(s.getCurrentManifestUpdate(a),{presentationStartTime:i})}}function P(e){if(!e)throw new Error(\"no representation\");e.segments=null,C(e)}function b(e,t,r){var n=t.segments,i=n?n.length:null,a=-1,o=void 0,s=void 0,u=void 0,d=void 0,c=void 0;if(n&&i>0){for(r=null==r?l.getSegmentOverlapToleranceTime():r,c=0;c<i;c++)if(u=(s=n[c]).presentationStartTime,d=s.duration,e+(o=null==r?d/2:r)>=u&&e-o<u+d){a=s.availabilityIdx;break}0===e&&n[0].presentationStartTime>0&&(a=0)}return a}function w(e){if(null==e)return null;var t=new m,r=e.representation,n=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth,i=e.media,a=A?A.getType():null;return i=st(i,\"Number\",e.replacementNumber),i=st(i,\"Time\",e.replacementTime),i=function(e){return e?e.split(\"$$\").join(\"$\"):e}(i=function(e,t){if(!t||!e||-1===e.indexOf(\"$RepresentationID$\"))return e;var r=t.toString();return e.split(\"$RepresentationID$\").join(r)}(i=st(i,\"Bandwidth\",n),r.id)),t.mediaType=a,t.type=G.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=r.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=r.index,t.index=e.availabilityIdx,t.mediaInfo=A.getMediaInfo(),t.adaptationIndex=r.adaptation.index,t.representationId=r.id,D(t,i,r)?t:void 0}function L(e,t,r){var n=void 0,i=A?A.getType():null,a=A?A.getStreamInfo().manifestInfo.isDynamic:null,o=E,s=!!r&&r.keepIdx,u=r?r.timeThreshold:null,l=!(!r||!r.ignoreIsFinished);return e?(T!==t&&(T=t,g(\"Getting the request for \"+i+\" time : \"+t)),C(e),(E=b(t,e,u))<0&&(C(e),E=b(t,e,u)),E>0&&g(\"Index for \"+i+\" time \"+t+\" is \"+E),!l&&O(e)?((n=new m).action=m.ACTION_COMPLETE,n.index=E,n.mediaType=i,n.mediaInfo=A.getMediaInfo(),g(\"Signal complete in getSegmentRequestForTime -\",i)):n=w(dt(E,e)),s&&o>=0&&(E=e.segmentInfoType===Je.SEGMENT_TIMELINE&&a?E:o),n):null}function F(e){var t=e.representation;t.segments&&r.trigger(p.REPRESENTATION_UPDATED,{sender:this,representation:t})}function x(e){var t=A?A.getType():null,n=A?A.getStreamInfo().manifestInfo.isDynamic:null;if(!e.error&&t===e.mediaType){var i,a=e.segments,s=e.representation,u=[],d=0,c=void 0,f=void 0,h=void 0,g=0;for(l.getAppendingSourceState()&&(I=l.getCachedDurationOffset(\"offset\"),g=a[0].startTime,E=0),c=0,i=a.length;c<i;c++)f=a[c],h=lt(o,n,s,f.startTime+I*f.timescale-g,f.duration,f.timescale,f.media,f.mediaRange,d),u.push(h),h=null,d++;s.segmentAvailabilityRange={start:u[0].presentationStartTime,end:u[i-1].presentationStartTime},s.availableSegmentsNumber=i,M(s,u),$e.hasInitialization(s)&&r.trigger(p.REPRESENTATION_UPDATED,{sender:this,representation:s})}}return h={initialize:function(r){var n=(A=r)?A.getStreamInfo().manifestInfo.isDynamic:null;a.initialize(),R=Tt(t).create(e,n)},getStreamProcessor:function(){return A},getInitRequest:function(e){var t=A?A.getType():null;return e?function(e,t){var r=new m,n=e.adaptation.period,i=n.start,a=A?A.getStreamInfo().manifestInfo.isDynamic:null;if(r.mediaType=t,r.type=G.INIT_SEGMENT_TYPE,r.range=e.range,r.availabilityStartTime=o.calcAvailabilityStartTimeFromPresentationTime(i,n.mpd,a),r.availabilityEndTime=o.calcAvailabilityEndTimeFromPresentationTime(i+n.duration,n.mpd,a),r.quality=e.index,r.mediaInfo=A?A.getMediaInfo():null,r.representationId=e.id,D(r,e.initialization,e))return r}(e,t):null},getSegmentRequestForTime:L,getNextSegmentRequest:function(e){var t=void 0,r=void 0,n=A?A.getType():null,i=A?A.getStreamInfo().manifestInfo.isDynamic:null;return e&&-1!==E?(T=null,E++,g(\"Getting the next request at index: \"+E+\", type: \"+n),!dt(E,e)&&i?(g(\"No segment found at index: \"+E+\". Wait for next loop\"),C(e),E--,null):(O(e)?((t=new m).action=m.ACTION_COMPLETE,t.index=E,\nt.mediaType=n,t.mediaInfo=A.getMediaInfo(),g(\"Signal complete -\",n)):(C(e),t=w(r=dt(E,e)),!r&&i&&E--),t)):null},generateSegmentRequestForTime:function(e,t){var r=(e.segmentAvailabilityRange.end-e.segmentAvailabilityRange.start)/2;return e.segments=null,e.segmentAvailabilityRange={start:t-r,end:t+r},L(e,t,{keepIdx:!1,ignoreIsFinished:!0})},updateRepresentation:function(e,t){var n=$e.hasInitialization(e),i=$e.hasSegments(e),s=A?A.getType():null,u=A?A.getStreamInfo().manifestInfo.isDynamic:null,l=void 0;if(e.segmentDuration||e.segments||P(e),e.segmentAvailabilityRange=o.calcSegmentAvailabilityRange(e,u),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)return l=new S(1,\"no segments are available yet\",{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void r.trigger(p.REPRESENTATION_UPDATED,{sender:this,representation:e,error:l});t||(E=-1),e.segmentDuration&&P(e),n||a.loadInitialization(e),i||a.loadSegments(e,s,e.indexRange),n&&i&&r.trigger(p.REPRESENTATION_UPDATED,{sender:this,representation:e})},updateSegmentList:P,setCurrentTime:function(e){l.getCachedDurationOffset(\"duration\")&&(e=Math.min(l.getCachedDurationOffset(\"duration\"),e)),y=e},getCurrentTime:function(){return y},getEarliestTime:function(){return v},resetPreloadData:function(){a&&a.resetPreloadData()},reset:function(){N(),r.off(p.INITIALIZATION_LOADED,F,h),r.off(p.SEGMENTS_LOADED,x,h)}},g=_(t).getInstance().log.bind(h),N(),(a=Bt(t).getInstance()).setConfig({baseURLController:f,metricsModel:u,mediaPlayerModel:l,videoModel:e.videoModel,errHandler:c}),I=0,r.on(p.INITIALIZATION_LOADED,F,h),r.on(p.SEGMENTS_LOADED,x,h),h}Gt.__dashjs_factory_name=\"DashHandler\";var kt=s.a.getClassFactory(Gt);kt.SEGMENTS_UNAVAILABLE_ERROR_CODE=1,s.a.updateClassFactory(Gt.__dashjs_factory_name,kt);var Ht=kt;function Vt(e){e=e||{};var t=this.context,r=void 0,i=e.type,a=e.errHandler,o=e.mimeType,s=e.timelineConverter,u=e.adapter,l=e.manifestModel,d=e.mediaPlayerModel,c=e.stream,f=e.abrController,h=e.playbackController,p=e.streamController,g=e.mediaController,m=e.domStorage,E=e.metricsModel,_=e.dashMetrics,T=e.dashManifestModel,y=void 0,v=void 0,A=void 0,R=void 0,I=void 0,S=void 0,N=void 0,D=void 0,O=void 0;function C(){O=[]}function M(){A=[],v=null,C()}function P(){return c?c.getStreamInfo():null}function b(){return v}return y={initialize:function(v){(r=Ht(t).create({mimeType:o,timelineConverter:s,dashMetrics:_,metricsModel:E,mediaPlayerModel:d,baseURLController:e.baseURLController,videoModel:e.videoModel,errHandler:a})).initialize(y),f.registerStreamType(i,y),(D=c.getFragmentController().getModel(i)).setStreamProcessor(y),R=function(e){var r=null;e!==n.VIDEO&&e!==n.AUDIO||(r=Fe(t).create({type:e,metricsModel:E,mediaPlayerModel:d,manifestModel:l,errHandler:a,streamController:p,mediaController:g,adapter:u,abrController:f,playbackController:h,streamProcessor:y}));return r}(i),I=Ze(t).create({type:i,metricsModel:E,adapter:u,dashMetrics:_,dashManifestModel:T,timelineConverter:s,mediaPlayerModel:d,abrController:f,playbackController:h,streamController:p,streamProcessor:y,mediaController:g}),(N=tt(t).create()).setConfig({abrController:f,domStorage:m,metricsModel:E,dashMetrics:_,dashManifestModel:T,manifestModel:l,playbackController:h,timelineConverter:s,streamProcessor:y}),R.initialize(v),I.initialize(),N.initialize()},isUpdating:function(){return!!N&&N.isUpdating()},getType:function(){return i},getBufferController:function(){return R},getFragmentModel:function(){return D},getScheduleController:function(){return I},getLiveEdgeFinder:function(){return S},getEventController:function(){return c?c.getEventController():null},getFragmentController:function(){return c?c.getFragmentController():null},getRepresentationController:function(){return N},getIndexHandler:function(){return r},getCurrentRepresentationInfo:function(){return u.getCurrentRepresentationInfo(N)},getRepresentationInfoForQuality:function(e){return u.getRepresentationInfoForQuality(N,e)},getBufferLevel:function(){return R.getBufferLevel()},\nswitchInitData:function(e,t){R&&R.switchInitData(P().id,e,t)},isBufferingCompleted:function(){return!!R&&R.getIsBufferingCompleted()},createBuffer:function(){return R.getBuffer()||R.createBuffer(v)},getStreamInfo:P,updateMediaInfo:function(e){e===v||e&&v&&e.type!==v.type||(v=e),-1===A.indexOf(e)&&A.push(e),u.updateData(this)},switchTrackAsked:function(){I.switchTrackAsked()},getMediaInfoArr:function(){return A},getMediaInfo:b,getMediaSource:function(){return R.getMediaSource()},setMediaSource:function(e){R.setMediaSource(e,b())},dischargePreBuffer:function(){R.dischargePreBuffer()},getBuffer:function(){return R.getBuffer()},setBuffer:function(e){R.setBuffer(e)},registerExternalController:function(e){O.push(e)},unregisterExternalController:function(e){var t=O.indexOf(e);-1!==t&&O.splice(t,1)},getExternalControllers:function(){return O},unregisterAllExternalController:C,getPlaybackController:function(){return h},resetPreloadData:function(){D.resetPreloadData(),r.resetPreloadData()},reset:function(e){r.reset(),R&&(R.reset(e),R=null),I&&(I.reset(),I=null),N&&(N.reset(),N=null),f&&f.unRegisterStreamType(i),O.forEach((function(e){e.reset()})),M(),i=null,c=null,S&&(S.reset(),S=null)}},h&&h.getIsDynamic()&&(S=Ve(t).create({timelineConverter:s,streamProcessor:y})),M(),y}Vt.__dashjs_factory_name=\"StreamProcessor\";var Yt=s.a.getClassFactory(Vt);function qt(){var e,t=\"urn:mpeg:dash:event:2012\",r=this.context,n=_(r).getInstance().log,i=d(r).getInstance(),a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,g=void 0,m=void 0;function E(){m=!1,a={},o={},s={},u=null,c=(l=100)/1e3}function T(){if(!f||!h||!g)throw new Error(\"setConfig function has to be called previously\")}function y(){null!==u&&m&&(clearInterval(u),u=null,m=!1)}function v(e){if(1==e.eventStream.value){var t=e.eventStream.timescale||1,r=e.presentationTime/t,a=void 0;a=4294967295==e.presentationTime?NaN:(e.presentationTime+e.duration)/t,n(\"Manifest validity changed: Valid until: \"+r+\"; remaining duration: \"+a),i.trigger(p.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:a,newManifestValidAfter:NaN})}}function A(){R(o),R(a),function(){if(s)for(var e=g.getTime(),t=Object.keys(s),r=0;r<t.length;r++){var i=t[r],a=s[i];null!==a&&(a.duration+a.presentationTime)/a.eventStream.timescale<e&&(n(\"Remove Event \"+i+\" at time \"+e),a=null,delete s[i])}}()}function R(e){var r,a=g.getTime();if(e)for(var o=Object.keys(e),u=0;u<o.length;u++){var l=o[u],d=e[l];void 0!==d&&(0===(r=d.presentationTime/d.eventStream.timescale)||r<=a&&r+c>a)&&(n(\"Start Event \"+l+\" at \"+a),d.duration>0&&(s[l]=d),d.eventStream.schemeIdUri==t&&1==d.eventStream.value?0===d.duration&&0===d.presentationTimeDelta||(T(),h.refreshManifest()):i.trigger(d.eventStream.schemeIdUri,{event:d}),delete e[l])}}return e={addInlineEvents:function(e){if(T(),a={},e)for(var t=0;t<e.length;t++){var r=e[t];a[r.id]=r,n(\"Add inline event with id \"+r.id)}n(\"Added \"+e.length+\" inline events\")},addInbandEvents:function(e){T();for(var r=0;r<e.length;r++){var i=e[r];i.id in o?n(\"Repeated event with id \"+i.id):(i.eventStream.schemeIdUri===t&&void 0===o[i.id]&&v(i),o[i.id]=i,n(\"Add inband event with id \"+i.id))}},stop:y,start:function(){T(),n(\"Start Event Controller\"),m||isNaN(l)||(m=!0,u=setInterval(A,l))},setConfig:function(e){e&&(e.manifestModel&&(f=e.manifestModel),e.manifestUpdater&&(h=e.manifestUpdater),e.playbackController&&(g=e.playbackController))},reset:function(){y(),E()}},E(),e}qt.__dashjs_factory_name=\"EventController\";var Wt=s.a.getClassFactory(qt);var Qt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};var Kt=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){\nif(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,e.call(this));return n.url=r||null,n.checkForExistenceOnly=!0,n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(m),jt=\"request timeout\";function zt(e){e=e||{};var t=this.context,r=d(t).getInstance(),n=void 0,i=void 0,o=void 0;return n={checkForExistence:function(e){var t=function(t){r.trigger(p.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new Kt(e.url);i.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function t(o){var s=function(t,i){if(!i&&(r.trigger(p.LOADING_COMPLETED,{request:o,response:t||null,error:i||null,sender:n}),o.preloadEnd)){e.mediaPlayerModel.setPreloadData(null);var a=e.abrController.getDefaultQualityFor(o.mediaType,!1);e.abrController.setPlaybackQuality(o.mediaType,e.streamController.getActiveStreamInfo(),a)}};o?(void 0===o.retry&&(o.retry=1),i.load({request:o,progress:function(e){e&&r.trigger(p.LOADING_DATA_PROGRESS,{request:o,response:e||null,error:null,sender:n})},success:function(e){try{var n=void 0;if(o.range){var i=o.range&&o.range.split(\"-\");n=i[1]-i[0]+1}var u={mediaType:o.mediaType,id:o.representationId,index:o.index,range:o.range,received:e&&e.byteLength||0,url:o.url,startTime:o.startTime,duration:o.duration,p2pLoadInfo:o.p2pLoadInfo};e&&e.byteLength>3e7&&(u.code=a.DOWNLOAD_FRAGMENT_ERROR_RANGE,r.trigger(p.FRAGMENT_LOADED_ERROR,u)),!e||e.byteLength!==n&&n?(u&&u.hasOwnProperty(\"type\")&&delete u.type,o.retry&&o.retry>0?(u.code=a.DOWNLOAD_FRAGMENT_ERROR,r.trigger(p.FRAGMENT_LOADED_ERROR,u),o.retry--,t(o)):(u.code=a.DOWNLOAD_FRAGMENT_ERROR_RETRY_FAILURE,r.trigger(p.FRAGMENT_LOADED_ERROR,u))):(1===o.retry||(u.code=a.DOWNLOAD_FRAGMENT_ERROR_RETRY_SUCCESS,r.trigger(p.FRAGMENT_LOADED_ERROR,u)),s(e))}catch(e){(undefined)}},timeout:function(e,t,n){var i={mediaType:e.mediaType,id:e.representationId,index:e.index,range:e.range,received:e.bytesLoaded,url:e.url,startTime:e.startTime,duration:e.duration,total:e.bytesTotal,latency:t,timeout:n,p2pLoadInfo:e.p2pLoadInfo};i.code=a.DOWNLOAD_FRAGMENT_ERROR_TIMEOUT,r.trigger(p.FRAGMENT_LOADED_ERROR,i),s(void 0,new S(1,jt))},error:function(e,t,r){s(void 0,new S(1,r,t))},abort:function(e){e&&r.trigger(p.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:n})},connectTimeout:function(e,t){if(e){var n={mediaType:e.mediaType,id:e.representationId,index:e.index,range:e.range,received:e.bytesLoaded||0,url:e.url,startTime:e.startTime,duration:e.duration,total:e.bytesTotal,timeout:t,p2pLoadInfo:e.p2pLoadInfo};n.code=a.CONNECT_FRAGMENT_ERROR_TIMEOUT,r.trigger(p.FRAGMENT_LOADED_ERROR,n),s(void 0,new S(1,jt))}},headersReceived:function(e){r.trigger(p.FRAGMENT_LOADING_HEADER_RECEIVED,{request:o,headers:e})}})):s(void 0,new S(2,\"request is null\"))},abort:function(){i&&i.abort()},reset:function(){i&&(i.abort(),i=null)},resetPreloadData:function(){o=e.mediaPlayerModel.getPreloadData(),i.setPreloadData(o)}},o=e.mediaPlayerModel.getPreloadData(),i=xt(t).create({errHandler:e.errHandler,videoModel:e.videoModel,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.mediaPlayerModel.getLowLatencyEnabled(),dashMetrics:e.dashMetrics,preloadData:o}),n}zt.__dashjs_factory_name=\"FragmentLoader\";var Xt=s.a.getClassFactory(zt);Xt.FRAGMENT_LOADER_ERROR_LOADING_FAILURE=1,Xt.FRAGMENT_LOADER_ERROR_NULL_REQUEST=2,s.a.updateClassFactory(zt.__dashjs_factory_name,Xt);var Zt=Xt;function Jt(e){e=e||{};var t=this.context,r=_(t).getInstance().log,i=d(t).getInstance(),a=e.errHandler,o=e.mediaPlayerModel,s=e.metricsModel,u=e.abrController,l=e.streamController,c=e.videoModel,f=void 0,h=void 0;function g(e){\nreturn e&&e.type&&e.type===G.INIT_SEGMENT_TYPE}function m(){for(var e in h)h[e].reset();h={}}function E(e){if(h[e.request.mediaType]===e.sender){var t=e.request,a=e.response,o=g(t),s=t.mediaInfo.streamInfo;if(e.error&&(e.request.mediaType!==n.AUDIO&&e.request.mediaType!==n.VIDEO&&e.request.mediaType!==n.FRAGMENTED_TEXT||i.trigger(p.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),a&&s){var u=function(e,t,r,n){var i=new Qt;return i.streamId=r,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=n,i}(a,t,s.id,e.type!==p.FRAGMENT_LOADING_PROGRESS);i.trigger(o?p.INIT_FRAGMENT_LOADED:p.MEDIA_FRAGMENT_LOADED,{chunk:u,fragmentModel:e.sender})}else r(\"No \"+t.mediaType+\" bytes to push or stream is inactive.\")}}return f={getModel:function(r){var n=h[r];return n||(n=I(t).create({metricsModel:s,fragmentLoader:Zt(t).create({metricsModel:s,videoModel:c,mediaPlayerModel:o,errHandler:a,requestModifier:vt(t).getInstance(),dashMetrics:e.dashMetrics,abrController:u,streamController:l})}),h[r]=n),n},isInitializationRequest:g,reset:function(){i.off(p.FRAGMENT_LOADING_COMPLETED,E,this),m()}},m(),i.on(p.FRAGMENT_LOADING_COMPLETED,E,f),f}Jt.__dashjs_factory_name=\"FragmentController\";var $t=s.a.getClassFactory(Jt);function er(e){e=e||{};var t=this.context,r=_(t).getInstance().log,i=d(t).getInstance(),a=e.manifestModel,o=e.dashManifestModel,s=e.mediaPlayerModel,u=e.manifestUpdater,l=e.adapter,c=e.capabilities,f=e.errHandler,h=e.timelineConverter,g=e.metricsModel,m=e.abrController,E=e.playbackController,T=e.mediaController,y=e.videoModel,v=e.streamController,A=void 0,R=void 0,I=void 0,S=void 0,N=void 0,D=void 0,O=void 0,C=void 0,M=void 0,P=void 0;function b(){for(var e=R?R.length:0,t=0;t<e;t++){R[t].getFragmentModel().removeExecutedRequestsBeforeTime(x()+F()),R[t].reset()}R=[],I=!1,S=!1,i.off(p.CURRENT_TRACK_CHANGED,H,A)}function w(){b(),N=null,D={},O=!1}function L(){E&&E.pause(),C&&(C.reset(),C=null),w(),r=null,i.off(p.DATA_UPDATE_COMPLETED,K,A),i.off(p.BUFFERING_COMPLETED,Q,A),i.off(p.KEY_ERROR,B,A),i.off(p.SERVER_CERTIFICATE_UPDATED,B,A),i.off(p.LICENSE_REQUEST_COMPLETE,B,A),i.off(p.KEY_SYSTEM_SELECTED,B,A),i.off(p.KEY_SESSION_CREATED,B,A),i.off(p.KEY_STATUSES_CHANGED,B,A)}function F(){return N?N.duration:NaN}function x(){return N?N.start:NaN}function U(){if(!(m&&m.hasOwnProperty(\"getBitrateList\")&&l&&l.hasOwnProperty(\"getAllMediaInfoForType\")&&l.hasOwnProperty(\"getEventsFor\")))throw new Error(\"Missing config parameter(s)\")}function B(e){e.error&&(f.mediaKeySessionError(e.error),r(e.error),L())}function G(e){return e.type===n.TEXT?e.mimeType:e.type}function k(e){var t,i=e.type,o=void 0;if(i===n.MUXED&&e)return r(o=\"Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines\"),f.manifestError(o,\"multiplexedrep\",a.getValue()),!1;if(i===n.TEXT||i===n.FRAGMENTED_TEXT||i===n.EMBEDDED_TEXT||i===n.IMAGE)return!0;if(t=e.codec,r(i+\" codec: \"+t),e.contentProtection&&!c.supportsEncryptedMedia())f.capabilityError(\"encryptedmedia\");else if(!c.supportsCodec(t))return r(o=i+\"Codec (\"+t+\") is not supported.\"),!1;return!0}function H(e){if(e.newMediaInfo.streamInfo.id===N.id){var t=j(e.oldMediaInfo);if(t){var i=E.getTime();r(\"Stream -  Process track changed at current time \"+i);var o=e.newMediaInfo,s=a.getValue();r(\"Stream -  Update stream controller\"),s.refreshManifestOnSwitchTrack?(r(\"Stream -  Refreshing manifest for switch track\"),P=e,u.refreshManifest()):(t.updateMediaInfo(o),o.type!==n.FRAGMENTED_TEXT&&(m.updateTopQualityIndex(o),t.switchTrackAsked(),t.getFragmentModel().abortRequests()))}}}function V(i,u){var d=l.getAllMediaInfoForType(N,i),c=null;if(d&&0!==d.length){for(var p=0,_=d.length;p<_;p++)if(c=d[p],i===n.EMBEDDED_TEXT);else{if(!k(c))continue;T.addTrack(c)}i!==n.EMBEDDED_TEXT&&0!==T.getTracksFor(i,N).length&&(T.checkInitialMediaSettingsForType(i,N),function(r,i,u,d){var c=Yt(t).create({type:G(r),mimeType:r.mimeType,\ntimelineConverter:h,adapter:l,manifestModel:a,dashManifestModel:o,mediaPlayerModel:s,metricsModel:g,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,stream:A,abrController:m,domStorage:e.domStorage,playbackController:E,mediaController:T,streamController:v,videoModel:y,errHandler:f});c.initialize(u),m.updateTopQualityIndex(r),d?(c.setBuffer(d.buffer),c.getIndexHandler().setCurrentTime(d.currentTime),R[d.replaceIdx]=c):R.push(c),d&&d.ignoreMediaInfo||r.type===n.TEXT||r.type===n.FRAGMENTED_TEXT||c.updateMediaInfo(r)}(T.getCurrentTrackFor(i,N),0,u))}else r(\"No \"+i+\" data.\")}function Y(e){var t=o.getAdaptationForType(a.getValue(),N.index,e,N);if(!t||!Array.isArray(t.Representation_asArray))return null;t.Representation_asArray=t.Representation_asArray.filter((function(e,n){if(0===n)return!0;var i=o.getCodec(t,n,!0);return!!c.supportsCodec(i)||(r(\"[Stream] codec not supported: \"+i),!1)}))}function q(){for(var e=R.length,t=!!D.audio||!!D.video?new Error(1,\"Data update failed\",null):null,r=0;r<e;r++)if(R[r].isUpdating()||O)return;S&&i.trigger(p.STREAM_INITIALIZED,{streamInfo:N,error:t})}function W(){for(var e=0,t=R.length;e<t;e++)R[e].createBuffer()}function Q(e){if(e.streamInfo===N){var t=z(),a=t.length;if(0!==a){for(var o=0;o<a;o++)if(!t[o].isBufferingCompleted()&&(t[o].getType()===n.AUDIO||t[o].getType()===n.VIDEO))return void r(\"[Stream] onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because streamProcessor \"+t[o].getType()+\" is not buffering completed\");r(\"[Stream] onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED\"),i.trigger(p.STREAM_BUFFERING_COMPLETED,{streamInfo:N})}else r(\"[Stream] onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined\")}}function K(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===N&&(D[t.getType()]=e.error,q())}function j(e){return!!e&&z().filter((function(t){return t.getType()===e.type}))[0]}function z(){for(var e=R.length,t=[],r=void 0,i=void 0,a=0;a<e;a++)(r=(i=R[a]).getType())!==n.AUDIO&&r!==n.VIDEO&&r!==n.FRAGMENTED_TEXT||t.push(i);return t}return A={initialize:function(e){N=e},activate:function(e){I||(i.on(p.CURRENT_TRACK_CHANGED,H,A),function(e){U();var i=void 0,o=y.getElement();M||((M=Wt(t).create()).setConfig({manifestModel:a,manifestUpdater:u,playbackController:E}),i=l.getEventsFor(N),M.addInlineEvents(i));O=!0,Y(n.VIDEO),Y(n.AUDIO),(null===o||o&&\"VIDEO\"===o.nodeName)&&V(n.VIDEO,e);V(n.AUDIO,e),\"open\"!==e.readyState?(e.addEventListener(\"sourceopen\",W,!1),e.addEventListener(\"webkitsourceopen\",W,!1)):W();if(S=!0,O=!1,0===R.length){var s=\"No streams to play.\";f.manifestError(s,\"nostreams\",a.getValue()),r(s)}else q()}(e),I=!0)},deactivate:b,getDuration:F,getStartTime:x,getId:function(){return N?N.id:NaN},getStreamInfo:function(){return N},getFragmentController:function(){return C},getEventController:function(){return M},getBitrateListFor:function(e){U();var t=function(e){for(var t=R.length,r=null,n=0;n<t;n++)if((r=R[n]).getType()===e)return r.getMediaInfo();return null}(e);return m.getBitrateList(t)},startEventController:function(){M&&M.start()},stopEventController:function(){M&&M.stop()},updateData:function(e){if(r(\"Manifest updated... updating data system wide.\"),I=!1,O=!0,N=e,M){var t=l.getEventsFor(N);M.addInlineEvents(t)}Y(n.VIDEO),Y(n.AUDIO);for(var i=0,a=R.length;i<a;i++){var o=R[i],s=l.getMediaInfoForType(N,o.getType());m.updateTopQualityIndex(s),o.updateMediaInfo(s)}if(P&&\"fragmentedText\"!==P.newMediaInfo.type){var u=j(P.oldMediaInfo);if(!u)return;u.switchTrackAsked(),P=void 0}O=!1,q()},reset:L,getProcessors:z,setMediaSource:function(e){for(var t=0;t<R.length;)k(R[t].getMediaInfo())?(R[t].setMediaSource(e),t++):(R[t].reset(),R.splice(t,1));for(var n=0;n<R.length;n++)R[n].dischargePreBuffer();if(0===R.length){var i=\"No streams to play.\";f.manifestError(i,\"nostreams\",a.getValue()),r(i)}}},w(),C=$t(t).create({mediaPlayerModel:s,videoModel:y,metricsModel:g,errHandler:f,dashMetrics:e.dashMetrics,abrController:m,streamController:v}),i.on(p.BUFFERING_COMPLETED,Q,A),i.on(p.DATA_UPDATE_COMPLETED,K,A),\nA}er.__dashjs_factory_name=\"Stream\";var tr=s.a.getClassFactory(er);function rr(){var e=this.context,t=_(e).getInstance().log,r=d(e).getInstance(),n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0;function h(){n=NaN,o=!1,a=!0,g()}function g(){null!==i&&(clearInterval(i),i=null)}function m(e){g(),isNaN(e)&&!isNaN(n)&&(e=1e3*n),isNaN(e)||(t(\"Refresh manifest in \"+e+\" milliseconds.\"),i=setTimeout(y,e))}function E(){o=!0;var e=u.getValue(),t=e.url,r=l.getLocation(e);r&&(t=r),s.load(t)}function T(e){if(c.getAppendingSourceState()){var i=c.getCachedDurationOffset(\"offset\");e.mediaPresentationDuration+=i,e.Period.duration+=i,e.Period_asArray.duration+=i}u.setValue(e);var o=new Date,s=(o.getTime()-e.loadedTime.getTime())/1e3;1e3*(n=l.getManifestUpdatePeriod(e,s))>2147483647&&(n=2147483.647),r.trigger(p.MANIFEST_UPDATED,{manifest:e}),t(\"Manifest has been refreshed at \"+o+\"[\"+o.getTime()/1e3+\"] \"),a||m()}function y(){a&&!c.getScheduleWhilePaused()||(o?m(c.getManifestUpdateRetryInterval()):E())}function v(e){e.error?f.manifestError(e.error.message,e.error.code,\"\",\"\",e.error.errorCode,e.error.httpCode):T(e.manifest)}function A(){a=!1,m()}function R(){a=!0,g()}function I(){o=!1}return{initialize:function(){h(),r.on(p.STREAMS_COMPOSED,I,this),r.on(p.PLAYBACK_STARTED,A,this),r.on(p.PLAYBACK_PAUSED,R,this),r.on(p.INTERNAL_MANIFEST_LOADED,v,this)},setManifest:function(e){T(e)},refreshManifest:E,setConfig:function(e){e&&(e.manifestModel&&(u=e.manifestModel),e.dashManifestModel&&(l=e.dashManifestModel),e.mediaPlayerModel&&(c=e.mediaPlayerModel),e.manifestLoader&&(s=e.manifestLoader),e.errHandler&&(f=e.errHandler))},reset:function(){r.off(p.PLAYBACK_STARTED,A,this),r.off(p.PLAYBACK_PAUSED,R,this),r.off(p.STREAMS_COMPOSED,I,this),r.off(p.INTERNAL_MANIFEST_LOADED,v,this),h()}}}rr.__dashjs_factory_name=\"ManifestUpdater\";var nr=s.a.getClassFactory(rr);function ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ar=1e3;function or(){var e,t,r,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,E=void 0,_=void 0,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,I=void 0,S=void 0,N=void 0,D=void 0,O=void 0,C=void 0,M=void 0,P=void 0,b=void 0,w=void 0,L=void 0,F=void 0,x=void 0,U=void 0,B=void 0,k=void 0,H=void 0,V=void 0,Y=void 0;function q(e){var t=void 0;for(t=0;t<C.length;t++)if(C[t].rulename===e)return t;return-1}function W(e){H=e}return e={setABRStrategy:function(e){S=e},getABRStrategy:function(){return S},setUseDefaultABRRules:function(e){N=e},getUseDefaultABRRules:function(){return N},getABRCustomRules:function(){return C},addABRCustomRule:function(e,t,r){var n=q(t);-1===n?C.push({type:e,rulename:t,rule:r}):(C[n].type=e,C[n].rule=r)},removeABRCustomRule:function(e){var t=q(e);-1!==t&&C.splice(t,1)},removeAllABRCustomRule:function(){C=[]},setBandwidthSafetyFactor:function(e){y=e},getBandwidthSafetyFactor:function(){return y},setAbandonLoadTimeout:function(e){v=e},getAbandonLoadTimeout:function(){return v},setLastBitrateCachingInfo:function(e,t){h.enabled=e,void 0===t||isNaN(t)||\"number\"!=typeof t||(h.ttl=t)},getLastBitrateCachingInfo:function(){return h},setLastMediaSettingsCachingInfo:function(e,t){p.enabled=e,void 0===t||isNaN(t)||\"number\"!=typeof t||(p.ttl=t)},getLastMediaSettingsCachingInfo:function(){return p},setStableBufferTime:function(e){g=e},getStableBufferTime:function(){return isNaN(g)?O?20:12:g},setBufferTimeAtTopQuality:function(e){m=e},getBufferTimeAtTopQuality:function(){return m},setBufferTimeAtTopQualityLongForm:function(e){E=e},getBufferTimeAtTopQualityLongForm:function(){return E},setLongFormContentDurationThreshold:function(e){_=e},getLongFormContentDurationThreshold:function(){return _},setSegmentOverlapToleranceTime:function(e){T=e},getSegmentOverlapToleranceTime:function(){return T},getCacheLoadThresholdForType:function(e){return P[e]},setCacheLoadThresholdForType:function(e,t){P[e]=t},setBufferToKeep:function(e){d=e},getBufferToKeep:function(){return d},\nsetBufferAheadToKeep:function(e){c=e},getBufferAheadToKeep:function(){return c},setBufferPruningInterval:function(e){f=e},getBufferPruningInterval:function(){return f},setFragmentRetryAttempts:function(e){A[G.MEDIA_SEGMENT_TYPE]=e},getFragmentRetryAttempts:function(){return A[G.MEDIA_SEGMENT_TYPE]},setManifestRetryAttempts:function(e){A[G.MPD_TYPE]=e},getManifestRetryAttempts:function(){return A[G.MPD_TYPE]},setRetryAttemptsForType:function(e,t){A[e]=t},getRetryAttemptsForType:function(e){return A[e]},setFragmentRetryInterval:function(e){R[G.MEDIA_SEGMENT_TYPE]=e},getFragmentRetryInterval:function(){return R[G.MEDIA_SEGMENT_TYPE]},setManifestRetryInterval:function(e){R[G.MPD_TYPE]=e},getManifestRetryInterval:function(){return R[G.MPD_TYPE]},setRetryIntervalForType:function(e,t){R[e]=t},getRetryIntervalForType:function(e){return R[e]},setWallclockTimeUpdateInterval:function(e){I=e},getWallclockTimeUpdateInterval:function(){return I},setScheduleWhilePaused:function(e){l=e},getScheduleWhilePaused:function(){return l},getUseSuggestedPresentationDelay:function(){return a},setUseSuggestedPresentationDelay:function(e){a=e},setLiveDelayFragmentCount:function(e){s=e},getLiveDelayFragmentCount:function(){return s},getLiveDelay:function(){return L?u||3:u},setLiveDelay:function(e){u=e},setUseManifestDateHeaderTimeSource:function(e){i=e},getUseManifestDateHeaderTimeSource:function(){return i},setUTCTimingSources:function(e){o=e},getUTCTimingSources:function(){return o},setXHRWithCredentialsForType:function e(t,r){t?D[t]=!!r:Object.keys(D).forEach((function(t){e(t,r)}))},getXHRWithCredentialsForType:function(e){var t=D[e];return void 0===t?D.default:t},setFastSwitchEnabled:function(e){O=e},getFastSwitchEnabled:function(){return O},setMovingAverageMethod:function(e){M=e},getMovingAverageMethod:function(){return M},setJumpGaps:function(e){b=e},getJumpGaps:function(){return b},setSmallGapLimit:function(e){w=e},getSmallGapLimit:function(){return w},getLowLatencyEnabled:function(){return L},setLowLatencyEnabled:function(e){L=e},getPreloadData:function(){return F},setPreloadData:function(e){F=e},setManifestUpdateRetryInterval:function(e){x=e},getManifestUpdateRetryInterval:function(){return x},setAppendingSourceState:function(e){e!==U&&(U=e)},getAppendingSourceState:function(){return U},setCachedDurationOffset:function(e,t){t=parseFloat(t.toFixed(5)),B[e]=t},getCachedDurationOffset:function(e){return e?B[e]:B},clearCachedDruationOffset:function(){B={offset:0,duration:0}},setEndOfStreamState:function(e){k=e},getEndOfStreamState:function(){return k},setP2pPermission:W,getP2pPermission:function(){return H},addP2pSDKErrorCount:function(){(V+=1)>12&&W(!1)},getP2pSDKErrorCount:function(){return V},addBufferingCount:function(){Y+=1},getBufferingCount:function(){return Y},reset:function(){}},o=[],a=!1,i=!0,l=!0,S=n.ABR_STRATEGY_DYNAMIC,N=!0,O=!1,h={enabled:!0,ttl:36e4},p={enabled:!0,ttl:36e4},s=4,u=void 0,d=20,c=80,f=10,g=NaN,m=30,E=60,_=600,T=.2,y=.8,v=1e4,I=50,b=!1,w=.8,x=100,D={default:!1},C=[],M=n.MOVING_AVERAGE_SLIDING_WINDOW,L=!1,U=!1,B={time:0,duration:0,offset:0},ir(t={},G.MPD_TYPE,3),ir(t,G.XLINK_EXPANSION_TYPE,1),ir(t,G.MEDIA_SEGMENT_TYPE,3),ir(t,G.INIT_SEGMENT_TYPE,3),ir(t,G.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),ir(t,G.INDEX_SEGMENT_TYPE,3),ir(t,G.OTHER_TYPE,3),A=t,ir(r={},G.MPD_TYPE,500),ir(r,G.XLINK_EXPANSION_TYPE,500),ir(r,G.MEDIA_SEGMENT_TYPE,ar),ir(r,G.INIT_SEGMENT_TYPE,ar),ir(r,G.BITSTREAM_SWITCHING_SEGMENT_TYPE,ar),ir(r,G.INDEX_SEGMENT_TYPE,ar),ir(r,G.OTHER_TYPE,ar),R=r,(P={})[n.VIDEO]=25,P[n.AUDIO]=5,k=!0,H=!0,V=0,Y=0,e}or.__dashjs_factory_name=\"MediaPlayerModel\";var sr=s.a.getSingletonFactory(or);sr.DEFAULT_UTC_TIMING_SOURCE={scheme:\"urn:mpeg:dash:utc:http-xsdate:2014\",value:\"http://time.akamai.com/?iso\"},s.a.updateSingletonFactory(or.__dashjs_factory_name,sr);var ur=sr;var lr=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\")\n;return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,e.call(this));return r.AST_IN_FUTURE=\"astInFuture\",r.BUFFER_EMPTY=\"bufferStalled\",r.BUFFER_LOADED=\"bufferLoaded\",r.BUFFER_LEVEL_STATE_CHANGED=\"bufferStateChanged\",r.ERROR=\"error\",r.FRAGMENT_LOADING_COMPLETED=\"fragmentLoadingCompleted\",r.FRAGMENT_LOADING_HEADER_RECEIVED=\"fragmentLoadingHeaderReceived\",r.FRAGMENT_LOADING_PROGRESS=\"fragmentLoadingProgress\",r.FRAGMENT_LOADING_STARTED=\"fragmentLoadingStarted\",r.FRAGMENT_P2P_LOAD_INFO=\"fragmentP2pLoadInfo\",r.FRAGMENT_LOADING_ABANDONED=\"fragmentLoadingAbandoned\",r.FRAGMENT_LOADED_ERROR=\"fragmentLoadedError\",r.PCDN_LOADED_ERROR=\"pcdnLoadedError\",r.LOG=\"log\",r.MANIFEST_LOADED=\"manifestLoaded\",r.METRICS_CHANGED=\"metricsChanged\",r.METRIC_CHANGED=\"metricChanged\",r.METRIC_ADDED=\"metricAdded\",r.METRIC_UPDATED=\"metricUpdated\",r.PERIOD_SWITCH_COMPLETED=\"periodSwitchCompleted\",r.PERIOD_SWITCH_STARTED=\"periodSwitchStarted\",r.QUALITY_CHANGE_REQUESTED=\"qualityChangeRequested\",r.QUALITY_CHANGE_DOWNLOADED=\"qualityChangeDownloaded\",r.QUALITY_CHANGE_RENDERED=\"qualityChangeRendered\",r.TRACK_CHANGE_RENDERED=\"trackChangeRendered\",r.SOURCE_INITIALIZED=\"sourceInitialized\",r.STREAM_INITIALIZED=\"streamInitialized\",r.STREAM_TEARDOWN_COMPLETE=\"streamTeardownComplete\",r.TEXT_TRACKS_ADDED=\"allTextTracksAdded\",r.TEXT_TRACK_ADDED=\"textTrackAdded\",r.TTML_PARSED=\"ttmlParsed\",r.TTML_TO_PARSE=\"ttmlToParse\",r.CAN_PLAY=\"canPlay\",r.PLAYBACK_ENDED=\"playbackEnded\",r.PLAYBACK_ERROR=\"playbackError\",r.PLAYBACK_NOT_ALLOWED=\"playbackNotAllowed\",r.PLAYBACK_METADATA_LOADED=\"playbackMetaDataLoaded\",r.PLAYBACK_PAUSED=\"playbackPaused\",r.PLAYBACK_PLAYING=\"playbackPlaying\",r.PLAYBACK_PROGRESS=\"playbackProgress\",r.PLAYBACK_RATE_CHANGED=\"playbackRateChanged\",r.PLAYBACK_SEEKED=\"playbackSeeked\",r.PLAYBACK_SEEKING=\"playbackSeeking\",r.PLAYBACK_SEEK_ASKED=\"playbackSeekAsked\",r.PLAYBACK_STALLED=\"playbackStalled\",r.PLAYBACK_STARTED=\"playbackStarted\",r.PLAYBACK_TIME_UPDATED=\"playbackTimeUpdated\",r.PLAYBACK_WAITING=\"playbackWaiting\",r.MANIFEST_VALIDITY_CHANGED=\"manifestValidityChanged\",r.DELAY_TO_APPEND_TO_BUFFER=\"delayToAppendBuffer\",r.GET_NEXT_FRAGMENT=\"getNextFragment\",r.APPENDING_NEXT_SOURCE=\"appendingNextSource\",r.APPENDED_NEXT_SOURCE=\"appendedNextSource\",r.APPENDED_NEXT_SOURCE_DURATION_CHANGED=\"appendedNextSourceDurationChanged\",r.START_OFFSET_TIME_WARNING=\"startOffsetTimeWarning\",r}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(c));function dr(){var e=this.context,t=_(e).getInstance().log,r=d(e).getInstance(),i=nt(e).getInstance(),a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0;function h(e){o=e}function g(e){e}function m(e){a=e}function E(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,r=void 0,n=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\\.[0-9]*)?)?(?:([+\\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&(parseInt(n[6],10)||0),n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]&&(r=60*parseInt(n[9],10)+parseInt(n[10],10),t+=(\"+\"===n[8]?-1:1)*r*60*1e3),new Date(t).getTime()}(e)),t}function T(e){return Date.parse(e)}function y(e){return Date.parse(e)}function v(e,t,r){r()}function A(e,t,r){var n=E(e);isNaN(n)?r():t(n)}function R(e,t,r,n,a){var o,s,u=!1,l=new XMLHttpRequest,d=a?G.HEAD:G.GET,c=t.match(/\\S+/g);if(t=c.shift(),o=function(){u||(u=!0,c.length?R(e,c.join(\" \"),r,n,a):n())},s=function(){var t=void 0,n=void 0;200===l.status&&(t=a?l.getResponseHeader(\"Date\"):l.response,n=e(t),isNaN(n)||(r(n),u=!0))},i.isRelative(t)){var h=f.resolve();h&&(t=i.resolve(t,h.url))}l.open(d,t),l.timeout=5e3,l.onload=s,l.onloadend=o,l.send()}function I(e,t,r){R(y,e,t,r,!0)}function N(e,t,n){h(!1),r.trigger(p.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:n,\nerror:e?new S(1):null})}return{initialize:function(e,r){s=r,a=0,o=!1,!1,u={\"urn:mpeg:dash:utc:http-head:2014\":I,\"urn:mpeg:dash:utc:http-xsdate:2014\":R.bind(null,E),\"urn:mpeg:dash:utc:http-iso:2014\":R.bind(null,T),\"urn:mpeg:dash:utc:direct:2014\":A,\"urn:mpeg:dash:utc:http-head:2012\":I,\"urn:mpeg:dash:utc:http-xsdate:2012\":R.bind(null,E),\"urn:mpeg:dash:utc:http-iso:2012\":R.bind(null,T),\"urn:mpeg:dash:utc:direct:2012\":A,\"urn:mpeg:dash:utc:http-ntp:2014\":v,\"urn:mpeg:dash:utc:ntp:2014\":v,\"urn:mpeg:dash:utc:sntp:2014\":v},o||(!function e(r,i){var o=i||0,d=r[o],f=function(e,t){var r,i,o,u=!e||!t;u&&s?(r=l.getReadOnlyMetricsFor(n.STREAM),i=c.getLatestMPDRequestHeaderValueByID(r,\"Date\"),o=null!==i?new Date(i).getTime():Number.NaN,isNaN(o)?N(!0):(m(o-(new Date).getTime()),N(!1,o/1e3,a))):N(u,e,t)};h(!0),d?u.hasOwnProperty(d.schemeIdUri)?u[d.schemeIdUri](d.value,(function(e){var r=(new Date).getTime(),n=e-r;m(n),t(\"Local time:      \"+new Date(r)),t(\"Server time:     \"+new Date(e)),t(\"Difference (ms): \"+n),f(e,n)}),(function(){e(r,o+1)})):e(r,o+1):(m(0),f())}(e),g(!0))},getOffsetToDeviceTimeMs:function(){return a},setConfig:function(e){e&&(e.metricsModel&&(l=e.metricsModel),e.dashMetrics&&(c=e.dashMetrics),e.baseURLController&&(f=e.baseURLController))},reset:function(){g(!1),h(!1)}}}dr.__dashjs_factory_name=\"TimeSyncController\";var cr=s.a.getSingletonFactory(dr);cr.TIME_SYNC_FAILED_ERROR_CODE=1,cr.HTTP_TIMEOUT_MS=5e3,s.a.updateSingletonFactory(dr.__dashjs_factory_name,cr);var fr=cr,hr=r(8),pr=r.n(hr);function gr(){return{areEqual:function(e,t){return pr()(e,t)}}}gr.__dashjs_factory_name=\"ObjectUtils\";var mr=s.a.getSingletonFactory(gr);var Er=NaN,_r=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.data={baseUrls:t||null,selectedIdx:r||Er},this.children=[]};function Tr(){var e,t=void 0,r=void 0,n=this.context,i=mr(n).getInstance();function a(e,t,n){var a=r.getBaseURLsFromElement(n);e[t]?i.areEqual(a,e[t].data.baseUrls)||(e[t].data.baseUrls=a,e[t].data.selectedIdx=Er):e[t]=new _r(a)}function o(){t=new _r}return e={reset:o,update:function(e){!function(e){var n=r.getBaseURLsFromElement(e);i.areEqual(n,t.data.baseUrls)||(t.data.baseUrls=n,t.data.selectedIdx=Er),e.Period_asArray&&e.Period_asArray.forEach((function(e,n){a(t.children,n,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,i){a(t.children[n].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(r.getRepresentationSortFunction()).forEach((function(e,r){a(t.children[n].children[i].children,r,e)}))}))}))}(e)},getForPath:function(e){var r=t,n=[r.data];return e&&e.forEach((function(e){(r=r.children[e])&&n.push(r.data)})),n.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){!function e(r,n){var i=n||t;r(i.data),i.children&&i.children.forEach((function(t){return e(r,t)}))}((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=Er)}))},setConfig:function(e){e.dashManifestModel&&(r=e.dashManifestModel)}},o(),e}Tr.__dashjs_factory_name=\"BaseURLTreeModel\";var yr=s.a.getClassFactory(Tr);function vr(e){e=e||{};return{select:function(e){return e&&function(e){var t=0,r=[],n=0,i=void 0,a=void 0;if((a=e.sort((function(e,t){var r=e.dvb_priority-t.dvb_priority;return isNaN(r)?0:r})).filter((function(e,t,r){return!t||r[0].dvb_priority&&e.dvb_priority&&r[0].dvb_priority===e.dvb_priority}))).length)return a.length>1&&(a.forEach((function(e){t+=e.dvb_weight,r.push(t)})),i=Math.floor(Math.random()*(t-1)),r.every((function(e,t){return n=t,!(i<e)}))),a[n]}((t=[],e.filter((function(){return!0})).filter((function(e){return!t.length||!e.dvb_priority||-1===t.indexOf(e.dvb_priority)}))));var t}}}vr.__dashjs_factory_name=\"DVBSelector\";var Ar=s.a.getClassFactory(vr);function Rr(e){e=e||{};return{select:function(e){var t=0,r=void 0;return e&&e.some((function(e,r){return t=r,!0}))&&(r=e[t]),r}}}Rr.__dashjs_factory_name=\"BasicSelector\";var Ir=s.a.getClassFactory(Rr),Sr=\"Failed to resolve a valid URL\";function Nr(){\nvar e,t=this.context,r=d(t).getInstance(),n=void 0,i=void 0,a=void 0,o=void 0;function s(){}return e={chooseSelectorFromManifest:function(e){!function(){if(!n||!n.hasOwnProperty(\"getIsDVB\"))throw new Error(\"Missing config parameter(s)\")}(),o=n.getIsDVB(e)?a:i},select:function(e){var t=e.baseUrls,n=e.selectedIdx;if(!isNaN(n))return t[n];var i=o.select(t);if(i)return e.selectedIdx=t.indexOf(i),i;r.trigger(p.URL_RESOLUTION_FAILED,{error:new Error(1,Sr)})},reset:s,setConfig:function(e){e.selector&&(o=e.selector),e.dashManifestModel&&(n=e.dashManifestModel)}},i=Ir(t).create({}),a=Ar(t).create({}),o=i,e}Nr.__dashjs_factory_name=\"BaseURLSelector\";var Dr=s.a.getClassFactory(Nr);Dr.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=1,Dr.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE=Sr,s.a.updateClassFactory(Nr.__dashjs_factory_name,Dr);var Or=Dr;var Cr=function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.url=t||\"\",this.serviceLocation=r||t||\"\",this.dvb_priority=n||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};Cr.DEFAULT_DVB_PRIORITY=1,Cr.DEFAULT_DVB_WEIGHT=1;var Mr=Cr;function Pr(){var e=void 0,t=void 0,r=this.context,n=d(r).getInstance(),i=nt(r).getInstance(),a=void 0,o=void 0;function s(e){a.invalidateSelectedIndexes(e.entry)}return e={reset:function(){a.reset(),o.reset()},initialize:function(e){var r;a.setConfig({dashManifestModel:t}),o.setConfig({dashManifestModel:t}),r=e,a.update(r),o.chooseSelectorFromManifest(r)},resolve:function(e){var t=a.getForPath(e).reduce((function(e,t){var r=o.select(t);return r?(i.isRelative(r.url)?e.url=i.resolve(r.url,e.url):(e.url=r.url,e.serviceLocation=r.serviceLocation),e.urls=r.urls,e.availabilityTimeOffset=r.availabilityTimeOffset,e.availabilityTimeComplete=r.availabilityTimeComplete,e):new Mr}),new Mr);if(!i.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(a=e.baseURLTreeModel),e.baseURLSelector&&(o=e.baseURLSelector),e.dashManifestModel&&(t=e.dashManifestModel)}},a=yr(r).create(),o=Or(r).create(),n.on(p.SERVICE_LOCATION_BLACKLIST_CHANGED,s,e),e}Pr.__dashjs_factory_name=\"BaseURLController\";var br=s.a.getSingletonFactory(Pr);function wr(){return{createMediaSource:function(){var e=\"WebKitMediaSource\"in window;return\"MediaSource\"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var r=window.URL.createObjectURL(e);return t.setSource(r),r},detachMediaSource:function(e){e.setSource(null)},setDuration:function e(t,r){return t.duration!=r&&function(e,t){var r=void 0,n=50,i=function(){for(var t=!1,r=0;r<e.length;r++)e[r].updating&&(t=!0);return t};if(!e.length||!i())return void t();var a=function(){i()||(clearInterval(r),t())},o=function e(){this.removeEventListener(\"updateend\",e,!1),this.removeEventListener(\"abort\",e,!1),this.removeEventListener(\"error\",e,!1),i()||t()};if(\"function\"==typeof e[0].addEventListener)try{for(var s=0;s<e.length;s++)e[s].updating&&(e[s].addEventListener(\"updateend\",o,!1),e[s].addEventListener(\"abort\",o,!1),e[s].addEventListener(\"error\",o,!1))}catch(e){r=setInterval(a,n)}else r=setInterval(a,n)}(t.sourceBuffers,(function(){if(\"open\"===t.readyState)t.duration=r;else var n=setTimeout((function(){clearTimeout(n),e(t,r)}),50)})),t.duration},setSeekable:function(e,t,r){e&&\"function\"==typeof e.setLiveSeekableRange&&\"function\"==typeof e.clearLiveSeekableRange&&\"open\"===e.readyState&&t>=0&&t<r&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,r))},signalEndOfStream:function(e){var t=e.sourceBuffers,r=t.length;if(\"open\"===e.readyState){for(var n=0;n<r;n++){if(t[n].updating)return;if(0===t[n].buffered.length)return}e.endOfStream()}}}}wr.__dashjs_factory_name=\"MediaSourceController\";var Lr=s.a.getSingletonFactory(wr);function Fr(){\nvar e=this.context,t=_(e).getInstance().log,r=d(e).getInstance(),o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,g=void 0,m=void 0,E=void 0,T=void 0,y=void 0,v=void 0,A=void 0,R=void 0,I=void 0,S=void 0,N=void 0,D=void 0,O=void 0,C=void 0,M=void 0,P=void 0,b=void 0,w=void 0,L=void 0,F=void 0,x=void 0,U=void 0,B=void 0,G=void 0,k=void 0,H=void 0,V=void 0,Y=void 0,q=void 0,W=void 0,Q=void 0,K=void 0,j=void 0;function z(){if(fe()){var e=U.getPlaybackQuality();e&&g.addDroppedFrames(n.VIDEO,e)}}function X(){if(!(!G.getJumpGaps()||!C||0===C.getProcessors().length||B.isSeeking()||k||w||L||F)&&++K>=40){var e=B.getTime();j===e?function(e){for(var n=C.getProcessors(),i=G.getSmallGapLimit(),a=void 0,o=0;o<n.length;o++){var s=n[o].getBuffer(),u=s&&s.getAllBufferRanges&&s.getAllBufferRanges(),l=void 0;if(u&&!(u.length<=1)){for(var d=0;d<u.length;d++)if(e<u.start(d)){l=u.start(d);break}if(l>0){var c=l-e;c>0&&c<=i&&(void 0===a||l>a)&&(a=l)}}}var f=B.getTimeToStreamEnd();void 0===a&&!isNaN(f)&&f<i&&(a=e+f);a>0&&(!isNaN(f)&&a>=e+f?(t(\"Jumping media gap (discontinuity) at time \",e,\". Jumping to end of the stream\"),r.trigger(p.PLAYBACK_ENDED)):(t(\"Jumping media gap (discontinuity) at time \",e,\". Jumping to time position\",a),B.seek(a)))}(e):j=e,K=0}}function Z(e){var t=ne(e.seekTime);Q&&(ee(),W=!1),t&&t!==C?(pe(We.END_OF_PERIOD_STOP_REASON),ae(C,t,e.seekTime)):pe(We.USER_REQUEST_STOP_REASON),ge(qe.SEEK_START_REASON)}function J(){t(\"[StreamController][onPlaybackStarted]\"),H?(H=!1,ge(qe.INITIAL_PLAYOUT_START_REASON)):k&&(k=!1,ge(qe.RESUME_FROM_PAUSE_START_REASON),te())}function $(e){t(\"[StreamController][onPlaybackPaused]\"),e.ended||(k=!0,pe(We.USER_REQUEST_STOP_REASON),te())}function ee(){t(\"[StreamController][toggleEndPeriodTimer] stop end period timer.\"),clearTimeout(Q),Q=void 0}function te(){if(W)if(Q)ee();else{var e=B.getTimeToStreamEnd(),n=e>0?1e3*e:0;t(\"[StreamController][toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in \"+n+\" milliseconds\"),Q=setTimeout((function(){r.trigger(p.PLAYBACK_ENDED)}),n)}}function re(){var e=Ee().isLast,r=G.getEndOfStreamState();x&&e?(t(\"[StreamController][onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController.\"),r&&E.signalEndOfStream(x)):x&&void 0===Q&&(t(\"[StreamController][onStreamBufferingCompleted] end of period detected\"),W=!0,!1===k&&te())}function ne(e){var t=0,r=null,n=O.length;n>0&&(t+=O[0].getStartTime());for(var i=0;i<n;i++)if(r=O[i],e<(t=parseFloat((t+r.getDuration()).toFixed(5))))return r;return null}function ie(e){var r=function(){if(C){var e=C.getStreamInfo().start,t=C.getStreamInfo().duration;return O.filter((function(r){return r.getStreamInfo().start===parseFloat((e+t).toFixed(5))}))[0]}}();r?(q=void 0,Y=void 0,ae(C,r,NaN)):t(\"StreamController no next stream found\"),pe(r?We.END_OF_PERIOD_STOP_REASON:We.END_OF_CONTENT_STOP_REASON),Q=void 0,W=!1;try{if(G.getEndOfStreamState()&&!e.isNativeEnded){var n=Re(\"video\"),i=Re(\"audio\");isNaN(n)&&isNaN(i)||(B.seek(B.getTime()-.3),E.signalEndOfStream(x))}}catch(e){(undefined)}}function ae(e,t,n){!w&&t&&e!==t&&(w=!0,r.trigger(p.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),e&&(e.stopEventController(),e.deactivate()),C=t,B.initialize(C.getStreamInfo()),U.getElement()?oe(n,e,!1):function(e){se(e)}(n))}function oe(e,n,i){var a=void 0;function o(){x&&(t(\"MediaSource is open!\"),window.URL.revokeObjectURL(a),x.removeEventListener(\"sourceopen\",o),x.removeEventListener(\"webkitsourceopen\",o),ue(),n||r.trigger(p.SOURCE_INITIALIZED),i&&C.setMediaSource(x))}x?E.detachMediaSource(U):x=E.createMediaSource(),se(e),x.addEventListener(\"sourceopen\",o,!1),x.addEventListener(\"webkitsourceopen\",o,!1),a=E.attachMediaSource(x,U),t(\"MediaSource attached to element.  Waiting on open...\")}function se(e){if(C.activate(x),q=he(n.AUDIO),Y=he(n.VIDEO),!H)if(isNaN(e)){var t=B.getStreamStartTime(!0);C.getProcessors().forEach((function(e){h.setIndexHandlerTime(e,t)}))}else B.seek(e)\n;C.startEventController(),!b&&H||B.play(),w=!1,r.trigger(p.PERIOD_SWITCH_COMPLETED,{toStreamInfo:C.getStreamInfo()})}function ue(e){var r=e||C.getStreamInfo().manifestInfo.duration,n=E.setDuration(x,r);t(\"Duration successfully set to: \"+n)}function le(e){for(var t=0,r=O.length;t<r;t++)if(O[t].getId()===e.id)return O[t];return null}function de(){var t=c.getValue();M&&(r.trigger(p.PROTECTION_CREATED,{controller:M,manifest:t}),M.setMediaElement(U.getElement()),P&&M.setProtectionData(P)),function(){try{var t=h.getStreamsInfo();if(0===t.length)throw new Error(\"There are no streams\");var i=m.getCurrentManifestUpdate(g.getMetricsFor(n.STREAM));g.updateManifestUpdateInfo(i,{currentTime:B.getTime(),buffered:U.getBufferRange(),presentationStartTime:t[0].start,clientTimeOffset:D.getClientTimeOffset()});for(var a=0,l=t.length;a<l;a++){var d=t[a],E=le(d);E?E.updateData(d):(E=tr(e).create({manifestModel:c,dashManifestModel:f,mediaPlayerModel:G,metricsModel:g,dashMetrics:m,manifestUpdater:u,adapter:h,timelineConverter:D,capabilities:s,errHandler:N,baseURLController:y,domStorage:v,abrController:A,playbackController:B,mediaController:R,videoModel:U,streamController:o}),O.push(E),E.initialize(d,M)),g.addManifestUpdateStreamInfo(i,d.id,d.index,d.start,d.duration)}if(!C){var _=B.getStartTimeFromUriParameters(),T=null;_&&(T=ne(isNaN(_.fragS)?_.fragT:_.fragS)),ae(null,null!==T?T:O[0],NaN)}r.trigger(p.STREAMS_COMPOSED)}catch(e){N.manifestError(e.message,\"nostreamscomposed\",c.getValue()),F=!0,ve()}}()}function ce(e){if(e.error)F=!0,ve();else{var r=e.manifest;G.getAppendingSourceState()&&ue(r.mediaPresentationDuration),h.updatePeriods(r);var i=h.getStreamsInfo(void 0,1)[0],a=h.getMediaInfoForType(i,n.VIDEO)||h.getMediaInfoForType(i,n.AUDIO),o=void 0;a&&(o=f.getUseCalculatedLiveEdgeTimeForAdaptation(h.getDataForMedia(a)))&&(t(\"SegmentTimeline detected using calculated Live Edge Time\"),G.setUseManifestDateHeaderTimeSource(!1));var s=f.getUTCTimingSources(e.manifest),u=!f.getIsDynamic(r)||o?s:s.concat(G.getUTCTimingSources()),l=S.isHTTPS(e.manifest.url);u.forEach((function(e){e.value.replace(/.*?:\\/\\//g,\"\")===ur.DEFAULT_UTC_TIMING_SOURCE.value.replace(/.*?:\\/\\//g,\"\")&&(e.value=e.value.replace(l?new RegExp(/^(http:)?\\/\\//i):new Reg